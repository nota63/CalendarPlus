{% extends "custom.html" %}

{% block content %}
<div class="container mx-auto mt-8">
    <h2 class="text-2xl font-bold mb-4">🚀 Mini Apps Store</h2>

    <!-- Search Input -->
    <input type="text" id="searchInput" placeholder="🔍 Search apps..." 
        class="w-full px-4 py-2 border rounded-md shadow-sm mb-4 focus:ring focus:ring-blue-300">

    <!-- Category Filters -->
    <div class="flex space-x-3 mb-6">
        <button class="filter-btn bg-blue-500 text-white px-4 py-2 rounded-md" data-category="all">All</button>
        <button class="filter-btn bg-gray-500 text-white px-4 py-2 rounded-md" data-category="productivity">Productivity</button>
        <button class="filter-btn bg-green-500 text-white px-4 py-2 rounded-md" data-category="communication">Communication</button>
        <button class="filter-btn bg-purple-500 text-white px-4 py-2 rounded-md" data-category="task_management">Task Management</button>
        <button class="filter-btn bg-red-500 text-white px-4 py-2 rounded-md" data-category="entertainment">Entertainment</button>
        <button class="filter-btn bg-yellow-500 text-white px-4 py-2 rounded-md" data-category="utility">Utility</button>
    </div>

    <!-- Apps Grid -->
    <div id="appsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for app in categories.All %}  {# Show only "All" category apps to avoid duplication #}
            <div class="app-card bg-white p-4 rounded-lg shadow-md flex flex-col items-center border border-gray-200" 
                data-category="{{ app.category }}" data-name="{{ app.name|lower }}">

                <img src="{{ app.icon.url }}" alt="{{ app.name }}" class="w-16 h-16 rounded-md">
                <h3 class="text-lg font-semibold mt-2">{{ app.name }}</h3>
                <p class="text-sm text-gray-600">{{ app.size }}</p>

                <!-- Premium Badge -->
                {% if app.is_premium %}
                    <span class="mt-2 px-3 py-1 bg-yellow-500 text-white text-xs rounded-full">Premium</span>
                {% endif %}

                <button class="install-btn bg-blue-600 text-white px-4 py-2 rounded-md mt-3">Install</button>
            </div>
        {% endfor %}
    </div>
</div>

<!-- JavaScript -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const searchInput = document.getElementById("searchInput");
    const filterButtons = document.querySelectorAll(".filter-btn");
    const apps = document.querySelectorAll(".app-card");

    // Real-time Search
    searchInput.addEventListener("input", function() {
        const searchTerm = this.value.toLowerCase();
        apps.forEach(app => {
            const appName = app.getAttribute("data-name");
            app.style.display = appName.includes(searchTerm) ? "block" : "none";
        });
    });

    // Category Filtering
    filterButtons.forEach(button => {
        button.addEventListener("click", function() {
            const category = this.getAttribute("data-category");
            apps.forEach(app => {
                app.style.display = (category === "all" || app.getAttribute("data-category") === category) ? "block" : "none";
            });
        });
    });
});
</script>

{% endblock %}
