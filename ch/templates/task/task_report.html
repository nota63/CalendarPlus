<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Task Report</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h1 { color: #333; }
        .section { margin-bottom: 20px; }
        .subtask, .log, .problem { margin-left: 20px; }
    </style>
</head>
<body>
    <h1>Task Report: {{ task.title }}</h1>
    <div class="section">
        <p><strong>Description:</strong> {{ task.description }}</p>
        <p><strong>Priority:</strong> {{ task.get_priority_display }}</p>
        <p><strong>Status:</strong> {{ task.get_status_display }}</p>
        <p><strong>Deadline:</strong> {{ task.deadline }}</p>
    </div>

    <div class="notes">
        {% if task.notes.all%}
         <p>Notes</p>
          {% for note in task.notes.all%}
            <strong>{{ note.user.username }}:</strong> 
            <span class="note-content">{{ note.note }}</span> 
            ({{ note.created_at|date:"F j, Y, g:i a" }})
          {% endfor %}
        {% else %}
          <p>No Notes Available!</p>
        {% endif %}    
    </div>

    <div class="comments">
        {% if task.comments.all%}
        <p>Comments</p>
          {% for comment in task.comments.all%}
           <strong>{{ comment.user.username }}:</strong> 
           <span class="comment-text">{{ comment.comment }}</span> 
           ({{ comment.created_at|date:"F j, Y, g:i a" }})
          {% endfor %}
        {% else %}
          <p>No Comments Yet!</p>
        {% endif %}     
    </div>

    <div class="tags">
        {% if task.tags.all%}
        <p>Tags</p>
          {% for tag in task.tags.all %}
             <p>{{tag.name}}</p>
          {% endfor %}
        {% else %}
          <p>No Tags Attached!</p>
        {% endif %}       
    </div>







    <div class="section">
        {% if time %}
           {% for time in time %}
             <p>Time Spent on the task</p>
                <p>{{time.time_spent}}</p>
                <p>{{time.start_time}}</p>
                <p>{{time.end_time}}</p>
            {% endfor %}
        {% else %}
          <p>No time Spent Yet</p>
        {% endif %}          
    </div>


    <div class="section">
        <h2>SubTasks</h2>
        <p>See what are the subtasks for the task</p>
        {% for subtask in subtasks %}
            <p class="subtask">- {{ subtask.title }} ({{ subtask.get_status_display }}, Progress: {{ subtask.progress }}%)</p>
            <P>{{subtask.description}}</P>
            <p>{{subtask.priority}}</p>
            <p>{{subtask.deadline}}</p>
            <p>{{subtask.update_at}}</p>
        {% endfor %}
    </div>

  

    

    <div class="section">
        <h2>Activity Logs</h2>
        {% for log in activity_logs %}
            <p class="log">- {{ log.user.username }} {{ log.get_action_display }} at {{ log.timestamp }}</p>
        {% endfor %}
    </div>

    <div class="section">
        <h2>Problems</h2>
        {% if problems %}
          {% for problem in problems %}

           <strong>{{ problem.reported_by.username }}:</strong>
             {{ problem.description }}
            ({{ problem.created_at|date:"F j, Y, g:i a" }}) 
           <strong>Is Resolved: {{ problem.is_resolved }}</strong>
          {% endfor %}
        
        {% else %}
         <p>Have'nt face any problems yet!</p>
        {% endif %} 
    </div>
</body>
</html>

