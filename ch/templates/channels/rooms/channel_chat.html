{% load static%}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <!-- FullCalendar and Dependencies -->

      <!-- FullCalendar CSS -->
    <link
    href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css"
    rel="stylesheet"
/>

    <meta name="csrf-token" content="{% csrf_token %}">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
    <!-- Include jQuery from a CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>Chat in Channel: {{ channel.name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="{% static 'assets/channels/channels.css'%}" rel="stylesheet">
    <!-- Add Bootstrap 5 CSS in your <head> section -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>



<!-- Outer container to center the content on the page -->

<!-- Success message container -->
<div id="successMessage" 
     class="hidden fixed top-4 left-1/2 -translate-x-1/2 z-50 text-white font-medium px-6 py-4 rounded-xl bg-gradient-to-br from-green-500 to-emerald-600 shadow-md border border-green-600/20 backdrop-blur-sm transition-all duration-300 ease-out-back opacity-0 -translate-y-20">
    <div class="flex items-center gap-3 success-alert-content">
        <svg class="w-6 h-6 flex-shrink-0" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span class="text-base tracking-tight">Action completed successfully</span>
    </div>
</div>
  


<!---------------------------------------------MODALS ------------------------------------------------------------------------------------------------------------ -->
<!-- Modal for displaying the user list -->
<div id="userListModal" class="modal fade" tabindex="-1" aria-labelledby="userListModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content rounded-xl border-0 shadow-2xl">
            <!-- Modal Header -->
            <div class="modal-header p-6 border-b border-gray-200">
                <div class="flex items-center justify-between w-full">
                    <h3 class="modal-title text-2xl font-semibold text-gray-900 tracking-tight" id="userListModalLabel">
                        Workspace Members
                        <span class="text-sm font-medium text-gray-500 ml-2">(Channel members)</span>
                    </h3>
                    <div class="flex items-center gap-4">
                        <button class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                            <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 21v-4m0 0V5a2 2 0 012-2h3.5a2 2 0 011.949 1.563M12 3h4.5a2 2 0 012 2v14m-6 0h6M12 7v3m0 0v3m0-3h3m-3 0H9"/>
                            </svg>
                        </button>
                        <button type="button" class="btn-close p-2" data-bs-dismiss="modal" aria-label="Close">
                            <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Modal Body -->
            <div class="modal-body flex h-[600px]">
                <!-- Feature Sidebar -->
                <div class="w-72 border-r border-gray-200 p-6 overflow-y-auto">
                    <div class="space-y-6">
                        <div class="pb-4 border-b border-gray-200">
                            <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-4">Workspace Tools</h4>
                            <div class="space-y-2">
                                <!-- Premium Features List -->
                                <div class="group relative p-3 rounded-lg hover:bg-blue-50 transition-colors cursor-not-allowed">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                                            <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                            </svg>
                                        </div>
                                        <span class="text-sm font-medium text-gray-900">Time Tracking</span>
                                        <span class="pro-badge absolute top-2 right-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white text-[10px] font-semibold px-2 py-1 rounded-full">PRO</span>
                                    </div>
                                </div>
                                
                                <!-- Repeat similar blocks for 10+ features -->
                                <div class="group relative p-3 rounded-lg hover:bg-purple-50 transition-colors cursor-not-allowed">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                                            <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                                            </svg>
                                        </div>
                                        <span class="text-sm font-medium text-gray-900">Templates Library</span>
                                        <span class="pro-badge absolute top-2 right-2 bg-gradient-to-r from-purple-600 to-purple-500 text-white text-[10px] font-semibold px-2 py-1 rounded-full">PRO</span>
                                    </div>
                                </div>

                                 <!-- Repeat similar blocks for 10+ features -->
                                 <div class="group relative p-3 rounded-lg hover:bg-purple-50 transition-colors cursor-not-allowed">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                                            <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M3 5a2 2 0 012-2h1.28a2 2 0 011.79 1.1l1.12 2.24a2 2 0 01-.45 2.45l-.7.7a16 16 0 006.36 6.36l.7-.7a2 2 0 012.45-.45l2.24 1.12A2 2 0 0119 19.72V21a2 2 0 01-2 2h-.5C8.22 23 1 15.78 1 7.5V7a2 2 0 012-2z"/>
                                              </svg>
                                              
                                        </div>
                                        <span class="text-sm font-medium text-gray-900">Voice Call</span>
                                        <span class="pro-badge absolute top-2 right-2 bg-gradient-to-r from-purple-600 to-purple-500 text-white text-[10px] font-semibold px-2 py-1 rounded-full">PRO</span>
                                    </div>
                                </div>

                                 <!-- Repeat similar blocks for 10+ features -->
                                 <div class="group relative p-3 rounded-lg hover:bg-purple-50 transition-colors cursor-not-allowed">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                                            <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M4 12v1a3 3 0 003 3h10a3 3 0 003-3v-1M12 5l7 7-7 7M12 5v14"/>
                                              </svg>
                                              
                                        </div>
                                        <span class="text-sm font-medium text-gray-900">Direct Share</span>
                                        <span class="pro-badge absolute top-2 right-2 bg-gradient-to-r from-purple-600 to-purple-500 text-white text-[10px] font-semibold px-2 py-1 rounded-full">PRO</span>
                                    </div>
                                </div>

                                  <!-- Repeat similar blocks for 10+ features -->
                                  <div class="group relative p-3 rounded-lg hover:bg-purple-50 transition-colors cursor-not-allowed">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                                            <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M7 8h10M7 16h10M10 4l-2 16M16 4l-2 16"/>
                                              </svg>
                                              
                                        </div>
                                        <span class="text-sm font-medium text-gray-900">Extend Channel</span>
                                        <span class="pro-badge absolute top-2 right-2 bg-gradient-to-r from-purple-600 to-purple-500 text-white text-[10px] font-semibold px-2 py-1 rounded-full">PRO</span>
                                    </div>
                                </div>


                                <!-- Add 8 more feature blocks with different icons/colors -->
                                
                                <!-- Upgrade CTA -->
                                <div class="mt-8 p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg border border-blue-200">
                                    <h4 class="text-sm font-semibold text-blue-900 mb-2">Unlock Premium Features</h4>
                                    <p class="text-xs text-blue-700 mb-4">Upgrade to CalendarPro for advanced capabilities</p>
                                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold py-2 px-4 rounded-lg transition-colors shadow-sm">
                                        Upgrade Now →
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="flex-1 p-6 overflow-y-auto">
                    <div class="mb-6">
                        <div class="relative">
                            <input type="search" placeholder="Search members..." 
                                   class="w-full pl-10 pr-4 py-2.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <svg class="absolute left-3 top-3 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                            </svg>
                        </div>
                    </div>

                    <ul id="userList" class="space-y-2">
                        <!-- User List Items -->
                        <li class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors">
                            <div class="relative">
                                <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white font-semibold">JD</div>
                                <span class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 border-2 border-white rounded-full"></span>
                            </div>
                            <div class="ml-4">
                                <h4 class="text-sm font-semibold text-gray-900">John Doe</h4>
                                <p class="text-xs text-gray-500">Administrator</p>
                            </div>
                        </li>

                        <!-- More user items with different status/roles -->
                    </ul>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="modal-footer px-6 py-4 border-t border-gray-200">
                <div class="flex items-center justify-between w-full">
                    <div class="flex items-center gap-2 text-sm text-gray-600">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span>Manage workspace permissions and roles</span>
                    </div>
                    <button type="button" class="btn btn-secondary px-5 py-2.5 text-sm font-medium rounded-lg transition-colors" data-bs-dismiss="modal">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- Bootstrap 5 Modal to show the logs -->
<div class="modal fade" id="activityLogsModal" tabindex="-1" aria-labelledby="activityLogsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content rounded-xl border-0 shadow-2xl overflow-hidden">
            <div class="modal-header p-6 border-b border-gray-200 bg-gray-50">
                <h3 class="modal-title text-xl font-semibold text-gray-900 flex items-center gap-3">
                    <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Activity Timeline
                </h3>
                <button type="button" class="p-2 hover:bg-gray-200 rounded-lg transition-colors" data-bs-dismiss="modal">
                    <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>

            <div class="modal-body p-0 h-[65vh]">
                <div class="relative px-8 py-6 h-full">
                    <!-- Timeline Line -->
                    <div class="absolute left-[34px] top-0 w-0.5 h-full bg-gray-200/80"></div>
                    
                    <div id="activityLogsList" class="space-y-6 h-full overflow-y-auto pb-4">
                        <!-- Timeline Item -->
                        <div class="relative flex gap-4 group">
                            <!-- Timeline Dot -->
                            <div class="absolute left-[26px] top-5 z-10 w-3.5 h-3.5 bg-blue-600 rounded-full ring-4 ring-white"></div>
                            
                            <!-- Content Card -->
                            <div class="w-full pl-14 pr-6">
                                <div class="p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:border-blue-200 transition-all">
                                    <div class="flex items-start justify-between gap-4">
                                        <div class="flex-1 min-w-0">
                                            <div class="flex items-center gap-3 mb-2">
                                                <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                                                    <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                                    </svg>
                                                </div>
                                                <div class="flex flex-col">
                                                    <span class="text-sm font-semibold text-gray-900">Task Created</span>
                                                    <span class="text-xs text-gray-500 mt-1">#TASK-42</span>
                                                </div>
                                            </div>
                                            <p class="text-sm text-gray-600 ml-11">
                                                "Initialize project setup" created by 
                                                <span class="font-medium text-blue-600">John Doe</span>
                                            </p>
                                            <div class="mt-3 ml-11 flex items-center gap-2 text-xs text-gray-500">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                                </svg>
                                                <span>2 hours ago</span>
                                            </div>
                                        </div>
                                        <div class="flex-shrink-0">
                                            <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-medium text-gray-600">JD</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Repeat timeline items here -->
                    </div>
                </div>
            </div>

            <div class="modal-footer px-6 py-4 border-t border-gray-200 bg-gray-50">
                <div class="flex items-center justify-between w-full">
                    <div class="flex items-center gap-2 text-sm text-gray-600">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span>Real-time updates · 90 day history</span>
                    </div>
                    <button type="button" class="px-5 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors shadow-sm" data-bs-dismiss="modal">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- Modal for Channel Details -->

<!-- Updated Modal Structure while preserving original IDs and structure -->
<div id="channelDetailsModal" class="modal fade" tabindex="-1" aria-labelledby="channelDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content channel-modal">
        <div class="modal-header">
          <h5 class="modal-title" id="channelDetailsModalLabel">
            <i class="bi bi-hash-lg text-primary"></i> Channel Details
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        
        <div class="channel-content-wrapper">
          <!-- Feature Sidebar -->
          <div class="feature-sidebar">
            <div class="feature-item active">
              <i class="bi bi-info-circle"></i> Overview
            </div>
            <div class="feature-item">
              <i class="bi bi-gear"></i> Settings
            </div>
            <div class="feature-item">
              <i class="bi bi-shield-check"></i> Permissions
              <span class="badge-pro">PRO</span>
            </div>
            <div class="feature-item">
              <i class="bi bi-graph-up"></i> Analytics
              <span class="badge-pro">PRO</span>
            </div>
            <div class="feature-item">
              <i class="bi bi-calendar-event"></i> Schedule
            </div>
            <div class="feature-item">
              <i class="bi bi-file-earmark-text"></i> Files
            </div>
            <div class="feature-item">
              <i class="bi bi-box"></i> Integrations
              <span class="badge-pro">PRO</span>
            </div>
            <div class="feature-item">
              <i class="bi bi-bell"></i> Notifications
            </div>
          </div>
          
          <!-- Channel Info Section -->
          <div class="info-section">
            <div class="info-card">
              <h5>About</h5>
              <div class="info-item">
                <div class="info-label">Name</div>
                <div class="info-value" id="channelName"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Type</div>
                <div class="info-value" id="channelType"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Visibility</div>
                <div class="info-value" id="channelVisibility"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Created At</div>
                <div class="info-value" id="channelCreatedAt"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Created By</div>
                <div class="info-value" id="channelCreatedBy"></div>
              </div>
            </div>
          </div>
          
          <!-- Members Section -->
          <div class="members-section">
            <h5>Members</h5>
            <ul id="membersList" class="list-group" style="list-style: none; padding: 0;">
              <!-- Members will be dynamically populated here by the existing JS code -->
            </ul>
          </div>
        </div>
        
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
</div>


<!-- Popup Message -->
<div id="popupMessage" class="popup-message" style="display: none;">
    We'll export the data and send it to {{request.user.email}}. You can proceed with other tasks in the meantime...
</div>


<!-- Modal to Display the Channel Statistics -->

<div class="modal fade" id="statisticsModal" tabindex="-1" aria-labelledby="statisticsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
      <div class="modal-content bg-gray-50">
        <!-- Modal Header with Navigation -->
        <div class="modal-header bg-white shadow-sm border-0 px-4">
          <div class="container-fluid">
            <div class="row align-items-center">
              <div class="col">
                <h4 class="modal-title text-gray-800 font-semibold" id="statisticsModalLabel">
                  <i class="fas fa-chart-line text-blue-500 me-2"></i>Channel Analytics Dashboard
                </h4>
              </div>
              <div class="col-auto">
                <div class="d-flex align-items-center">
                  <div class="dropdown me-3">
                    <button class="btn btn-sm btn-light border-0 shadow-sm dropdown-toggle text-gray-700" type="button" id="timeRangeDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                      <i class="far fa-calendar me-1"></i> Last 30 Days
                    </button>
                    <ul class="dropdown-menu shadow border-0" aria-labelledby="timeRangeDropdown">
                      <li><a class="dropdown-item" href="#">Last 7 Days</a></li>
                      <li><a class="dropdown-item" href="#">Last 30 Days</a></li>
                      <li><a class="dropdown-item" href="#">Last Quarter</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="#">Custom Range</a></li>
                    </ul>
                  </div>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Modal Body with Dashboard Content -->
        <div class="modal-body p-0">
          <div class="container-fluid">
            <!-- Top Stats Cards -->
            <div class="row g-3 p-4">
              <div class="col-md-3">
                <div class="card border-0 shadow-sm rounded-lg h-100 bg-white hover:shadow transition-shadow">
                  <div class="card-body p-4">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                      <h6 class="text-sm font-medium text-gray-500">Total Messages</h6>
                      <span class="flex items-center justify-center w-10 h-10 rounded-full bg-blue-50">
                        <i class="fas fa-comment text-blue-500"></i>
                      </span>
                    </div>
                    <h2 class="text-3xl font-bold text-gray-800" id="totalMessages">0</h2>
                    <div class="mt-2 text-sm text-green-500">
                      <i class="fas fa-arrow-up me-1"></i>12.5% from last period
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="col-md-3">
                <div class="card border-0 shadow-sm rounded-lg h-100 bg-white hover:shadow transition-shadow">
                  <div class="card-body p-4">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                      <h6 class="text-sm font-medium text-gray-500">Total Links</h6>
                      <span class="flex items-center justify-center w-10 h-10 rounded-full bg-purple-50">
                        <i class="fas fa-link text-purple-500"></i>
                      </span>
                    </div>
                    <h2 class="text-3xl font-bold text-gray-800" id="totalLinks">0</h2>
                    <div class="mt-2 text-sm text-green-500">
                      <i class="fas fa-arrow-up me-1"></i>8.3% from last period
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="col-md-3">
                <div class="card border-0 shadow-sm rounded-lg h-100 bg-white hover:shadow transition-shadow">
                  <div class="card-body p-4">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                      <h6 class="text-sm font-medium text-gray-500">Engagement Rate</h6>
                      <span class="flex items-center justify-center w-10 h-10 rounded-full bg-green-50">
                        <i class="fas fa-chart-line text-green-500"></i>
                      </span>
                    </div>
                    <h2 class="text-3xl font-bold text-gray-800">32.7%</h2>
                    <div class="mt-2 text-sm text-red-500">
                      <i class="fas fa-arrow-down me-1"></i>2.1% from last period
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="col-md-3">
                <div class="card border-0 shadow-sm rounded-lg h-100 bg-white hover:shadow transition-shadow">
                  <div class="card-body p-4">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                      <h6 class="text-sm font-medium text-gray-500">Top Contributor</h6>
                      <span class="flex items-center justify-center w-10 h-10 rounded-full bg-amber-50">
                        <i class="fas fa-crown text-amber-500"></i>
                      </span>
                    </div>
                    <h2 class="text-xl font-bold text-gray-800 text-truncate" id="kingUser">-</h2>
                    <div class="mt-2 text-sm text-gray-500">
                      <i class="fas fa-trophy me-1 text-amber-500"></i>Leading for 4 weeks
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Charts Grid Layout -->
            <div class="row g-3 px-4 pb-4">
              <!-- Message Activity -->
              <div class="col-lg-8">
                <div class="card border-0 shadow-sm rounded-lg bg-white">
                  <div class="card-header bg-white border-0 py-3">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="card-title mb-0 text-gray-700 font-medium">Message Activity</h5>
                      <div class="btn-group" role="group" aria-label="Chart view options">
                        <button type="button" class="btn btn-sm btn-outline-secondary active">Day</button>
                        <button type="button" class="btn btn-sm btn-outline-secondary">Week</button>
                        <button type="button" class="btn btn-sm btn-outline-secondary">Month</button>
                      </div>
                    </div>
                  </div>
                  <div class="card-body p-0 pb-3">
                    <div class="p-4 pb-0" style="height: 300px;">
                      <canvas id="messagesChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Link Sharing -->
              <div class="col-lg-4">
                <div class="card border-0 shadow-sm rounded-lg bg-white">
                  <div class="card-header bg-white border-0 py-3">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="card-title mb-0 text-gray-700 font-medium">Link Sharing</h5>
                      <button class="btn btn-sm btn-link text-decoration-none p-0">
                        <i class="fas fa-ellipsis-v text-gray-400"></i>
                      </button>
                    </div>
                  </div>
                  <div class="card-body">
                    <div style="height: 270px;">
                      <canvas id="linksChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- User Message Distribution -->
              <div class="col-lg-6">
                <div class="card border-0 shadow-sm rounded-lg bg-white">
                  <div class="card-header bg-white border-0 py-3">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="card-title mb-0 text-gray-700 font-medium">User Message Distribution</h5>
                      <button class="btn btn-sm btn-link text-decoration-none p-0">
                        <i class="fas fa-ellipsis-v text-gray-400"></i>
                      </button>
                    </div>
                  </div>
                  <div class="card-body">
                    <div style="height: 300px;">
                      <canvas id="userMessageCountsChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- User Link Distribution -->
              <div class="col-lg-6">
                <div class="card border-0 shadow-sm rounded-lg bg-white">
                  <div class="card-header bg-white border-0 py-3">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="card-title mb-0 text-gray-700 font-medium">User Link Distribution</h5>
                      <button class="btn btn-sm btn-link text-decoration-none p-0">
                        <i class="fas fa-ellipsis-v text-gray-400"></i>
                      </button>
                    </div>
                  </div>
                  <div class="card-body">
                    <div style="height: 300px;">
                      <canvas id="userLinkCountsChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Growth Trends -->
              <div class="col-lg-8">
                <div class="card border-0 shadow-sm rounded-lg bg-white">
                  <div class="card-header bg-white border-0 py-3">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="card-title mb-0 text-gray-700 font-medium">Growth Trends</h5>
                      <div class="btn-group" role="group" aria-label="Display options">
                        <button type="button" class="btn btn-sm btn-outline-secondary active">Messages</button>
                        <button type="button" class="btn btn-sm btn-outline-secondary">Links</button>
                        <button type="button" class="btn btn-sm btn-outline-secondary">Combined</button>
                      </div>
                    </div>
                  </div>
                  <div class="card-body p-0 pb-3">
                    <div class="row g-0">
                      <div class="col-md-6">
                        <div class="p-4" style="height: 250px;">
                          <canvas id="totalMessagesChart"></canvas>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="p-4" style="height: 250px;">
                          <canvas id="totalLinksChart"></canvas>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Top Contributor Stats -->
              <div class="col-lg-4">
                <div class="card border-0 shadow-sm rounded-lg bg-white">
                  <div class="card-header bg-white border-0 py-3">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="card-title mb-0 text-gray-700 font-medium">Top Contributor Stats</h5>
                      <button class="btn btn-sm btn-link text-decoration-none p-0">
                        <i class="fas fa-ellipsis-v text-gray-400"></i>
                      </button>
                    </div>
                  </div>
                  <div class="card-body">
                    <div style="height: 250px;">
                      <canvas id="kingUserChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Modal Footer with Actions -->
        <div class="modal-footer bg-white border-0 shadow-sm">
          <div class="container-fluid">
            <div class="row align-items-center">
              <div class="col">
                <div class="btn-group" role="group" aria-label="Export options">
                  <button type="button" class="btn btn-sm btn-outline-secondary">
                    <i class="fas fa-download me-1"></i>Export PDF
                  </button>
                  <button type="button" class="btn btn-sm btn-outline-secondary">
                    <i class="fas fa-file-csv me-1"></i>Export CSV
                  </button>
                </div>
              </div>
              <div class="col-auto">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary ms-2">
                  <i class="fas fa-sync-alt me-1"></i>Refresh Data
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>
  


<!-- Coming Soon Modal -->
<div id="comingSoonModal" class="hidden fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-center justify-center z-[9999]">
    <div class="relative bg-white rounded-2xl shadow-2xl max-w-[420px] w-full mx-4 overflow-hidden">
        <!-- Header Section -->
        <div class="bg-gradient-to-br from-blue-600 to-purple-500 p-6">
            <div class="flex justify-center mb-4">
                <div class="w-16 h-16 bg-white/10 rounded-full flex items-center justify-center backdrop-blur-sm">
                    <svg class="w-8 h-8 text-white animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                </div>
            </div>
            <h2 class="text-2xl font-bold text-center text-white mb-2">New Feature Coming!</h2>
            <p class="text-sm text-center text-blue-100/90 font-medium">We're polishing the final details</p>
        </div>

        <!-- Content Section -->
        <div class="px-8 py-6">
            <div class="space-y-4">
                <p class="text-gray-600 text-center leading-relaxed">
                    This powerful feature is currently in development. Stay tuned for updates!
                </p>
                
                <!-- Newsletter Subscription -->
                <div class="mt-6 space-y-3">
                    <input type="email" placeholder="Enter email for updates" 
                           class="w-full px-4 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <button class="w-full bg-gradient-to-r from-blue-600 to-blue-500 text-white px-6 py-2.5 rounded-lg font-semibold
                                  hover:from-blue-700 hover:to-blue-600 transition-all shadow-sm">
                        Notify Me
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer Section -->
        <div class="px-6 py-4 bg-gray-50 border-t border-gray-100">
            <div class="flex items-center justify-between">
                <span class="text-xs text-gray-500">Estimated launch: Q4 2025</span>
                <button id="closeComingSoonModal" 
                        class="text-gray-500 hover:text-gray-700 transition-colors
                               px-4 py-2 rounded-lg text-sm font-medium">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>





<!-- Filter Modal -->
<div id="filterModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
    <div class="bg-white rounded-xl shadow-xl w-full max-w-md transform transition-all duration-300 ease-in-out">
        <!-- Header -->
        <div class="px-6 py-4 border-b border-gray-100 flex items-center justify-between">
            <h2 class="text-xl font-semibold text-gray-800">
                <i class="fas fa-filter text-blue-500 mr-2"></i>Filter Data
            </h2>
            <button id="closeFilterModalX" class="text-gray-400 hover:text-gray-600 transition-colors">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <!-- Body -->
        <div class="p-6">
            <p class="text-sm text-gray-500 mb-4">Select a time period to filter your dashboard data</p>
            
            <!-- Filter options with modern radio styling -->
            <div class="space-y-3">
                <div class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer">
                    <input type="radio" id="today" name="filter" value="today" 
                           class="form-radio h-5 w-5 text-blue-600 focus:ring-blue-500">
                    <label for="today" class="ml-3 text-gray-700 font-medium cursor-pointer flex items-center">
                        <i class="far fa-calendar-day mr-2 text-blue-500"></i>Today
                    </label>
                </div>
                
                <div class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer">
                    <input type="radio" id="yesterday" name="filter" value="yesterday" 
                           class="form-radio h-5 w-5 text-blue-600 focus:ring-blue-500">
                    <label for="yesterday" class="ml-3 text-gray-700 font-medium cursor-pointer flex items-center">
                        <i class="far fa-calendar-minus mr-2 text-purple-500"></i>Yesterday
                    </label>
                </div>
                
                <div class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer">
                    <input type="radio" id="last_week" name="filter" value="last_week" 
                           class="form-radio h-5 w-5 text-blue-600 focus:ring-blue-500">
                    <label for="last_week" class="ml-3 text-gray-700 font-medium cursor-pointer flex items-center">
                        <i class="far fa-calendar-week mr-2 text-green-500"></i>Last 7 Days
                    </label>
                </div>
                
                <div class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer">
                    <input type="radio" id="last_month" name="filter" value="last_month" 
                           class="form-radio h-5 w-5 text-blue-600 focus:ring-blue-500">
                    <label for="last_month" class="ml-3 text-gray-700 font-medium cursor-pointer flex items-center">
                        <i class="far fa-calendar-alt mr-2 text-amber-500"></i>Last 30 Days
                    </label>
                </div>
                
                <div class="p-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer">
                    <div class="flex items-center">
                        <input type="radio" id="specific_date" name="filter" value="specific_date" 
                               class="form-radio h-5 w-5 text-blue-600 focus:ring-blue-500">
                        <label for="specific_date" class="ml-3 text-gray-700 font-medium cursor-pointer flex items-center">
                            <i class="far fa-calendar-check mr-2 text-red-500"></i>Custom Date
                        </label>
                    </div>
                    <div class="mt-3 ml-8" id="datePickerContainer">
                        <input type="date" id="specificDate" 
                               class="form-input block w-full px-3 py-2 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" 
                               style="display:none;">
                    </div>
                </div>
            </div>
            
            <!-- Date range option -->
            <div class="mt-4 p-3 border-t border-gray-100">
                <div class="flex items-center">
                    <input type="checkbox" id="compareWithPrevious" 
                           class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                    <label for="compareWithPrevious" class="ml-3 text-gray-700 text-sm cursor-pointer">
                        Compare with previous period
                    </label>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="px-6 py-4 bg-gray-50 rounded-b-xl flex justify-end space-x-2">
            <button id="resetFilter" class="px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 focus:outline-none">
                Reset
            </button>
            <button id="closeFilterModal" class="px-4 py-2 text-sm font-medium text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors">
                Cancel
            </button>
            <button id="applyFilter" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">
                Apply Filter
            </button>
        </div>
    </div>
</div>




<!-- Delete Messages Modal -->
<div id="deleteMessagesModal" class="hidden fixed inset-0 bg-slate-900/75 backdrop-blur-sm flex items-center justify-center z-50 transition-all duration-300">
    <div class="bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-300 scale-100 p-0 overflow-hidden">
      <!-- Modal Header -->
      <div class="bg-gradient-to-r from-rose-500 to-pink-600 p-6">
        <div class="flex items-center">
          <div class="bg-white/20 p-2 rounded-lg mr-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
          </div>
          <h2 class="text-2xl font-bold text-white">Delete All Messages</h2>
        </div>
      </div>
      
      <!-- Modal Body -->
      <div class="p-6">
        <div class="mb-6">
          <div class="bg-amber-50 border-l-4 border-amber-500 text-amber-700 p-4 mb-6 rounded-r-lg">
            <div class="flex">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
              </svg>
              <span class="font-medium">All your messages including texts, links etc will be deleted from this channel!</span>
            </div>
          </div>
          <p class="text-slate-600 dark:text-slate-300 text-sm mb-4">
            Please enter your password to confirm. This action cannot be undone.
          </p>
          <div class="relative">
            <input
              type="password"
              id="passwordInput"
              class="block w-full px-4 py-3 rounded-lg border border-slate-300 focus:border-indigo-500 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 transition-all duration-200 dark:bg-slate-700 dark:border-slate-600 dark:text-white"
              placeholder="Enter your password"
            >
            <div class="absolute inset-y-0 right-0 pr-3 flex items-center text-sm leading-5">
              <button id="togglePassword" class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-300">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Modal Footer -->
      <div class="px-6 py-4 bg-slate-50 dark:bg-slate-700/30 flex justify-end space-x-3">
        <button id="cancelDeleteButton" class="px-4 py-2 rounded-lg text-slate-700 bg-slate-200 hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-opacity-50 transition-all duration-200 font-medium dark:bg-slate-600 dark:text-slate-200 dark:hover:bg-slate-500">
          Cancel
        </button>
        <button id="confirmDeleteButton" class="px-4 py-2 rounded-lg text-white bg-rose-500 hover:bg-rose-600 focus:outline-none focus:ring-2 focus:ring-rose-500 focus:ring-opacity-50 transition-all duration-200 font-medium shadow-sm">
          Delete All Messages
        </button>
      </div>
    </div>
</div>


<!-- Edit Message Modal -->
<div class="modal fade" id="editMessageModal" tabindex="-1" aria-labelledby="editMessageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content rounded-xl border-0 shadow-2xl overflow-hidden">
            <!-- Header -->
            <div class="modal-header bg-gradient-to-r from-blue-600 to-blue-500 px-6 py-4 border-b border-blue-500/20">
                <div class="flex items-center justify-between w-full">
                    <h3 class="modal-title text-lg font-semibold text-white flex items-center gap-2">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
                        </svg>
                        Edit Message
                    </h3>
                    <button type="button" class="p-1.5 hover:bg-white/10 rounded-lg transition-colors" data-bs-dismiss="modal">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Body -->
            <div class="modal-body p-6">
                <div class="space-y-4">
                    <div class="relative">
                        <textarea 
                            id="editMessageContent" 
                            rows="6"
                            class="w-full px-4 py-3 text-gray-900 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none transition-all"
                            placeholder="Edit your message..."
                        ></textarea>
                        <div class="absolute bottom-3 right-3 bg-white px-2 py-1 rounded-md text-sm text-gray-500 border border-gray-200">
                            <span id="charCount">0</span>/500
                        </div>
                    </div>
                    
                    <!-- Formatting Toolbar (Visual Only) -->
                    <div class="flex items-center gap-2 p-2 border border-gray-200 rounded-lg">
                        <button class="p-2 hover:bg-gray-100 rounded" type="button">
                            <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6h18M3 12h18M3 18h18"/>
                            </svg>
                        </button>
                        <button class="p-2 hover:bg-gray-100 rounded" type="button">
                            <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                            </svg>
                        </button>
                        <!-- Add more formatting buttons -->
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="modal-footer px-6 py-4 border-t border-gray-200 bg-gray-50">
                <div class="flex items-center justify-between w-full">
                    <div class="flex items-center gap-2 text-sm text-gray-600">
                        <svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                        <span>Last edited 2 minutes ago</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <button type="button" 
                                class="px-5 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
                                data-bs-dismiss="modal">
                            Discard
                        </button>
                        <button type="button" 
                                class="px-5 py-2.5 text-white bg-gradient-to-r from-blue-600 to-blue-500 rounded-lg font-medium hover:from-blue-700 hover:to-blue-600 transition-all shadow-sm"
                                id="saveEditButton">
                            Save Changes
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<!-- Modal for editing link -->
<div class="modal fade" id="editLinkModal" tabindex="-1" aria-labelledby="editLinkModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content rounded-xl border-0 shadow-2xl overflow-hidden">
            <!-- Header -->
            <div class="modal-header bg-gradient-to-br from-blue-600 to-purple-500 px-6 py-4 border-b border-white/10">
                <div class="flex items-center justify-between w-full">
                    <h3 class="modal-title text-lg font-semibold text-white flex items-center gap-3">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                        </svg>
                        Edit Hyperlink
                    </h3>
                    <button type="button" class="p-1.5 hover:bg-white/10 rounded-lg transition-colors" data-bs-dismiss="modal">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Body -->
            <div class="modal-body p-6">
                <form id="editLinkForm" class="space-y-6">
                    <!-- Link Text -->
                    <div class="space-y-2">
                        <label class="text-sm font-medium text-gray-700 flex items-center gap-1">
                            Display Text
                            <span class="text-red-500">*</span>
                        </label>
                        <div class="relative">
                            <input type="text" 
                                   id="editLinkText" 
                                   required
                                   class="w-full px-4 py-3 text-gray-900 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 pr-10 transition-all"
                                   placeholder="Enter link text">
                            <div class="absolute inset-y-0 right-3 flex items-center">
                                <span class="text-gray-400 text-sm" id="textCounter">0/60</span>
                            </div>
                        </div>
                    </div>

                    <!-- URL Input -->
                    <div class="space-y-2">
                        <label class="text-sm font-medium text-gray-700 flex items-center gap-1">
                            URL
                            <span class="text-red-500">*</span>
                        </label>
                        <div class="relative">
                            <input type="url" 
                                   id="editLinkUrl" 
                                   required
                                   class="w-full px-4 py-3 text-gray-900 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 pl-10 transition-all"
                                   placeholder="https://example.com">
                            <div class="absolute inset-y-0 left-3 flex items-center">
                                <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Options -->
                    <div class="space-y-4 pt-4 border-t border-gray-100">
                        <h4 class="text-sm font-semibold text-gray-900">Advanced Settings</h4>
                        
                        <!-- Link Target -->
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="linkTarget" class="form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500">
                            <label class="text-sm text-gray-700">Open in new tab</label>
                        </div>

                        <!-- Nofollow -->
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="linkNofollow" class="form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500">
                            <label class="text-sm text-gray-700">Add nofollow attribute</label>
                        </div>

                        <!-- Link Preview -->
                        <div class="mt-4 p-3 bg-gray-50 rounded-lg border border-gray-200">
                            <p class="text-sm text-gray-600 mb-1">Preview:</p>
                            <a href="#" id="linkPreview" class="text-blue-600 hover:text-blue-700 text-sm font-medium transition-colors" target="_blank" rel="noopener">
                                Sample Link Preview
                            </a>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Footer -->
            <div class="modal-footer px-6 py-4 border-t border-gray-200 bg-gray-50">
                <div class="flex items-center justify-between w-full">
                    <div class="text-sm text-gray-500">
                        <span id="urlStatus" class="flex items-center gap-1">
                            <svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                            </svg>
                            Valid URL
                        </span>
                    </div>
                    <div class="flex items-center gap-3">
                        <button type="button" 
                                class="px-5 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
                                data-bs-dismiss="modal">
                            Cancel
                        </button>
                        <button type="submit" 
                                class="px-5 py-2.5 text-white bg-gradient-to-r from-blue-600 to-blue-500 rounded-lg font-medium hover:from-blue-700 hover:to-blue-600 transition-all shadow-sm"
                                id="saveEditLinkButton">
                            Save Changes
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<!-- Modal for channel stats -->

<div class="modal fade" id="statsModal" tabindex="-1" aria-labelledby="statsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl modal-fullscreen-lg-down">
      <div class="modal-content border-0 shadow-lg">
        <!-- Modal Header -->
        <div class="modal-header bg-gradient-to-r from-indigo-600 to-blue-500 text-white py-3">
          <div class="d-flex align-items-center">
            <div class="bg-white/20 p-2 rounded-lg me-3">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zm6-4a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zm6-3a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z" />
              </svg>
            </div>
            <h5 class="modal-title fs-4 fw-bold" id="statsModalLabel">Memory Analytics Dashboard</h5>
          </div>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        
        <!-- Modal Body with Sidebar Layout -->
        <div class="modal-body p-0">
          <div class="container-fluid">
            <div class="row g-0">
              <!-- Sidebar -->
              <div class="col-md-3 border-end bg-light p-0">
                <div class="sidebar-header bg-gray-100 p-3 border-bottom">
                  <h6 class="mb-0 fw-bold text-gray-800">Memory Management</h6>
                </div>
                
                <div class="nav flex-column nav-pills p-2" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                  <!-- Active Tab -->
                  <a class="nav-link active d-flex justify-content-between align-items-center mb-2 rounded-lg" id="usage-overview-tab" data-bs-toggle="pill" href="#usage-overview" role="tab">
                    <div class="d-flex align-items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 me-2" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
                      </svg>
                      Usage Overview
                    </div>
                  </a>
                  
                  <!-- Other Tabs with Pro Badge -->
                  <a class="nav-link d-flex justify-content-between align-items-center mb-2 rounded-lg" id="file-usage-tab" data-bs-toggle="pill" href="#file-usage" role="tab">
                    <div class="d-flex align-items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 me-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                      </svg>
                      Media Analytics
                    </div>
                    <span class="badge bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs fw-bold py-1 px-2">PRO</span>
                  </a>
                  
                  <a class="nav-link d-flex justify-content-between align-items-center mb-2 rounded-lg" id="cleanup-tools-tab" data-bs-toggle="pill" href="#cleanup-tools" role="tab">
                    <div class="d-flex align-items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 me-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                      </svg>
                      Cleanup Tools
                    </div>
                    <span class="badge bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs fw-bold py-1 px-2">PRO</span>
                  </a>
                  
                  <a class="nav-link d-flex justify-content-between align-items-center mb-2 rounded-lg" id="storage-optimizer-tab" data-bs-toggle="pill" href="#storage-optimizer" role="tab">
                    <div class="d-flex align-items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 me-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd" />
                      </svg>
                      Storage Optimizer
                    </div>
                    <span class="badge bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs fw-bold py-1 px-2">PRO</span>
                  </a>
                  
                  <a class="nav-link d-flex justify-content-between align-items-center mb-2 rounded-lg" id="retention-policy-tab" data-bs-toggle="pill" href="#retention-policy" role="tab">
                    <div class="d-flex align-items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 me-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
                      </svg>
                      Retention Policy
                    </div>
                    <span class="badge bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs fw-bold py-1 px-2">PRO</span>
                  </a>
                  
                  <a class="nav-link d-flex justify-content-between align-items-center mb-2 rounded-lg" id="usage-forecast-tab" data-bs-toggle="pill" href="#usage-forecast" role="tab">
                    <div class="d-flex align-items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 me-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 101.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                      </svg>
                      Usage Forecast
                    </div>
                    <span class="badge bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs fw-bold py-1 px-2">PRO</span>
                  </a>
                  
                  <a class="nav-link d-flex justify-content-between align-items-center mb-2 rounded-lg" id="export-data-tab" data-bs-toggle="pill" href="#export-data" role="tab">
                    <div class="d-flex align-items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 me-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z" clip-rule="evenodd" />
                      </svg>
                      Export Analytics
                    </div>
                    <span class="badge bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs fw-bold py-1 px-2">PRO</span>
                  </a>
                </div>
              </div>
              
              <!-- Main Content Area -->
              <div class="col-md-9">
                <div class="tab-content p-4" id="v-pills-tabContent">
                  <!-- Usage Overview Tab (Active by default) -->
                  <div class="tab-pane fade show active" id="usage-overview" role="tabpanel">
                    <div class="row mb-4">
                      <div class="col-12">
                        <div class="d-flex justify-content-between mb-3">
                          <h4 class="fw-bold text-gray-800">Memory Usage Overview</h4>
                          <div class="btn-group">
                            <button type="button" class="btn btn-sm btn-outline-primary">7 Days</button>
                            <button type="button" class="btn btn-sm btn-primary">30 Days</button>
                            <button type="button" class="btn btn-sm btn-outline-primary">90 Days</button>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Quick Stats Cards -->
                    <div class="row g-3 mb-4">
                      <div class="col-md-4">
                        <div class="card border-0 shadow-sm rounded-lg h-100">
                          <div class="card-body">
                            <div class="d-flex justify-content-between">
                              <div>
                                <h6 class="text-muted mb-1 text-uppercase text-xs">Total Usage</h6>
                                <h3 class="fw-bold mb-0">438.2 MB</h3>
                              </div>
                              <div class="bg-primary bg-opacity-10 rounded-circle p-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                              </div>
                            </div>
                            <div class="mt-3">
                              <span class="badge bg-success">+12.4% </span>
                              <span class="text-sm text-muted">since last month</span>
                            </div>
                          </div>
                        </div>
                      </div>
                      
                      <div class="col-md-4">
                        <div class="card border-0 shadow-sm rounded-lg h-100">
                          <div class="card-body">
                            <div class="d-flex justify-content-between">
                              <div>
                                <h6 class="text-muted mb-1 text-uppercase text-xs">Media Files</h6>
                                <h3 class="fw-bold mb-0">275.8 MB</h3>
                              </div>
                              <div class="bg-info bg-opacity-10 rounded-circle p-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-info" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                              </div>
                            </div>
                            <div class="mt-3">
                              <span class="badge bg-danger">-5.2% </span>
                              <span class="text-sm text-muted">since last month</span>
                            </div>
                          </div>
                        </div>
                      </div>
                      
                      <div class="col-md-4">
                        <div class="card border-0 shadow-sm rounded-lg h-100">
                          <div class="card-body">
                            <div class="d-flex justify-content-between">
                              <div>
                                <h6 class="text-muted mb-1 text-uppercase text-xs">Text Content</h6>
                                <h3 class="fw-bold mb-0">162.4 MB</h3>
                              </div>
                              <div class="bg-warning bg-opacity-10 rounded-circle p-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-warning" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                              </div>
                            </div>
                            <div class="mt-3">
                              <span class="badge bg-success">+8.7% </span>
                              <span class="text-sm text-muted">since last month</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Main Chart -->
                    <div class="card border-0 shadow-sm rounded-lg">
                      <div class="card-header bg-white py-3 border-0">
                        <h5 class="card-title mb-0">Memory Usage Trends</h5>
                      </div>
                      <div class="card-body">
                        <canvas id="chartContainer" height="240"></canvas>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Other tab panes with placeholder content -->
                  <div class="tab-pane fade" id="file-usage" role="tabpanel">
                    <div class="d-flex flex-column align-items-center justify-content-center py-5">
                      <div class="bg-purple-100 p-4 rounded-circle mb-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-500" viewBox="0 0 20 20" fill="currentColor">
                          <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                        </svg>
                      </div>
                      <h4 class="fw-bold mb-2">Unlock Media Analytics</h4>
                      <p class="text-center text-muted mb-4">Get detailed insights about your media files with advanced analytics.</p>
                      <button class="btn btn-primary px-4">Upgrade to Pro</button>
                    </div>
                  </div>
                  
                  <!-- Similar placeholders for other tabs -->
                  <div class="tab-pane fade" id="cleanup-tools" role="tabpanel">
                    <!-- Pro feature placeholder -->
                  </div>
                  <div class="tab-pane fade" id="storage-optimizer" role="tabpanel">
                    <!-- Pro feature placeholder -->
                  </div>
                  <div class="tab-pane fade" id="retention-policy" role="tabpanel">
                    <!-- Pro feature placeholder -->
                  </div>
                  <div class="tab-pane fade" id="usage-forecast" role="tabpanel">
                    <!-- Pro feature placeholder -->
                  </div>
                  <div class="tab-pane fade" id="export-data" role="tabpanel">
                    <!-- Pro feature placeholder -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Optional Footer -->
        <div class="modal-footer border-top bg-light">
          <button type="button" class="btn btn-sm btn-outline-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-sm btn-primary">Save Settings</button>
        </div>
      </div>
    </div>
</div>


<!-- Filter by User Modal -->
<div class="modal fade" id="filterByUserModal" tabindex="-1" aria-labelledby="filterByUserModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content rounded-xl border-0 shadow-2xl overflow-hidden">
            <!-- Header -->
            <div class="modal-header bg-gradient-to-r from-blue-600 to-purple-500 px-6 py-4 border-b border-blue-500/20">
                <div class="flex items-center justify-between w-full">
                    <h3 class="modal-title text-lg font-semibold text-white flex items-center gap-3">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                        </svg>
                        Filter by Team Members
                    </h3>
                    <button type="button" class="p-1.5 hover:bg-white/10 rounded-lg transition-colors" data-bs-dismiss="modal">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Premium Alert -->
            <div class="bg-gradient-to-r from-purple-600 to-pink-500 px-6 py-3.5">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <p class="text-sm text-white font-medium">
                            Content will be blurred!. 
                            <span class="font-semibold">Upgrade to Premium</span> for complete access!
                        </p>
                    </div>
                    <a hrf="{% url 'initiate_payment'%}">
                        <button class="px-4 py-1.5 bg-white/10 hover:bg-white/20 text-white text-sm font-semibold rounded-lg transition-colors">
                            Unlock Now →
                        </button>
                    </a>
                </div>
            </div>

            <!-- Body -->
            <div class="modal-body p-0 h-[60vh]">
                <!-- Search -->
                <div class="p-6 border-b border-gray-200">
                    <div class="relative">
                        <input type="search" 
                               placeholder="Search team members..." 
                               class="w-full pl-10 pr-4 py-2.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <svg class="absolute left-3 top-3 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                    </div>
                </div>

                <!-- User List -->
                <div class="overflow-y-auto h-[calc(60vh-150px)]">
                    <ul id="userListt" class="divide-y divide-gray-200">
                        <!-- User Item -->
                        <li class="p-4 hover:bg-gray-50/50 transition-colors group relative">
                            <div class="flex items-center gap-4">
                                <!-- Avatar -->
                                <div class="relative">
                                    <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white font-semibold text-sm">
                                        JD
                                        <div class="absolute inset-0 bg-white/80 backdrop-blur-sm rounded-lg"></div>
                                    </div>
                                    <span class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 border-2 border-white rounded-full"></span>
                                </div>
                                
                                <!-- Details -->
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-sm font-semibold text-gray-900 mb-0.5">
                                                John Doe
                                                <span class="text-xs font-medium text-purple-600 ml-2">PRO</span>
                                            </h4>
                                            <p class="text-xs text-gray-500">john@company.com</p>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <span class="text-xs px-2 py-1 bg-purple-100 text-purple-800 rounded-full">Admin</span>
                                            <div class="w-5 h-5 relative">
                                                <input type="checkbox" 
                                                       class="w-full h-full border-2 border-gray-300 rounded-md checked:bg-blue-600 checked:border-blue-600 transition-colors peer">
                                                <svg class="absolute inset-0 m-auto w-3.5 h-3.5 text-white opacity-0 peer-checked:opacity-100 transition-opacity" 
                                                     fill="none" 
                                                     stroke="currentColor" 
                                                     viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Premium Overlay -->
                            <div class="absolute inset-0 bg-white/80 backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                               <a href="{% url 'initiate_payment'%}">
                                <button class="px-4 py-1.5 bg-gradient-to-r from-purple-600 to-pink-500 text-white text-sm font-semibold rounded-lg transition-transform hover:scale-[1.02]">
                                    Upgrade to View Details
                                </button>
                               </a>
                            </div>
                        </li>

                        <!-- More Users -->
                        <li class="p-4 hover:bg-gray-50/50 transition-colors group relative">
                            <!-- Similar structure as above -->
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Footer -->
            <div class="modal-footer px-6 py-4 border-t border-gray-200 bg-gray-50">
                <div class="flex items-center justify-between w-full">
                    <div class="text-sm text-gray-600">
                        <span id="selectedCount">0</span> selected users
                    </div>
                    <div class="flex items-center gap-3">
                        <button type="button" 
                                class="px-5 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
                                data-bs-dismiss="modal">
                            Cancel
                        </button>
                        <button type="button" 
                                class="px-5 py-2.5 text-white bg-gradient-to-r from-blue-600 to-blue-500 rounded-lg font-medium hover:from-blue-700 hover:to-blue-600 transition-all shadow-sm">
                            Apply Filters
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- Modal 1: Select Data to Delete -->

<div id="deleteChannelDataModal" class="modal fade" tabindex="-1" aria-labelledby="deleteChannelDataModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg rounded-lg">
        <!-- Header -->
        <div class="modal-header bg-white border-0 px-4 py-3">
          <div class="flex items-center">
            <div class="bg-purple-600 rounded-md p-2 mr-3">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
              </svg>
            </div>
            <h5 class="modal-title font-bold text-lg text-gray-800" id="deleteChannelDataModalLabel">Select Data to Delete</h5>
          </div>
          <button type="button" class="btn-close text-gray-400 hover:text-gray-600 transition-colors focus:outline-none" data-bs-dismiss="modal" aria-label="Close">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
          </button>
        </div>
        
        <!-- Body -->
        <div class="modal-body px-4 py-4">
          <p class="text-gray-600 mb-4 text-sm">Select the types of data you want to delete from this channel:</p>
          <form id="deleteChannelDataForm">
            <div class="space-y-3">
              <!-- Messages Option -->
              <div class="relative flex items-center p-3 border border-gray-200 rounded-md hover:bg-gray-50 transition-colors">
                <input type="checkbox" class="form-check-input appearance-none h-5 w-5 border border-gray-300 rounded-md bg-white checked:bg-purple-600 checked:border-purple-600 focus:outline-none transition-colors cursor-pointer" id="deleteMessagesOption">
                <label class="form-check-label ml-3 flex-1 cursor-pointer" for="deleteMessagesOption">
                  <div class="font-medium text-gray-800">Messages</div>
                  <div class="text-xs text-gray-500">Delete all text messages from this channel</div>
                </label>
              </div>
              
              <!-- Links Option -->
              <div class="relative flex items-center p-3 border border-gray-200 rounded-md hover:bg-gray-50 transition-colors">
                <input type="checkbox" class="form-check-input appearance-none h-5 w-5 border border-gray-300 rounded-md bg-white checked:bg-purple-600 checked:border-purple-600 focus:outline-none transition-colors cursor-pointer" id="deleteLinksOption">
                <label class="form-check-label ml-3 flex-1 cursor-pointer" for="deleteLinksOption">
                  <div class="font-medium text-gray-800">Links</div>
                  <div class="text-xs text-gray-500">Delete all shared links and URLs</div>
                </label>
              </div>
              
              <!-- Audio Option -->
              <div class="relative flex items-center p-3 border border-gray-200 rounded-md hover:bg-gray-50 transition-colors">
                <input type="checkbox" class="form-check-input appearance-none h-5 w-5 border border-gray-300 rounded-md bg-white checked:bg-purple-600 checked:border-purple-600 focus:outline-none transition-colors cursor-pointer" id="deleteAudioOption">
                <label class="form-check-label ml-3 flex-1 cursor-pointer" for="deleteAudioOption">
                  <div class="font-medium text-gray-800">Audio</div>
                  <div class="text-xs text-gray-500">Delete all audio files and recordings</div>
                </label>
              </div>
              
              <!-- Video Option -->
              <div class="relative flex items-center p-3 border border-gray-200 rounded-md hover:bg-gray-50 transition-colors">
                <input type="checkbox" class="form-check-input appearance-none h-5 w-5 border border-gray-300 rounded-md bg-white checked:bg-purple-600 checked:border-purple-600 focus:outline-none transition-colors cursor-pointer" id="deleteVideoOption">
                <label class="form-check-label ml-3 flex-1 cursor-pointer" for="deleteVideoOption">
                  <div class="font-medium text-gray-800">Video</div>
                  <div class="text-xs text-gray-500">Delete all video files and recordings</div>
                </label>
              </div>
              
              <!-- Activity Logs Option -->
              <div class="relative flex items-center p-3 border border-gray-200 rounded-md hover:bg-gray-50 transition-colors">
                <input type="checkbox" class="form-check-input appearance-none h-5 w-5 border border-gray-300 rounded-md bg-white checked:bg-purple-600 checked:border-purple-600 focus:outline-none transition-colors cursor-pointer" id="deleteActivityLogsOption">
                <label class="form-check-label ml-3 flex-1 cursor-pointer" for="deleteActivityLogsOption">
                  <div class="font-medium text-gray-800">Activity Logs</div>
                  <div class="text-xs text-gray-500">Delete all user activity records</div>
                </label>
              </div>
            </div>
          </form>
        </div>
        
        <!-- Footer -->
        <div class="modal-footer border-0 px-4 py-3 flex justify-end gap-2">
          <button type="button" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-300" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500" id="nextToPasswordModalBtn">
            Continue
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block ml-1" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
          </button>
        </div>
      </div>
    </div>
</div>
  
<!-- Modal 2: Enter Password -->
<div id="deleteChannelPasswordModal" class="modal fade" tabindex="-1" aria-labelledby="deleteChannelPasswordModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content rounded-xl border-0 shadow-2xl overflow-hidden">
            <!-- Header -->
            <div class="modal-header bg-gradient-to-r from-red-600 to-orange-500 px-6 py-4 border-b border-red-500/20">
                <h5 class="modal-title text-lg font-semibold text-white flex items-center gap-3">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                    </svg>
                    Confirm Your Identity
                </h5>
                <button type="button" class="p-1.5 hover:bg-white/10 rounded-lg transition-colors" data-bs-dismiss="modal">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>

            <!-- Body -->
            <div class="modal-body p-6">
                <form id="deleteChannelPasswordForm" class="space-y-6">
                    <!-- Password Input -->
                    <div class="space-y-2">
                        <label class="text-sm font-medium text-gray-700">Security Verification</label>
                        <div class="relative">
                            <input 
                                type="password" 
                                id="channelPasswordInput"
                                class="w-full pl-10 pr-4 py-3 text-gray-900 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"
                                placeholder="Enter your account password"
                                required
                            >
                            <svg class="absolute left-3 top-3.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                            </svg>
                        </div>
                        <p class="text-xs text-gray-500">For security reasons, this action requires password confirmation</p>
                    </div>

                    <!-- Security Tips -->
                    <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg">
                        <div class="flex items-start gap-3">
                            <svg class="w-5 h-5 text-blue-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            <div>
                                <p class="text-sm text-blue-800 mb-1">Security Tips:</p>
                                <ul class="text-xs text-blue-700 list-disc pl-4 space-y-1">
                                    <li>Ensure you're on a private network</li>
                                    <li>Never share your password with others</li>
                                    <li>Check for the padlock icon in your browser</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Footer -->
            <div class="modal-footer px-6 py-4 border-t border-gray-200 bg-gray-50">
                <div class="flex items-center justify-between w-full">
                    <button type="button" 
                            class="px-5 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
                            data-bs-dismiss="modal">
                        Cancel
                    </button>
                    <button type="button" 
                            class="px-5 py-2.5 text-white bg-gradient-to-r from-red-600 to-orange-500 rounded-lg font-medium hover:from-red-700 hover:to-orange-600 transition-all shadow-sm"
                            id="submitChannelPasswordBtn">
                        Confirm & Proceed
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>





<!-- Bootstrap Modal to display network stats-->
<div class="modal fade" id="networkStatusModal" tabindex="-1" aria-labelledby="networkStatusModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg rounded-lg overflow-hidden">
        <!-- Header with gradient background -->
        <div class="modal-header bg-gradient-to-r from-purple-600 to-indigo-600 border-0">
          <div class="flex items-center">
            <div class="bg-white bg-opacity-20 rounded-md p-2 mr-3">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                <path fill-rule="evenodd" d="M14.707 11.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 13.586V6a1 1 0 112 0v7.586l2.293-2.293a1 1 0 011.414 0z" clip-rule="evenodd" />
              </svg>
            </div>
            <h5 class="modal-title text-lg font-bold text-white" id="networkStatusModalLabel">Network Dashboard</h5>
          </div>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        
        <div class="modal-body bg-gray-50 p-0">
          <div id="networkStatus" class="p-4">
            <!-- Status Overview Cards Row -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
              <!-- Connection Status Card -->
              <div class="bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500">
                <div class="flex justify-between items-start">
                  <div>
                    <h6 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1">Connection</h6>
                    <p id="connectionType" class="text-lg font-bold text-gray-800 mb-0">WiFi</p>
                    <p id="networkProvider" class="text-sm text-gray-600 mb-0">Provider: Comcast</p>
                  </div>
                  <div class="bg-green-100 rounded-full p-2">
                    <div class="text-green-500">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M17.778 8.222c-4.296-4.296-11.26-4.296-15.556 0A1 1 0 01.808 6.808c5.076-5.077 13.308-5.077 18.384 0a1 1 0 01-1.414 1.414zM14.95 11.05a7 7 0 00-9.9 0 1 1 0 01-1.414-1.414 9 9 0 0112.728 0 1 1 0 01-1.414 1.414zM12.12 13.88a3 3 0 00-4.242 0 1 1 0 01-1.415-1.415 5 5 0 017.072 0 1 1 0 01-1.415 1.415zM9 16a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" />
                      </svg>
                    </div>
                  </div>
                </div>
                <p id="connectionStatus" class="text-sm font-medium text-green-500 mt-2 mb-0">Connected</p>
              </div>
              
              <!-- Signal Strength Card -->
              <div class="bg-white rounded-lg shadow-sm p-4">
                <h6 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Signal Strength</h6>
                <div class="flex items-center mb-2">
                  <div class="w-full bg-gray-200 rounded-full h-2 mr-2">
                    <div id="signalStrengthBar" class="bg-blue-600 h-2 rounded-full" style="width: 75%"></div>
                  </div>
                  <span id="signalStrengthText" class="text-sm font-medium text-gray-700">75%</span>
                </div>
                <div class="flex justify-between text-xs text-gray-500">
                  <span>Poor</span>
                  <span>Excellent</span>
                </div>
              </div>
              
              <!-- Ping, Jitter, Packet Loss Card -->
              <div class="bg-white rounded-lg shadow-sm p-4">
                <h6 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Connection Quality</h6>
                <div class="space-y-3">
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600">Ping:</span>
                    <span id="pingValue" class="text-sm font-medium text-gray-800">24 ms</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600">Jitter:</span>
                    <span id="jitterValue" class="text-sm font-medium text-gray-800">5 ms</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600">Packet Loss:</span>
                    <span id="packetLoss" class="text-sm font-medium text-gray-800">0.2%</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Charts Row -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
              <!-- Speed Chart Card -->
              <div class="bg-white rounded-lg shadow-sm p-4">
                <h6 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Network Speed</h6>
                <canvas id="networkSpeedChart" height="200"></canvas>
              </div>
              
              <!-- Server Response Time Chart Card -->
              <div class="bg-white rounded-lg shadow-sm p-4">
                <h6 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Server Response Time</h6>
                <canvas id="serverResponseChart" height="200"></canvas>
              </div>
            </div>
            
            <!-- Bottom Row -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <!-- Network Load Chart Card -->
              <div class="bg-white rounded-lg shadow-sm p-4">
                <h6 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Network Load</h6>
                <canvas id="networkLoadChart" height="150"></canvas>
              </div>
              
              <!-- Bandwidth Usage Pie Chart Card -->
              <div class="bg-white rounded-lg shadow-sm p-4">
                <h6 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Bandwidth Usage</h6>
                <canvas id="bandwidthUsageChart" height="150"></canvas>
              </div>
              
              <!-- Activity Log Card -->
              <div class="bg-white rounded-lg shadow-sm p-4">
                <div class="flex justify-between items-center mb-3">
                  <h6 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-0">Activity Log</h6>
                  <span class="bg-gray-100 text-gray-600 text-xs font-semibold px-2 py-1 rounded-full">Last 24h</span>
                </div>
                <div class="overflow-y-auto max-h-36">
                  <ul id="activityLog" class="list-group list-group-flush">
                    <li class="list-group-item border-0 py-2 px-0 text-sm">
                      <div class="flex items-start">
                        <div class="w-2 h-2 rounded-full bg-green-500 mt-1.5 mr-2"></div>
                        <div>
                          <p class="mb-0 font-medium text-gray-800">Connection established</p>
                          <p class="mb-0 text-xs text-gray-500">Today, 10:30 AM</p>
                        </div>
                      </div>
                    </li>
                    <li class="list-group-item border-0 py-2 px-0 text-sm">
                      <div class="flex items-start">
                        <div class="w-2 h-2 rounded-full bg-yellow-500 mt-1.5 mr-2"></div>
                        <div>
                          <p class="mb-0 font-medium text-gray-800">Speed fluctuation detected</p>
                          <p class="mb-0 text-xs text-gray-500">Today, 09:45 AM</p>
                        </div>
                      </div>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
            
            <!-- Diagnostic Suggestions -->
            <div class="bg-blue-50 border border-blue-100 rounded-lg p-4 mt-4">
              <div class="flex items-start">
                <div class="bg-blue-100 rounded-full p-1 mr-3">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-600" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2h-1V9a1 1 0 00-1-1z" clip-rule="evenodd" />
                  </svg>
                </div>
                <div id="diagnosticSuggestions" class="text-sm text-blue-800">
                  Your connection is stable. For optimal performance, consider moving your device closer to the router.
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Footer -->
        <div class="modal-footer bg-white border-0 py-3">
          <button type="button" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-300" data-bs-dismiss="modal">Close</button>
          <button type="button" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500">
            Run Diagnostics
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block ml-1" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 3a1 1 0 00-1 1v5H4a1 1 0 100 2h5v5a1 1 0 102 0v-5h5a1 1 0 100-2h-5V4a1 1 0 00-1-1z" clip-rule="evenodd" />
            </svg>
          </button>
        </div>
      </div>
    </div>
</div>


<!-- User Selection Modal to ban the user from channel-->

<div class="modal fade" id="userSelectionModal" tabindex="-1" aria-labelledby="userSelectionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg rounded-lg overflow-hidden">
        <!-- Header -->
        <div class="modal-header bg-gradient-to-r from-red-500 to-red-600 border-0 px-4 py-3">
          <div class="flex items-center">
            <div class="bg-white bg-opacity-20 rounded-md p-2 mr-3">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M13.477 14.89A6 6 0 015.11 6.524l8.367 8.368zm1.414-1.414L6.524 5.11a6 6 0 018.367 8.367zM18 10a8 8 0 11-16 0 8 8 0 0116 0z" clip-rule="evenodd" />
              </svg>
            </div>
            <h5 class="modal-title text-lg font-bold text-white" id="userSelectionModalLabel">Select a User to Ban</h5>
          </div>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        
        <!-- Warning Banner -->
        <div class="bg-orange-50 border-y border-orange-100 px-4 py-3">
          <div class="flex items-start">
            <div class="text-orange-500 mr-3">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
              </svg>
            </div>
            <p class="text-sm text-orange-800 font-medium mb-0">
              Banned users will not be able to access this channel until you unban them from channel settings.
            </p>
          </div>
        </div>
        
        <!-- User List -->
        <div class="modal-body p-4 max-h-80 overflow-y-auto">
          <div class="mb-3">
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                </svg>
              </div>
              <input type="text" class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 sm:text-sm" placeholder="Search users...">
            </div>
          </div>
          
          <ul id="userListtt" class="list-group space-y-2">
            <!-- Sample user items - will be replaced by dynamic content -->
            <li class="list-group-item border border-gray-200 rounded-md p-0 overflow-hidden hover:bg-gray-50 transition-colors">
              <div class="flex items-center p-3">
                <div class="flex-shrink-0 mr-3">
                  <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 font-medium">JD</div>
                </div>
                <div class="flex-1 min-w-0">
                  <p class="text-sm font-medium text-gray-900 truncate">John Doe</p>
                  <p class="text-xs text-gray-500 truncate">@johndoe</p>
                </div>
                <div>
                  <button class="text-sm font-medium text-red-600 hover:text-red-800 focus:outline-none">
                    Ban User
                  </button>
                </div>
              </div>
            </li>
            
            <li class="list-group-item border border-gray-200 rounded-md p-0 overflow-hidden hover:bg-gray-50 transition-colors">
              <div class="flex items-center p-3">
                <div class="flex-shrink-0 mr-3">
                  <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 font-medium">AS</div>
                </div>
                <div class="flex-1 min-w-0">
                  <p class="text-sm font-medium text-gray-900 truncate">Alice Smith</p>
                  <p class="text-xs text-gray-500 truncate">@alicesmith</p>
                </div>
                <div>
                  <button class="text-sm font-medium text-red-600 hover:text-red-800 focus:outline-none">
                    Ban User
                  </button>
                </div>
              </div>
            </li>
          </ul>
        </div>
        
        <!-- Footer -->
        <div class="modal-footer bg-gray-50 border-0 px-4 py-3">
          <button type="button" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-300" data-bs-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
</div>

<!-- Custom Ban Details Modal -->
<div id="customBanModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 hidden">
    <!-- Modal Backdrop -->
    <div class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm"></div>
    
    <!-- Modal Content -->
    <div class="custom-modal-content bg-white rounded-lg shadow-xl w-full max-w-md relative z-10 overflow-hidden">
      <!-- Modal Header -->
      <div class="bg-gradient-to-r from-red-500 to-red-600 px-6 py-4 flex justify-between items-center">
        <div class="flex items-center">
          <div class="bg-white bg-opacity-20 rounded-md p-2 mr-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 1.944A11.954 11.954 0 012.166 5C2.056 5.649 2 6.319 2 7c0 5.225 3.34 9.67 8 11.317C14.66 16.67 18 12.225 18 7c0-.682-.057-1.35-.166-2.001A11.954 11.954 0 0110 1.944zM11 14a1 1 0 11-2 0 1 1 0 012 0zm0-7a1 1 0 10-2 0v3a1 1 0 102 0V7z" clip-rule="evenodd" />
            </svg>
          </div>
          <h5 id="customBanModalLabel" class="text-lg font-bold text-white">Set Ban Duration and Reason</h5>
        </div>
        <button id="closeCustomBanModal" class="text-white hover:text-red-100 focus:outline-none">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      
      <!-- User Info Banner -->
      <div class="bg-gray-50 border-b border-gray-200 px-6 py-3 flex items-center">
        <div class="w-8 h-8 rounded-full bg-red-100 flex items-center justify-center mr-3">
          <span class="text-sm font-medium text-red-600">JS</span>
        </div>
        <div>
          <p class="text-sm font-medium text-gray-900 mb-0">Banning: <span id="targetUserName">Workspace Member</span></p>
          
        </div>
      </div>
      
      <!-- Modal Body -->
      <div class="px-6 py-4">
        <!-- Ban Duration Choices -->
        <div class="mb-4">
          <label for="customBanDuration" class="block text-sm font-medium text-gray-700 mb-2">Ban Duration</label>
          <div class="relative">
            <select class="block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 rounded-md appearance-none bg-white" id="customBanDuration">
              <option value="1 day">1 Day</option>
              <option value="1 week">1 Week</option>
              <option value="1 month">1 Month</option>
              <option value="permanent">Permanent</option>
            </select>
            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
              <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
              </svg>
            </div>
          </div>
        </div>
        
        <!-- Reason Input -->
        <div class="mb-4">
          <label for="customBanReason" class="block text-sm font-medium text-gray-700 mb-2">Reason for Ban</label>
          <textarea class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 sm:text-sm" id="customBanReason" rows="3" placeholder="Explain why this user is being banned..."></textarea>
          <p class="mt-1 text-xs text-gray-500">This reason will be visible to the banned user and channel moderators</p>
        </div>
        
        <!-- Notify User Checkbox -->
        <div class="flex items-center mb-2">
          <input id="notifyUser" type="checkbox" class="h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded">
          <label for="notifyUser" class="ml-2 block text-sm text-gray-700">
            Notify user about this ban
          </label>
        </div>
        
        <!-- Delete Messages Checkbox -->
        <div class="flex items-center">
          <input id="deleteMessages" type="checkbox" class="h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded">
          <label for="deleteMessages" class="ml-2 block text-sm text-gray-700">
            Delete all messages from this user
          </label>
        </div>
      </div>
      
      <!-- Modal Footer -->
      <div class="bg-gray-50 px-6 py-3 flex justify-end space-x-3 border-t border-gray-200">
        <button type="button" id="cancelBan" class="inline-flex justify-center py-2 px-4 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
          Cancel
        </button>
        <button type="button" id="customSubmitBan" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
          Ban User
        </button>
      </div>
    </div>
</div>

<!-- Modal to share access of this channel -->
<div class="modal fade" id="shareModal" tabindex="-1" aria-labelledby="shareModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content rounded-xl border-0 shadow-[0_12px_28px_0_rgba(0,0,0,0.2)]">
            <div class="modal-header p-5 border-b border-gray-200">
                <div class="flex items-center justify-between w-full">
                    <h5 class="modal-title text-[17px] font-semibold text-gray-900 flex items-center gap-2">
                        <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                        </svg>
                        Share Channel Access
                    </h5>
                    <button type="button" class="p-1.5 hover:bg-gray-100 rounded-lg" data-bs-dismiss="modal">
                        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="modal-body p-5">
                <!-- Loading Spinner -->
                <div id="loadingSpinner" class="hidden flex items-center justify-center py-8">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"></div>
                </div>

                <!-- Guide Section -->
                <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded-md mb-5">
                    <div class="flex items-start gap-2">
                        <svg class="w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <div class="space-y-2">
                            <p class="text-sm text-blue-800 font-medium">Sharing Guidelines:</p>
                            <ul class="text-xs text-blue-700 list-disc pl-4 space-y-1">
                                <li>You must be organization owner to share access</li>
                                <li>Shared organizations get read-only access by default</li>
                                <li>Permissions can be modified later in settings</li>
                                <li>Maximum 5 organizations can be granted access</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Organizations List -->
                <ul id="organizationList" class="space-y-2">
                    <!-- Organization Item Template -->
                    <li class="group flex items-center justify-between p-3 rounded-lg border border-gray-200 hover:border-purple-200 cursor-pointer transition-all">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 bg-purple-100 rounded-md flex items-center justify-center">
                                <span class="text-purple-600 font-medium text-sm">OG</span>
                            </div>
                            <div>
                                <h6 class="text-sm font-medium text-gray-900">Organization Name</h6>
                                <p class="text-xs text-gray-500">2 members • owner@company.com</p>
                            </div>
                        </div>
                        <svg class="w-5 h-5 text-purple-600 opacity-0 group-hover:opacity-100 transition-opacity" 
                             fill="none" 
                             stroke="currentColor" 
                             viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                    </li>
                </ul>
            </div>

            <div class="modal-footer p-5 border-t border-gray-200">
                <div class="flex items-center justify-between w-full">
                    <div class="text-sm text-gray-600">
                        Selected: <span id="selectedOrgCount">0</span>/5 organizations
                    </div>
                    <div class="flex items-center gap-2">
                        <button type="button" 
                                class="px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md transition-colors"
                                data-bs-dismiss="modal">
                            Close
                        </button>
                        <button type="button" 
                                id="grantAccessBtn"
                                class="px-4 py-2 text-sm font-medium text-white bg-gradient-to-r from-purple-600 to-purple-500 hover:from-purple-700 hover:to-purple-600 rounded-md transition-all shadow-sm disabled:opacity-50"
                                disabled>
                            Grant Access
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<!-- Set retention policy -->
<div class="modal fade" id="retentionPolicyModal" tabindex="-1" aria-labelledby="retentionPolicyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content rounded-lg border-0 shadow-[0_12px_28px_0_rgba(0,0,0,0.2)]">
            <div class="modal-header p-5 border-b border-gray-200">
                <div class="flex items-start justify-between w-full gap-4">
                    <div>
                        <h5 class="modal-title text-[17px] font-semibold text-gray-900 mb-1">
                            Configure Retention Policy
                        </h5>
                        <p class="text-sm text-gray-600">
                            Automatically clean up old messages to keep your channel organized
                        </p>
                    </div>
                    <button type="button" class="p-1.5 hover:bg-gray-100 rounded-lg" data-bs-dismiss="modal">
                        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="modal-body p-5">
                <form id="retentionForm" class="space-y-4">
                    <!-- Policy Options -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <!-- 30 Days -->
                        <label class="policy-option">
                            <input type="radio" name="retentionPeriod" id="retention30" value="30" class="peer hidden">
                            <div class="policy-card peer-checked:border-purple-500 peer-checked:bg-purple-50">
                                <div class="text-lg font-semibold text-gray-900">30 Days</div>
                                <div class="text-sm text-gray-600">Quick cleanup for active channels</div>
                            </div>
                        </label>

                        <!-- 45 Days -->
                        <label class="policy-option">
                            <input type="radio" name="retentionPeriod" id="retention45" value="45" class="peer hidden">
                            <div class="policy-card peer-checked:border-purple-500 peer-checked:bg-purple-50">
                                <div class="text-lg font-semibold text-gray-900">45 Days</div>
                                <div class="text-sm text-gray-600">Balance between cleanup and history</div>
                            </div>
                        </label>

                        <!-- 90 Days -->
                        <label class="policy-option">
                            <input type="radio" name="retentionPeriod" id="retention90" value="90" class="peer hidden">
                            <div class="policy-card peer-checked:border-purple-500 peer-checked:bg-purple-50">
                                <div class="text-lg font-semibold text-gray-900">90 Days</div>
                                <div class="text-sm text-gray-600">Quarterly cleanup cycle</div>
                            </div>
                        </label>

                        <!-- 180 Days -->
                        <label class="policy-option">
                            <input type="radio" name="retentionPeriod" id="retention180" value="180" class="peer hidden">
                            <div class="policy-card peer-checked:border-purple-500 peer-checked:bg-purple-50">
                                <div class="text-lg font-semibold text-gray-900">180 Days</div>
                                <div class="text-sm text-gray-600">Bi-annual archive strategy</div>
                            </div>
                        </label>

                        <!-- 365 Days -->
                        <label class="policy-option">
                            <input type="radio" name="retentionPeriod" id="retention365" value="365" class="peer hidden">
                            <div class="policy-card peer-checked:border-purple-500 peer-checked:bg-purple-50">
                                <div class="text-lg font-semibold text-gray-900">1 Year</div>
                                <div class="text-sm text-gray-600">Annual message rotation</div>
                            </div>
                        </label>

                        <!-- Custom -->
                        <label class="policy-option">
                            <input type="radio" name="retentionPeriod" id="customRetention" value="0" class="peer hidden">
                            <div class="policy-card peer-checked:border-purple-500 peer-checked:bg-purple-50">
                                <div class="text-lg font-semibold text-gray-900">Custom Period</div>
                                <input type="number" id="customDays" 
                                       class="w-full mt-2 px-3 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500"
                                       placeholder="Enter days"
                                       style="display: none;">
                                <div class="text-sm text-gray-600 mt-1">Specify exact days</div>
                            </div>
                        </label>
                    </div>

                    <!-- Help Text -->
                    <div class="bg-blue-50 border-l-4 border-blue-400 p-3 rounded-md">
                        <div class="flex items-start gap-2">
                            <svg class="w-4 h-4 text-blue-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            <p class="text-sm text-blue-800">
                                Retention policies automatically delete messages older than specified days.
                                Archived messages can be restored within 30 days of deletion.
                            </p>
                        </div>
                    </div>
                </form>
            </div>

            <div class="modal-footer p-5 border-t border-gray-200">
                <div class="flex items-center justify-end gap-2">
                    <button type="button" 
                            class="px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md"
                            data-bs-dismiss="modal">
                        Close
                    </button>
                    <button type="button" 
                            id="saveRetentionPolicy"
                            class="px-4 py-2 text-sm font-medium text-white bg-gradient-to-r from-purple-600 to-purple-500 hover:from-purple-700 rounded-md shadow-sm">
                        Save Policy
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>


  
<!-- Set message as recurring -->


<!-- Recurrence Modal -->
<div id="recurrenceModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center">
    <div class="bg-white rounded-lg shadow-lg w-1/3 p-6">
        <h2 class="text-xl font-semibold mb-4">Set Recurrence Details</h2>
        
        <!-- Recurrence Form -->
        <form id="recurrenceForm">
            <div class="mb-4">
                <label class="block font-medium mb-2">Recurrence Type</label>
                <select id="recurrenceType" name="recurrence_type" class="border border-gray-300 rounded w-full p-2">
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                    <option value="yearly">Yearly</option>
                    <option value="custom">Custom</option>
                </select>
            </div>
            <div class="mb-4" id="recurrenceDaysContainer" style="display: none;">
                <label class="block font-medium mb-2">Select Days (For Weekly/Custom)</label>
                <div class="flex flex-wrap gap-2">
                    <label><input type="checkbox" name="recurrence_days" value="Monday"> Monday</label>
                    <label><input type="checkbox" name="recurrence_days" value="Tuesday"> Tuesday</label>
                    <label><input type="checkbox" name="recurrence_days" value="Wednesday"> Wednesday</label>
                    <label><input type="checkbox" name="recurrence_days" value="Thursday"> Thursday</label>
                    <label><input type="checkbox" name="recurrence_days" value="Friday"> Friday</label>
                    <label><input type="checkbox" name="recurrence_days" value="Saturday"> Saturday</label>
                    <label><input type="checkbox" name="recurrence_days" value="Sunday"> Sunday</label>
                </div>
            </div>
            <div class="mb-4">
                <label class="block font-medium mb-2">End Date (Optional)</label>
                <input type="date" id="endDate" name="end_date" class="border border-gray-300 rounded w-full p-2">
            </div>
            <div class="flex justify-end gap-2">
                <button type="button" id="closeModalButton" class="bg-gray-500 text-white px-4 py-2 rounded">Cancel</button>
                <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded">Save</button>
            </div>
        </form>
    </div>
</div>


<!-- Monitor recurrence messages  -->
<div class="modal fade" id="recurrenceMonitorModal" tabindex="-1" aria-labelledby="recurrenceMonitorModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content rounded-xl border-0 shadow-[0_12px_28px_0_rgba(0,0,0,0.2)]">
            <div class="modal-header p-5 border-b border-gray-200">
                <div class="flex items-center justify-between w-full">
                    <h5 class="modal-title text-[17px] font-semibold text-gray-900 flex items-center gap-2">
                        <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Recurring Messages Monitor
                    </h5>
                    <button type="button" class="p-1.5 hover:bg-gray-100 rounded-lg" data-bs-dismiss="modal">
                        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="modal-body p-5">
                <!-- Summary Cards -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                        <div class="text-sm text-purple-800 font-medium">Active Recurrences</div>
                        <div class="text-2xl font-semibold text-purple-600 mt-1">12</div>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                        <div class="text-sm text-green-800 font-medium">Completed This Month</div>
                        <div class="text-2xl font-semibold text-green-600 mt-1">24</div>
                    </div>
                </div>

                <!-- Pending Messages -->
                <div class="mb-8">
                    <h5 class="text-sm font-semibold text-gray-900 mb-4 flex items-center gap-2">
                        <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
                        Scheduled Messages
                    </h5>
                    <div class="border rounded-lg overflow-hidden">
                        <table class="w-full" id="pendingMessagesTable">
                            <thead class="bg-gray-50 border-b">
                                <tr>
                                    <th class="text-left text-sm font-medium text-gray-700 p-3">Message Content</th>
                                    <th class="text-left text-sm font-medium text-gray-700 p-3">Start Date</th>
                                    <th class="text-left text-sm font-medium text-gray-700 p-3">End Date</th>
                                    <th class="text-left text-sm font-medium text-gray-700 p-3">Actions</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <!-- Rows will be dynamically populated -->
                                <tr class="hover:bg-gray-50 transition-colors">
                                    <td class="p-3 text-sm text-gray-900">Team meeting reminder</td>
                                    <td class="p-3 text-sm text-gray-600">2024-03-15</td>
                                    <td class="p-3 text-sm text-gray-600">2024-06-15</td>
                                    <td class="p-3">
                                        <button class="text-purple-600 hover:text-purple-700 text-sm font-medium">
                                            Edit
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Sent Messages -->
                <div>
                    <h5 class="text-sm font-semibold text-gray-900 mb-4 flex items-center gap-2">
                        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                        Message History
                    </h5>
                    <div class="border rounded-lg overflow-hidden">
                        <table class="w-full" id="sentMessagesTable">
                            <thead class="bg-gray-50 border-b">
                                <tr>
                                    <th class="text-left text-sm font-medium text-gray-700 p-3">Message Content</th>
                                    <th class="text-left text-sm font-medium text-gray-700 p-3">Sent At</th>
                                    <th class="text-left text-sm font-medium text-gray-700 p-3">Status</th>
                                    <th class="text-left text-sm font-medium text-gray-700 p-3">Actions</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <!-- Rows will be dynamically populated -->
                                <tr class="hover:bg-gray-50 transition-colors">
                                    <td class="p-3 text-sm text-gray-900">Project update reminder</td>
                                    <td class="p-3 text-sm text-gray-600">2024-03-01 09:00</td>
                                    <td class="p-3">
                                        <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                            Delivered
                                        </span>
                                    </td>
                                    <td class="p-3">
                                        <button class="text-purple-600 hover:text-purple-700 text-sm font-medium">
                                            Resend
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Pagination -->
                <div class="mt-6 flex items-center justify-between">
                    <div class="text-sm text-gray-600">Showing 1-10 of 24 results</div>
                    <div class="flex gap-1">
                        <button class="px-3 py-1.5 rounded-md text-gray-700 hover:bg-gray-100">Previous</button>
                        <button class="px-3 py-1.5 rounded-md bg-gray-100 text-gray-900">1</button>
                        <button class="px-3 py-1.5 rounded-md text-gray-700 hover:bg-gray-100">Next</button>
                    </div>
                </div>
            </div>

            <div class="modal-footer p-5 border-t border-gray-200">
                <button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md" data-bs-dismiss="modal">
                    Close Monitor
                </button>
            </div>
        </div>
    </div>
</div>



<!-- Warn Modal -->
<div class="modal fade" id="warnModal" tabindex="-1" aria-labelledby="warnModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content rounded-xl border-0 shadow-[0_12px_28px_0_rgba(0,0,0,0.2)]">
            <div class="modal-header p-5 border-b border-gray-200">
                <div class="flex items-center justify-between w-full">
                    <h5 class="modal-title text-[17px] font-semibold text-gray-900 flex items-center gap-2">
                        <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                        </svg>
                        Content Moderation Center
                    </h5>
                    <button type="button" class="p-1.5 hover:bg-gray-100 rounded-lg" data-bs-dismiss="modal">
                        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="modal-body p-5">
                <!-- Moderation Guidelines -->
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-md mb-5">
                    <div class="flex items-start gap-3">
                        <svg class="w-5 h-5 text-yellow-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                        </svg>
                        <div class="space-y-2">
                            <p class="text-sm font-medium text-yellow-800">Automated Moderation Guidelines:</p>
                            <ul class="text-xs text-yellow-700 list-disc pl-4 space-y-1">
                                <li>CalAI continuously monitors for inappropriate language/content</li>
                                <li>First offense: Automatic warning with violation details</li>
                                <li>Repeated violations (5+ warnings): Automatic 7-day ban</li>
                                <li>Extreme cases: Immediate permanent ban with admin review</li>
                                <li>Users can appeal bans through support portal</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Flagged Content Section -->
                <div class="border rounded-lg overflow-hidden">
                    <table class="w-full" id="flaggedMessagesTable">
                        <thead class="bg-gray-50 border-b">
                            <tr>
                                <th class="text-left text-sm font-medium text-gray-700 p-3">Content</th>
                                <th class="text-left text-sm font-medium text-gray-700 p-3">User</th>
                                <th class="text-left text-sm font-medium text-gray-700 p-3">Warnings</th>
                                <th class="text-left text-sm font-medium text-gray-700 p-3">Last Flagged</th>
                                <th class="text-left text-sm font-medium text-gray-700 p-3">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <!-- Example Row -->
                            <tr class="hover:bg-gray-50 transition-colors">
                                <td class="p-3 text-sm text-gray-900 max-w-[300px] truncate">[Inappropriate content detected]</td>
                                <td class="p-3 text-sm text-gray-600">
                                    <div class="flex items-center gap-2">
                                        <div class="w-6 h-6 bg-red-600 text-white rounded-full flex items-center justify-center text-xs">JD</div>
                                        <span>John Doe</span>
                                        <span class="text-xs text-red-600">(4 warnings)</span>
                                    </div>
                                </td>
                                <td class="p-3 text-sm text-gray-600">
                                    <div class="flex gap-1">
                                        <span class="w-2 h-2 bg-yellow-400 rounded-full"></span>
                                        <span class="w-2 h-2 bg-yellow-400 rounded-full"></span>
                                        <span class="w-2 h-2 bg-yellow-400 rounded-full"></span>
                                        <span class="w-2 h-2 bg-yellow-400 rounded-full"></span>
                                    </div>
                                </td>
                                <td class="p-3 text-sm text-gray-600">15m ago</td>
                                <td class="p-3">
                                    <div class="flex items-center gap-2">
                                        <button class="text-sm px-3 py-1 rounded-md bg-red-100 text-red-700 hover:bg-red-200 transition-colors">
                                            Ban User
                                        </button>
                                        <button class="text-sm px-3 py-1 rounded-md bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors">
                                            Dismiss
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Loading State -->
                <div id="loadingSpinner" class="hidden flex flex-col items-center justify-center py-8 space-y-2">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"></div>
                    <p class="text-sm text-gray-600">Processing moderation action...</p>
                </div>
            </div>

            <div class="modal-footer p-5 border-t border-gray-200">
                <button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md" data-bs-dismiss="modal">
                    Close Moderation Center
                </button>
            </div>
        </div>
    </div>
</div>


<!-- Manage Events Modal (Company Handbook) -->
<!-- Modal Structure -->
<div class="modal fade" id="EventHandleModal" tabindex="-1" aria-labelledby="EventHandleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content bg-white rounded-lg shadow-xl border-0">
        <!-- Modal Header -->
        <div class="modal-header bg-gray-50 border-b border-gray-200 rounded-t-lg p-4">
          <div class="flex items-center justify-between w-full">
            <h5 class="modal-title text-xl font-bold text-gray-800" id="EventHandleModalLabel">
              <i class="fas fa-calendar-alt mr-2 text-purple-600"></i>Manage Events
            </h5>
            <button type="button" class="btn-close text-gray-500 hover:text-gray-700 focus:outline-none" data-bs-dismiss="modal" aria-label="Close">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
        </div>
        
        <!-- Info Card -->
        <div class="px-4 py-3 bg-purple-50 border-b border-gray-200">
          <div class="flex items-start space-x-3">
            <div class="flex-shrink-0 pt-1">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <div>
              <h5 class="font-medium text-gray-800">Company Handbook</h5>
              <p class="text-sm text-gray-600">
                A place to reference company-wide announcements, upcoming events, and helpful resources. Use <span class="bg-gray-100 text-purple-600 px-1 rounded">@</span> to mention your team-mates.
              </p>
            </div>
          </div>
        </div>
        
        <!-- Modal Body -->
        <div class="modal-body p-0">
          <!-- Toolbar -->
          <div class="bg-white p-3 border-b border-gray-200 flex items-center justify-between">
            <div class="flex items-center space-x-2">
              <button class="inline-flex items-center px-3 py-1.5 bg-purple-600 text-white rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 text-sm font-medium">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                </svg>
                New Event
              </button>
              <div class="relative">
                <input type="text" placeholder="Search events..." class="pl-8 pr-4 py-1.5 border border-gray-300 rounded-md text-sm focus:ring-purple-500 focus:border-purple-500 w-48">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400 absolute left-2.5 top-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
              </div>
            </div>
            
            <div class="flex items-center space-x-2">
              <button class="inline-flex items-center px-2 py-1 border border-gray-300 rounded text-sm text-gray-700 bg-white hover:bg-gray-50">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4" />
                </svg>
                Sort
              </button>
              <button class="inline-flex items-center px-2 py-1 border border-gray-300 rounded text-sm text-gray-700 bg-white hover:bg-gray-50">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
                </svg>
                Filter
              </button>
            </div>
          </div>
          
          <!-- Table -->
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200" id="eventsTable">
              <thead class="bg-gray-50">
                <tr>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Event Name
                  </th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Date/Time
                  </th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Event Details
                  </th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Event Link
                  </th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Attachment
                  </th>
                </tr>
              </thead>
              <tbody id="eventsTableBody" class="bg-white divide-y divide-gray-200">
                <!-- Initial rows that can be filled by the admin -->
                <tr class="hover:bg-gray-50">
                  <td class="px-6 py-4 whitespace-nowrap event-name border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap event-date border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 event-details border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap event-link border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap attachment-column cursor-pointer" data-bs-toggle="modal" data-bs-target="#attachmentModal">
                    <div class="text-sm text-purple-600 hover:text-purple-800 font-medium flex items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" />
                      </svg>
                      Add Attachment
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-gray-50">
                  <td class="px-6 py-4 whitespace-nowrap event-name border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap event-date border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 event-details border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap event-link border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap attachment-column cursor-pointer" data-bs-toggle="modal" data-bs-target="#attachmentModal">
                    <div class="text-sm text-purple-600 hover:text-purple-800 font-medium flex items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" />
                      </svg>
                      Add Attachment
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-gray-50">
                  <td class="px-6 py-4 whitespace-nowrap event-name border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap event-date border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 event-details border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap event-link border-r border-gray-100" contenteditable="true">
                    <div class="text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded px-2 py-1 -mx-2 -my-1"></div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap attachment-column cursor-pointer" data-bs-toggle="modal" data-bs-target="#attachmentModal">
                    <div class="text-sm text-purple-600 hover:text-purple-800 font-medium flex items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" />
                      </svg>
                      Add Attachment
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Modal Footer -->
        <div class="modal-footer bg-gray-50 border-t border-gray-200 rounded-b-lg p-4 flex items-center justify-between">
          <div>
            <button type="button" class="inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 text-sm font-medium" id="addRow">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
              </svg>
              Add Row
            </button>
          </div>
          <div class="flex items-center space-x-2">
            <div class="text-sm text-gray-500">
              <span class="font-medium">Pro tip:</span> Double-click any cell to edit
            </div>
            <button type="button" class="inline-flex items-center px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 text-sm font-medium" data-bs-dismiss="modal">
              Close
            </button>
            <button type="button" class="inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 text-sm font-medium">
              Save Changes
            </button>
          </div>
        </div>
      </div>
    </div>
</div>
  
<!-- Help Tooltip that appears on hover (optional) -->
<div class="fixed bottom-4 right-4 z-50">
    <button class="bg-purple-600 text-white rounded-full p-2 shadow-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2" id="helpButton">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
    </button>
</div>

<!-- Attachment Modal -->
<div class="modal fade" id="attachmentModal" tabindex="-1" aria-labelledby="attachmentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content rounded-xl border-0 shadow-[0_12px_28px_0_rgba(0,0,0,0.2)]">
            <div class="modal-header p-5 border-b border-gray-200">
                <div class="flex items-center justify-between w-full">
                    <h5 class="modal-title text-[17px] font-semibold text-gray-900 flex items-center gap-2">
                        <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                        </svg>
                        Upload Files
                    </h5>
                    <button type="button" class="p-1.5 hover:bg-gray-100 rounded-lg" data-bs-dismiss="modal">
                        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="modal-body p-5">
                <form id="attachmentForm" enctype="multipart/form-data" class="space-y-6">
                    <!-- Dropzone -->
                    <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-purple-500 transition-colors cursor-pointer relative"
                         onclick="document.getElementById('fileInput').click()">
                        <input type="file" class="hidden" id="fileInput" name="attachment">
                        <div class="space-y-3">
                            <svg class="w-12 h-12 text-gray-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                            </svg>
                            <div>
                                <p class="text-sm font-medium text-gray-900">
                                    <span class="text-purple-600">Click to upload</span> or drag and drop
                                </p>
                                <p class="text-xs text-gray-500 mt-1">
                                    Maximum file size: 100MB • Supported formats: PDF, DOCX, XLSX, JPG, PNG
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Selected Files Preview -->
                    <div class="hidden" id="filePreview">
                        <div class="flex items-center justify-between bg-gray-50 p-3 rounded-lg">
                            <div class="flex items-center gap-3">
                                <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                <div>
                                    <p class="text-sm font-medium text-gray-900" id="fileName">document.pdf</p>
                                    <p class="text-xs text-gray-500" id="fileSize">45.2 KB</p>
                                </div>
                            </div>
                            <button type="button" class="text-gray-400 hover:text-gray-600">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Upload Button -->
                    <button type="submit" 
                            class="w-full px-6 py-3 bg-gradient-to-r from-purple-600 to-purple-500 hover:from-purple-700 text-white font-medium rounded-lg transition-all shadow-sm">
                        Upload File
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>


<!-- Modal to display events details -->
<!-- Modal -->
<div class="modal fade" id="eventDetailsModalPremium" tabindex="-1" aria-labelledby="eventDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg"> <!-- modal-lg for larger size -->
      <div class="modal-content bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden">
        <div class="modal-header flex items-center justify-between p-4 border-b border-gray-200 bg-gray-50">
          <div class="flex flex-col">
            <h5 class="modal-title text-lg font-semibold text-gray-800 font-inter" id="eventDetailsModalLabel">Event Details</h5>
            <div class="text-sm text-blue-600 font-medium mt-1">
              2025 milestones/Company-wide announcements
            </div>
          </div>
          <button type="button" class="btn-close text-gray-400 hover:text-gray-600 focus:outline-none" data-bs-dismiss="modal" aria-label="Close">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="modal-body p-0">
          <div class="overflow-x-auto">
            <table id="eventDetailsTable" class="w-full">
              <thead>
                <tr class="bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  <th class="px-4 py-3 border-b border-gray-200">Event Name</th>
                  <th class="px-4 py-3 border-b border-gray-200">Event Date/Time</th>
                  <th class="px-4 py-3 border-b border-gray-200">Event Details</th>
                  <th class="px-4 py-3 border-b border-gray-200">Event Attachment</th>
                  <th class="px-4 py-3 border-b border-gray-200">Event Link</th>
                  <th class="px-4 py-3 border-b border-gray-200">Created By</th>
                  <th class="px-4 py-3 border-b border-gray-200">Action</th> <!-- New column for the button -->
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-gray-200">
                <!-- Table rows will be dynamically filled with event data -->
                <!-- Sample row for visual reference (will be replaced by your logic) -->
                <tr class="hover:bg-gray-50 transition-colors">
                  <td class="px-4 py-3 text-sm text-gray-900">Team Meeting</td>
                  <td class="px-4 py-3 text-sm text-gray-500">Apr 10, 2025 • 10:00 AM</td>
                  <td class="px-4 py-3 text-sm text-gray-500">Quarterly planning session</td>
                  <td class="px-4 py-3 text-sm text-blue-600">
                    <div class="flex items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" />
                      </svg>
                      <span>Agenda.pdf</span>
                    </div>
                  </td>
                  <td class="px-4 py-3 text-sm text-blue-600">
                    <a href="#" class="hover:underline flex items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                      </svg>
                      <span>Meeting Link</span>
                    </a>
                  </td>
                  <td class="px-4 py-3 text-sm text-gray-500">
                    <div class="flex items-center">
                      <span class="h-6 w-6 rounded-full bg-indigo-100 text-indigo-800 flex items-center justify-center text-xs font-medium mr-2">JD</span>
                      <span>John Doe</span>
                    </div>
                  </td>
                  <td class="px-4 py-3 text-sm">
                    <button class="inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                      </svg>
                      View
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer flex justify-end p-4 border-t border-gray-200 bg-gray-50">
          <button type="button" class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
</div>
  


<!-- CHANNEL SETTINGS MODAL -->
<!-- Settings Modal -->
<div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content bg-gray-50 shadow-2xl rounded-lg border-0">
        <!-- Header -->
        <div class="modal-header bg-white border-0 px-6 py-4">
          <div class="flex items-center">
            <h5 class="modal-title text-xl font-semibold text-purple-700" id="settingsModalLabel">
              <i class="fas fa-cog mr-2"></i>{{channel.name}} Settings
            </h5>
            <span class="ml-3 px-2 py-1 bg-purple-100 text-purple-700 text-xs font-medium rounded">Channel Settings</span>
          </div>
          <button type="button" class="btn-close text-gray-500 hover:text-gray-700" data-bs-dismiss="modal" aria-label="Close">
            <i class="fas fa-times"></i>
          </button>
        </div>
        
        <!-- Body -->
        <div class="modal-body p-0">
          <div class="flex h-[70vh]">
            <!-- Left Sidebar -->
            <div class="w-64 bg-gray-100 border-r border-gray-200 overflow-y-auto">
              <div class="p-4">
                <div class="relative">
                  <input type="text" class="w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Search settings...">
                  <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                </div>
              </div>
              
              <nav class="mt-2">
                <div class="px-4 py-2 text-xs font-semibold uppercase text-gray-500">General</div>
                <a href="#general" class="flex items-center px-4 py-3 text-sm font-medium text-purple-700 bg-purple-50 border-l-4 border-purple-500">
                  <i class="fas fa-sliders-h w-5 mr-3"></i>
                  General Settings
                </a>
                <a href="#permissions" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200">
                  <i class="fas fa-shield-alt w-5 mr-3"></i>
                  Permissions
                </a>
                <a href="#integrations" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200">
                  <i class="fas fa-plug w-5 mr-3"></i>
                  Integrations
                </a>
                <a href="#notifications" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200">
                  <i class="fas fa-bell w-5 mr-3"></i>
                  Notifications
                </a>
                <a href="#automation" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200">
                  <i class="fas fa-robot w-5 mr-3"></i>
                  Automation
                </a>
                <a href="#advanced" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200">
                  <i class="fas fa-code w-5 mr-3"></i>
                  Advanced
                </a>
                
                <div class="px-4 py-2 mt-2 text-xs font-semibold uppercase text-gray-500">Customization</div>
                <a href="#appearance" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200">
                  <i class="fas fa-paint-brush w-5 mr-3"></i>
                  Appearance
                </a>
                <a href="#templates" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200">
                  <i class="fas fa-clipboard-list w-5 mr-3"></i>
                  Templates
                </a>
                
                <div class="px-4 py-2 mt-2 text-xs font-semibold uppercase text-gray-500">Administration</div>
                <a href="#security" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200">
                  <i class="fas fa-lock w-5 mr-3"></i>
                  Security
                </a>
                <a href="#analytics" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200">
                  <i class="fas fa-chart-line w-5 mr-3"></i>
                  Analytics
                </a>
              </nav>
            </div>
            
            <!-- Right Content Area -->
            <div class="flex-1 overflow-y-auto p-0">
              <!-- General Settings Section -->
              <div id="general" class="p-6 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">General Settings</h3>
                
                <form id="settingsForm">
                  <!-- Media Settings -->
                  <div class="mb-6">
                    <h4 class="text-md font-medium text-gray-700 mb-3">Media Settings</h4>
                    
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Allow Media Uploads</h5>
                          <p class="text-sm text-gray-500 mt-1">Enable users to upload images, videos, and other media files</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="allowMediaUploads">
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Maximum File Size</h5>
                          <p class="text-sm text-gray-500 mt-1">Set the maximum allowed file size for uploads</p>
                        </div>
                        <div class="w-32">
                          <select class="form-select w-full text-sm">
                            <option>5 MB</option>
                            <option>10 MB</option>
                            <option>25 MB</option>
                            <option>50 MB</option>
                          </select>
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Allowed File Types</h5>
                          <p class="text-sm text-gray-500 mt-1">Select which file types can be uploaded</p>
                        </div>
                        <div class="w-32">
                          <button class="btn btn-sm btn-outline-secondary w-full text-sm">Configure</button>
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3">
                        <div>
                          <h5 class="font-medium text-gray-800">Auto-compress Images</h5>
                          <p class="text-sm text-gray-500 mt-1">Automatically compress images to save space</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" checked>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Code Settings -->
                  <div class="mb-6">
                    <h4 class="text-md font-medium text-gray-700 mb-3">Code & Development</h4>
                    
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Allow Code Snippets</h5>
                          <p class="text-sm text-gray-500 mt-1">Enable sharing of code snippets in the channel</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="allowCodes">
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Code Syntax Highlighting</h5>
                          <p class="text-sm text-gray-500 mt-1">Automatically highlight syntax in code blocks</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" checked>
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Default Code Theme</h5>
                          <p class="text-sm text-gray-500 mt-1">Choose a default theme for code blocks</p>
                        </div>
                        <div class="w-32">
                          <select class="form-select w-full text-sm">
                            <option>GitHub</option>
                            <option>Monokai</option>
                            <option>Dracula</option>
                            <option>Nord</option>
                          </select>
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3">
                        <div>
                          <h5 class="font-medium text-gray-800">Enable Markdown</h5>
                          <p class="text-sm text-gray-500 mt-1">Allow Markdown formatting in messages</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" checked>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Security Settings -->
                  <div class="mb-6">
                    <h4 class="text-md font-medium text-gray-700 mb-3">Security Settings</h4>
                    
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Secure From Unwanted Requests</h5>
                          <p class="text-sm text-gray-500 mt-1">Block potentially harmful requests and spam</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="secureFromUnwantedRequests">
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Track Abusive Messages</h5>
                          <p class="text-sm text-gray-500 mt-1">Monitor and report potentially abusive content</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="trackAbusiveMessages">
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Content Filtering Level</h5>
                          <p class="text-sm text-gray-500 mt-1">Set content moderation strictness</p>
                        </div>
                        <div class="w-32">
                          <select class="form-select w-full text-sm">
                            <option>Low</option>
                            <option>Medium</option>
                            <option>High</option>
                            <option>Very High</option>
                          </select>
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3">
                        <div>
                          <h5 class="font-medium text-gray-800">IP Restrictions</h5>
                          <p class="text-sm text-gray-500 mt-1">Limit access to specific IP addresses</p>
                        </div>
                        <div class="w-32">
                          <button class="btn btn-sm btn-outline-secondary w-full text-sm">Configure</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Interactive Features -->
                  <div class="mb-6">
                    <h4 class="text-md font-medium text-gray-700 mb-3">Interactive Features</h4>
                    
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Allow Polls</h5>
                          <p class="text-sm text-gray-500 mt-1">Enable creating and voting on polls</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="allowPolls">
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Poll Duration Limit</h5>
                          <p class="text-sm text-gray-500 mt-1">Maximum time a poll can remain active</p>
                        </div>
                        <div class="w-32">
                          <select class="form-select w-full text-sm">
                            <option>1 Day</option>
                            <option>3 Days</option>
                            <option>1 Week</option>
                            <option>2 Weeks</option>
                          </select>
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Enable Reactions</h5>
                          <p class="text-sm text-gray-500 mt-1">Allow emoji reactions on messages</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" checked>
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3">
                        <div>
                          <h5 class="font-medium text-gray-800">Custom Reactions</h5>
                          <p class="text-sm text-gray-500 mt-1">Allow custom emoji uploads for reactions</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox">
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Sharing & Access -->
                  <div class="mb-6">
                    <h4 class="text-md font-medium text-gray-700 mb-3">Sharing & Access</h4>
                    
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Allow Sharing Access</h5>
                          <p class="text-sm text-gray-500 mt-1">Enable sharing channel content with external users</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="allowSharingAccess">
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Public Link Access</h5>
                          <p class="text-sm text-gray-500 mt-1">Allow access via public links without login</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox">
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Link Expiration</h5>
                          <p class="text-sm text-gray-500 mt-1">Default expiration time for shared links</p>
                        </div>
                        <div class="w-32">
                          <select class="form-select w-full text-sm">
                            <option>Never</option>
                            <option>24 Hours</option>
                            <option>7 Days</option>
                            <option>30 Days</option>
                          </select>
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3">
                        <div>
                          <h5 class="font-medium text-gray-800">Download Restrictions</h5>
                          <p class="text-sm text-gray-500 mt-1">Prevent downloading of shared content</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox">
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Integrations -->
                  <div class="mb-6">
                    <h4 class="text-md font-medium text-gray-700 mb-3">Integrations</h4>
                    
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Allow Integrations</h5>
                          <p class="text-sm text-gray-500 mt-1">Enable third-party service integrations</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="allowIntegrations">
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Integration Choices</h5>
                          <p class="text-sm text-gray-500 mt-1">Select available third-party integrations</p>
                        </div>
                        <div class="w-32">
                          <select class="form-select w-full text-sm" id="integrationChoices">
                            <option value="slack">Slack</option>
                            <option value="trello">Trello</option>
                            <option value="calendly">Calendly</option>
                            <option value="github">GitHub</option>
                            <option value="jira">Jira</option>
                          </select>
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3 border-b border-gray-100">
                        <div>
                          <h5 class="font-medium text-gray-800">Webhook Support</h5>
                          <p class="text-sm text-gray-500 mt-1">Allow custom webhooks for advanced integrations</p>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox">
                        </div>
                      </div>
                      
                      <div class="flex items-center justify-between py-3">
                        <div>
                          <h5 class="font-medium text-gray-800">API Access</h5>
                          <p class="text-sm text-gray-500 mt-1">Control API permissions for this channel</p>
                        </div>
                        <div class="w-32">
                          <button class="btn btn-sm btn-outline-secondary w-full text-sm">Configure</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Footer -->
        <div class="modal-footer bg-white border-0 px-6 py-4">
          <div class="flex justify-between w-full">
            <button type="button" class="btn btn-link text-gray-600 hover:text-gray-800 text-sm">Restore Defaults</button>
            <div>
              <button type="button" class="btn btn-outline-secondary me-2" data-bs-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-purple bg-purple-600 hover:bg-purple-700 text-white">Save Changes</button>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>

<!-- EVENTS CALENDAR -->
<div class="modal fade" id="eventCalendarModal" tabindex="-1" aria-labelledby="eventModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered max-w-lg">
        <div class="modal-content bg-white rounded-lg shadow-xl border-0 overflow-hidden">
            <!-- Header -->
            <div class="modal-header bg-indigo-50 border-b border-indigo-100 px-6 py-4">
                <div class="flex items-center justify-between w-full">
                    <div class="flex items-center space-x-3">
                        <div class="p-2 bg-indigo-100 rounded-lg">
                            <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                        </div>
                        <h5 class="modal-title text-lg font-semibold text-slate-800" id="modal-title"></h5>
                    </div>
                    <button type="button" class="p-2 hover:bg-indigo-100 rounded-lg transition-colors" data-bs-dismiss="modal">
                        <svg class="w-5 h-5 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Body -->
            <div class="modal-body px-6 py-4 text-slate-700" id="modal-body">
                <!-- Original dynamic content works exactly the same -->
                <div class="space-y-4">
                    <!-- Time -->
                    <div class="flex items-start space-x-3">
                        <svg class="w-5 h-5 text-slate-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <div>
                            <p class="text-sm font-medium text-slate-800">Event Time</p>
                            <p class="text-sm text-slate-600">[Dynamic content]</p>
                        </div>
                    </div>

                    <!-- Location -->
                    <div class="flex items-start space-x-3">
                        <svg class="w-5 h-5 text-slate-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        <div>
                            <p class="text-sm font-medium text-slate-800">Location</p>
                            <p class="text-sm text-slate-600">[Dynamic content]</p>
                        </div>
                    </div>

                    <!-- Description -->
                    <div class="flex items-start space-x-3">
                        <svg class="w-5 h-5 text-slate-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <div>
                            <p class="text-sm font-medium text-slate-800">Description</p>
                            <p class="text-sm text-slate-600">[Dynamic content]</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="modal-footer bg-slate-50 border-t border-slate-100 px-6 py-4">
                <button type="button" 
                        class="px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-100 rounded-lg transition-colors" 
                        data-bs-dismiss="modal">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal to mention users -->
<div id="mentionModal" class="hidden fixed inset-0 bg-slate-800 bg-opacity-30 backdrop-blur-sm flex items-center justify-center z-50 transition-opacity">
    <div class="bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 overflow-hidden">
        <div class="border-b border-slate-200 px-6 py-4">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-semibold text-slate-800 flex items-center gap-2">
                    <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                    </svg>
                    Mention Team Members
                </h2>
                <button id="closeMentionModal" class="p-2 hover:bg-slate-100 rounded-lg text-slate-500 hover:text-slate-700 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
        </div>

        <div class="px-6 py-4">
            <!-- Search Input (Add if needed) -->
            <div class="mb-4 relative">
                <input type="text" placeholder="Search members..." class="w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                <svg class="w-4 h-4 absolute left-3 top-3 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                </svg>
            </div>

            <ul id="mentionList" class="space-y-1 max-h-96 overflow-y-auto">
                <!-- User List Items (Sample Structure) -->
                <li class="flex items-center px-4 py-3 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors">
                    <div class="w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 text-sm mr-3">
                        JD
                    </div>
                    <div class="flex-1">
                        <div class="text-sm font-medium text-slate-800">John Doe</div>
                        <div class="text-xs text-slate-500">john@company.com</div>
                    </div>
                    <span class="text-xs text-slate-500 ml-2">@johnd</span>
                </li>
            </ul>
        </div>

        <div class="border-t border-slate-200 px-6 py-4 bg-slate-50">
            <div class="flex justify-end">
                <button id="closeMentionModal" class="px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-200 rounded-lg transition-colors">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal to send link -->
<div id="sendLinkModal" class="hidden fixed inset-0 bg-slate-800 bg-opacity-30 backdrop-blur-sm flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 overflow-hidden">
        <div class="border-b border-slate-200 px-6 py-4">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-semibold text-slate-800 flex items-center gap-2">
                    <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                    </svg>
                    Share Link
                </h2>
                <button id="closeLinkModal" class="p-2 hover:bg-slate-100 rounded-lg text-slate-500 hover:text-slate-700 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
        </div>

        <div class="px-6 py-4 space-y-4">
            <div>
                <label for="linkText" class="block text-sm font-medium text-slate-700 mb-1">Link Text</label>
                <input id="linkText" type="text" 
                       class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm placeholder-slate-400"
                       placeholder="Display text">
            </div>
            
            <div>
                <label for="linkUrl" class="block text-sm font-medium text-slate-700 mb-1">URL</label>
                <input id="linkUrl" type="url" 
                       class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm placeholder-slate-400"
                       placeholder="https://example.com">
            </div>
        </div>

        <div class="border-t border-slate-200 px-6 py-4 bg-slate-50">
            <div class="flex justify-end gap-3">
                <button id="closeLinkModal" 
                        class="px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-200 rounded-lg transition-colors">
                    Cancel
                </button>
                <button id="sendLink" 
                        class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors shadow-sm">
                    Insert Link
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Emoji Picker Modal -->
<div id="emojiPickerModal" class="hidden fixed inset-0 bg-slate-800 bg-opacity-30 backdrop-blur-sm flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-2xl max-w-sm w-full mx-4 overflow-hidden">
        <div class="border-b border-slate-200 px-6 py-4">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-semibold text-slate-800 flex items-center gap-2">
                    <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Select Emoji
                </h2>
                <button id="closeEmojiPickerModal" class="p-2 hover:bg-slate-100 rounded-lg text-slate-500 hover:text-slate-700 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
        </div>

        <div class="px-4 py-3">
            <div id="emojiContainer" class="grid grid-cols-8 gap-1 max-h-[60vh] overflow-y-auto p-2">
                <!-- Sample emoji items (preserve your dynamic content) -->
                <button class="text-xl p-2 hover:bg-slate-100 rounded-lg transition-colors cursor-pointer">😀</button>
                <button class="text-xl p-2 hover:bg-slate-100 rounded-lg transition-colors cursor-pointer">😃</button>
                <button class="text-xl p-2 hover:bg-slate-100 rounded-lg transition-colors cursor-pointer">😄</button>
                <!-- Add more emojis dynamically -->
            </div>
        </div>

        <div class="border-t border-slate-200 px-6 py-4 bg-slate-50">
            <div class="flex justify-end">
                <button id="closeEmojiPickerModal" 
                        class="px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-200 rounded-lg transition-colors">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Audio Upload Modal -->
<div id="audioUploadModal" class="hidden fixed inset-0 bg-slate-800 bg-opacity-30 backdrop-blur-sm flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 overflow-hidden">
        <div class="border-b border-slate-200 px-6 py-4">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-semibold text-slate-800 flex items-center gap-2">
                    <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
                    </svg>
                    Upload Audio File
                </h2>
                <button id="closeAudioModal" class="p-2 hover:bg-slate-100 rounded-lg text-slate-500 hover:text-slate-700 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
        </div>

        <div class="px-6 py-4 space-y-4">
            <div class="border-2 border-dashed border-slate-200 rounded-lg p-6 text-center">
                <input type="file" id="audioFileInput" 
                       class="hidden" 
                       accept="audio/*">
                <label for="audioFileInput" class="cursor-pointer">
                    <div class="mx-auto mb-3 w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center">
                        <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
                        </svg>
                    </div>
                    <p class="text-sm text-slate-700 font-medium">Drop audio file here or click to upload</p>
                    <p class="text-xs text-slate-500 mt-1">Supported formats: MP3, WAV, AAC</p>
                </label>
            </div>
        </div>

        <div class="border-t border-slate-200 px-6 py-4 bg-slate-50">
            <div class="flex justify-end gap-3">
                <button id="closeAudioModal" 
                        class="px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-200 rounded-lg transition-colors">
                    Cancel
                </button>
                <button id="uploadAudio" 
                        class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors shadow-sm">
                    Upload File
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Video Upload Modal -->
<div id="videoUploadModal" class="hidden fixed inset-0 bg-slate-800 bg-opacity-30 backdrop-blur-sm flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 overflow-hidden">
        <div class="border-b border-slate-200 px-6 py-4">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-semibold text-slate-800 flex items-center gap-2">
                    <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                    </svg>
                    Upload Video File
                </h2>
                <button id="closeVideoModal" class="p-2 hover:bg-slate-100 rounded-lg text-slate-500 hover:text-slate-700 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
        </div>

        <div class="px-6 py-4 space-y-4">
            <div class="border-2 border-dashed border-slate-200 rounded-lg p-6 text-center">
                <input type="file" id="videoFileInput" 
                       class="hidden" 
                       accept="video/*">
                <label for="videoFileInput" class="cursor-pointer">
                    <div class="mx-auto mb-3 w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center">
                        <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
                        </svg>
                    </div>
                    <p class="text-sm text-slate-700 font-medium">Drop video file here or click to upload</p>
                    <p class="text-xs text-slate-500 mt-1">Supported formats: MP4, MOV, AVI</p>
                </label>
            </div>
        </div>

        <div class="border-t border-slate-200 px-6 py-4 bg-slate-50">
            <div class="flex justify-end gap-3">
                <button id="closeVideoModal" 
                        class="px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-200 rounded-lg transition-colors">
                    Cancel
                </button>
                <button id="uploadVideo" 
                        class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors shadow-sm">
                    Upload Video
                </button>
            </div>
        </div>
    </div>
</div>

</div>

<!-- Include Bootstrap 5 JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  
 <!-- FullCalendar JavaScript -->
 <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
<!-- ---------------------------------------------------------------------------------------------------------------------------------------------------------- -->

<!-- Channel info -->
<div class="fixed top-2 left-1/2 -translate-x-1/2 z-50 w-full max-w-4xl px-4">
    <div class="bg-white border-b border-gray-200 rounded-t-xl shadow-header flex items-center gap-3 py-2 px-3">
        <!-- Channel Icon -->
        <div class="bg-gradient-to-br from-blue-600 to-purple-500 w-10 h-10 rounded-lg flex items-center justify-center text-lg font-bold text-white">
            #
        </div>

        <!-- Channel Info -->
        <div class="flex-1 min-w-0">
            <div class="flex items-baseline gap-2">
                <h1 class="text-xl font-semibold text-gray-900 truncate">
                    {{ channel.name }}
                </h1>
                <div class="flex items-center gap-1.5 text-xs text-gray-500">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                    </svg>
                    <span>{{ member_count }} members</span>
                </div>
            </div>
            <p class="text-gray-500 text-xs truncate mt-0.5">
                ⭐ Central hub for announcements, team updates, and recognition
            </p>
        </div>
    </div>
</div>


<!-- -------------------------------------------------------------------------------------------------------------------------------------------------------- -->

<!-- chnnel events calendar -->
<div id="calendar-container" class="mt-5 hidden rounded-lg shadow-lg border border-gray-200 bg-white overflow-hidden">
    <div class="calendar-header flex items-center justify-between px-6 py-4 bg-white border-b border-gray-200">
      <div class="flex items-center gap-4">
        <button class="text-gray-700 hover:bg-gray-100 p-2 rounded-full transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        </button>
        <button class="text-gray-700 hover:bg-gray-100 p-2 rounded-full transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </button>
        <h2 class="text-xl font-semibold text-gray-800 font-inter">April 2025</h2>
      </div>
      <div class="flex items-center gap-2">
        <button class="text-sm font-medium text-gray-600 hover:bg-gray-100 px-3 py-1 rounded transition-colors">Today</button>
        <div class="flex border rounded overflow-hidden">
          <button class="text-sm font-medium text-gray-600 hover:bg-gray-100 px-3 py-1 transition-colors border-r">Day</button>
          <button class="text-sm font-medium text-white bg-blue-600 px-3 py-1 transition-colors">Week</button>
          <button class="text-sm font-medium text-gray-600 hover:bg-gray-100 px-3 py-1 transition-colors border-l">Month</button>
        </div>
      </div>
    </div>
    
    <!-- Preserving your original calendar div exactly as is -->
    <div id="calendar" class="bg-white"></div>
</div>
  
 


<!-- sidebar --------------------------------------------------------------------------------------------------------------------------------------- -->
<!-- re-initialized channels sidebar -->
<div class="sidebar-pro fixed left-0 top-0 bottom-0 w-64 bg-white shadow-lg flex flex-col h-screen border-r border-gray-100 z-10 overflow-hidden">
    <!-- Header -->
    <div class="sidebar-pro-header p-4 border-b border-gray-100">
        <div class="flex items-center space-x-2">
            <div class="w-6 h-6 rounded bg-purple-500 flex items-center justify-center text-white">
                <span class="text-xs font-bold">#</span>
            </div>
            <h2 class="font-inter text-base font-medium text-gray-800 truncate">{{channel.name}}</h2>
        </div>
    </div>
    
    <!-- Content -->
    <div class="sidebar-pro-menu flex-1 overflow-y-auto px-2 py-3 space-y-1">
        <!-- Section: Channel Overview -->
        <div class="mb-4">
            <div class="text-xs font-medium text-gray-400 uppercase tracking-wider px-3 mb-2">Channel</div>
            
            <button id="show-calendar-btn" class="sidebar-pro-item group w-full">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-calendar-alt text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Channel Events Overview</span>
                </div>
            </button>
            
            <button id="fetchEventDetailsBtn" class="sidebar-pro-item group w-full" 
                   data-org-id="{{ channel.organization.id }}" 
                   data-channel-id="{{ channel.id }}" 
                   data-bs-toggle="modal" 
                   data-bs-target="#eventDetailsModalPremium">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-database text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">{{channel.organization.name}} Handbook Info</span>
                </div>
            </button>
        </div>

        <!-- Video Section -->
        <div id="screenShareContainer" class="mb-4 px-3">
            <video id="localVideo" autoplay muted class="w-full rounded-md mb-2 bg-gray-100"></video>
            <div id="remoteVideos" class="w-full rounded-md bg-gray-100"></div>
        </div>
        
        <!-- Section: Tools & Integration -->
        <div class="mb-4">
            <div class="text-xs font-medium text-gray-400 uppercase tracking-wider px-3 mb-2">Tools</div>
            
            <button class="sidebar-pro-item group w-full">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-plug text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Integrate Slack & Other Tools</span>
                </div>
            </button>
            
            <button id="monitor-recurring-messages-btn" class="sidebar-pro-item group w-full">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-random text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Track Recurring Messages</span>
                </div>
            </button>
        </div>
        
        <!-- Section: Analytics & Activities -->
        <div class="mb-4">
            <div class="text-xs font-medium text-gray-400 uppercase tracking-wider px-3 mb-2">Analytics</div>
            
            <button id="fetchLogsButton" class="sidebar-pro-item group w-full">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-history text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Access Channel Activity</span>
                </div>
            </button>
            
            <button type="button" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="#statisticsModal">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-chart-line text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Check Channel Metrics</span>
                </div>
            </button>
            
            <button id="showStatsButton" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="#statsModal">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-database text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Monitor My Storage</span>
                </div>
            </button>
        </div>
        
        <!-- Section: Users & Members -->
        <div class="mb-4">
            <div class="text-xs font-medium text-gray-400 uppercase tracking-wider px-3 mb-2">Users</div>
            
            <button id="userListButton" class="sidebar-pro-item group w-full">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-users text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Browse Users</span>
                </div>
            </button>
            
            {% if channel.created_by == request.user %}
            <button class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="#userSelectionModal">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-ban text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Restrict User</span>
                </div>
            </button>
            
            <button type="button" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="#shareModal">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-share-alt text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Grant Channel Access</span>
                </div>
            </button>
            {% endif %}
        </div>
        
        <!-- Section: Channel Information -->
        <div class="mb-4">
            <div class="text-xs font-medium text-gray-400 uppercase tracking-wider px-3 mb-2">Information</div>
            
            <button id="viewChannelDetailsButton" class="sidebar-pro-item group w-full">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-info-circle text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Channel Info</span>
                </div>
            </button>
            
            <a href="{% url 'export_data' org_id=channel.organization.id channel_id=channel.id %}" 
               class="sidebar-pro-item group w-full block" id="exportDataButton">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-download text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Export Files</span>
                </div>
            </a>
        </div>
        
        <!-- Section: Navigation -->
        <div class="mb-4">
            <div class="text-xs font-medium text-gray-400 uppercase tracking-wider px-3 mb-2">Navigation</div>
            
            <button id="filterButton" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-location-arrow text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Navigate To</span>
                </div>
            </button>
            
            <button id="filterButton" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-building text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <a href="{% url 'org_detail' org_id=channel.organization.id%}" class="ml-3 hover:text-purple-600 truncate">
                        {{channel.organization.name}}
                    </a>
                </div>
            </button>
            
            <button id="filterButton" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-sync text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <a href="{% url 'channel_chat' channel_id=channel.id%}" class="ml-3 hover:text-purple-600 truncate">
                        Sync
                    </a>
                </div>
            </button>
        </div>
        
        <!-- Section: Data Management -->
        <div class="mb-4">
            <div class="text-xs font-medium text-gray-400 uppercase tracking-wider px-3 mb-2">Data Management</div>
            
            <button id="deleteMessagesButton" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-trash-alt text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Wipe My Messages</span>
                </div>
            </button>
            
            {% if channel.created_by == request.user %}
            <button id="deleteChannelDataBtn" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-times-circle text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Clear All Channel Data</span>
                </div>
            </button>
            {% endif %}
        </div>
        
        <!-- Admin Options (Only for channel creators) -->
        {% if channel.created_by == request.user %}
        <div class="mb-4">
            <div class="text-xs font-medium text-gray-400 uppercase tracking-wider px-3 mb-2">Admin Settings</div>
            
            <button type="button" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="#retentionPolicyModal">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-shield-alt text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Configure Retention Settings</span>
                </div>
            </button>
            
            <button type="button" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="#warnModal">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-flag text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Flagged Texts & Warn</span>
                </div>
            </button>
            
            <button type="button" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="#EventHandleModal">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-building text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Company Handbook</span>
                </div>
            </button>

            <button type="button" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="#shareModal">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-building text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Grant Channel Access</span>
                </div>
            </button>
               
            
            <button type="button" class="sidebar-pro-item group w-full" data-bs-toggle="modal" data-bs-target="#settingsModal">
                <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                    <i class="fas fa-sliders-h text-gray-400 group-hover:text-purple-500 w-5"></i>
                    <span class="ml-3 truncate">Open {{channel.name}} Settings</span>
                </div>
            </button>

        </div>
        {% endif %}
    </div>
    
    <!-- Footer -->
    <div class="sidebar-pro-footer border-t border-gray-100 px-2 py-3 space-y-1">
        <button class="sidebar-pro-item group w-full">
            <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                <i class="fas fa-cogs text-gray-400 group-hover:text-purple-500 w-5"></i>
                <span class="ml-3 truncate">Settings</span>
            </div>
        </button>
        
        <button class="sidebar-pro-item group w-full">
            <div class="flex items-center px-3 py-2 text-sm text-gray-600 rounded-md hover:bg-gray-50 group-hover:text-purple-600 transition-all">
                <i class="fas fa-plug text-gray-400 group-hover:text-purple-500 w-5"></i>
                <span class="ml-3 truncate">Integrate Slack & Other Tools</span>
            </div>
        </button>
    </div>
</div>
<!-- ------------------------------------------------------------------------------------------------- -->

<!-- Re-initialized chat window -->
<style>
   
  </style>
</head>
<body>


<div class="clickup-container">
    <!-- Search bar -->
    
    <!-- Chat window -->
    <div class="clickup-card">
      <!-- Header -->
      <div class="clickup-header">
        <div class="clickup-header-title">
          <div style="width: 32px; height: 32px; background-color: #7b68ee; color: white; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
            <i class="fas fa-comments"></i>
          </div>
          <h2 style="font-size: 16px; font-weight: 600;">Team Chat</h2>
         
        </div>

        <!-- Search bar -->
        <div class="relative w-full">
            <!-- Search bar -->
            <div class="absolute right-0 top-0 clickup-search flex items-center gap-2">
                <i class="fas fa-search text-gray-500"></i>
                <input 
                    type="text" 
                    id="searchInput" 
                    placeholder="Search messages and links..." 
                    class="form-control form-control-lg"
                />
            </div>
        </div>
        
        <div style="display: flex; gap: 8px;">
          <button style="background: none; border: none; color: #686b78; width: 32px; height: 32px; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
            <i class="fas fa-bell"></i>
          </button>
          <button style="background: none; border: none; color: #686b78; width: 32px; height: 32px; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
            <i class="fas fa-cog"></i>
          </button>
        </div>
      </div>

      <!-- Messages area -->
      <div id="chatWindow" class="clickup-messages">
        {% if messages %}
          <!-- Loop through messages and display them -->
          {% for message in messages %}
            <div class="clickup-message {% if message.is_pinned %} pinned {% endif %}">
              <!-- User avatar -->
              <div class="clickup-avatar" style="background-image: linear-gradient(135deg, #7b68ee, #9c92f8);">
                {{ message.user.username|slice:":1" }}
              </div>
              
              <!-- Message content -->
              <div class="clickup-message-content">
                <!-- Parent message display - using original template logic -->
                {% if message.parent %}
                <div class="clickup-parent-message">
                  <strong>{{ message.parent.user.username }}</strong> - {{ message.parent.content }}
                </div>
                {% endif %}

                <!-- Message header -->
                <div class="clickup-message-header">
                  <span class="clickup-username">{{ message.user.username }}</span>
                  <span class="clickup-timestamp">{{ message.timestamp|date:"H:i" }}</span>
                </div>
                
                <!-- Message text -->
                <div class="clickup-message-text">
                  {% if message.link %}
                    <a href="{{ message.link }}" target="_blank" class="text-blue-500 hover:underline font-medium">
                      {{ message.link }}
                    </a>
                  {% else %}
                    <div style="font-family: 'Poppins', sans-serif;">
                      {{ message.content }}
                    </div>
                  {% endif %}
                </div>
                
                <!-- Message actions -->
                <div class="clickup-actions">
                  <!-- Reply button - preserving original data attributes -->
                  <button class="clickup-action-button reply-btn" 
                    data-message-id="{{ message.id }}" 
                    data-org-id="{{ channel.organization.id }}" 
                    data-channel-id="{{ channel.id }}">
                    <i class="fas fa-reply"></i> Reply
                  </button>
                  
                  <!-- Star button - preserving original class and data attributes -->
                  <button class="clickup-action-button star-icon {% if message.is_starred %}starred{% endif %}" 
                    data-message-id="{{ message.id }}" 
                    data-org-id="{{ channel.organization.id }}" 
                    data-channel-id="{{ channel.id }}">
                    <i class="fas fa-star"></i>
                    <span class="star-status">
                      {% if message.is_starred %}Starred{% else %}Star{% endif %}
                    </span>
                  </button>
                  
                  <!-- Menu - preserving original class structure -->
                  {% if message.user == request.user %}
                  <div class="clickup-menu">
                    <button class="clickup-action-button menu-button">
                      <i class="fas fa-ellipsis-h"></i>
                    </button>
                    <!-- Menu options - keeping the hidden class as in original -->
                    <div class="clickup-menu-content menu-options hidden">
                      <!-- Delete form - preserving action URL -->
                      <form action="{% url 'delete_message' org_id=channel.organization.id channel_id=channel.id message_id=message.id %}" method="POST" class="inline-block">
                        {% csrf_token %}
                        <button type="submit" class="clickup-menu-item delete delete-message">
                          <i class="fas fa-trash-alt"></i> Delete
                        </button>
                      </form>
                      
                      <!-- Edit button - preserving data attributes and classes -->
                      <button class="clickup-menu-item edit-button" data-bs-toggle="modal" data-bs-target="#editMessageModal" 
                        data-message-id="{{ message.id }}" data-current-content="{{ message.content }}">
                        <i class="fas fa-edit"></i> Edit
                      </button>
                      
                      <!-- Pin button - preserving onclick function and original logic -->
                      <button onclick="togglePinMessage({{ message.organization.id }}, {{ message.channel.id }}, {{ message.id }})" class="clickup-menu-item">
                        <i class="fas fa-thumbtack"></i>
                        {% if message.is_pinned %}Unpin{% else %}Pin{% endif %}
                      </button>
                      
                      <!-- Set recurring button - preserving data attributes and class -->
                      <button id="setRecurringButton" 
                      class="clickup-menu-item" 
                      data-message-id="{{ message.id }}" 
                      data-org-id="{{ channel.organization.id }}" 
                      data-channel-id="{{ channel.id }}">
                      <i class="fas fa-redo-alt"></i> Set as Recurring
                    </button>
          
                    </div>
                  </div>
                  {% endif %}
                </div>
              </div>
            </div>
          {% endfor %}
          
          <!-- Loop through links - preserving original template logic -->
          {% for link in links %}
            <div class="clickup-message">
              <!-- User avatar -->
              <div class="clickup-avatar" style="background-image: linear-gradient(135deg, #24b47e, #4ade80);">
                {{ link.user.username|slice:":1" }}
              </div>
              
              <!-- Link content -->
              <div class="clickup-message-content">
                <div class="clickup-message-header">
                  <span class="clickup-username" style="color: #24b47e;">{{ link.user.username }}</span>
                  <span class="clickup-timestamp">{{ link.timestamp|date:"H:i" }}</span>
                </div>
                
                <div style="padding: 10px; background-color: var(--clickup-gray); border-radius: 6px; margin-bottom: 8px;">
                  <a href="{{ link.link }}" target="_blank" style="color: #2563eb; text-decoration: none; font-weight: 500; display: flex; align-items: center; gap: 6px;">
                    <i class="fas fa-link"></i> {{ link.text }}
                  </a>
                  <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">{{ link.link }}</div>
                </div>
                
                <!-- Link actions -->
                {% if link.user == request.user %}
                <div class="clickup-actions">
                  <div class="clickup-menu">
                    <button class="clickup-action-button menu-button">
                      <i class="fas fa-ellipsis-h"></i>
                    </button>
                    <!-- Menu options - keeping the hidden class -->
                    <div class="clickup-menu-content menu-options hidden">
                      <!-- Delete form - preserving action URL -->
                      <form action="{% url 'delete_link' org_id=channel.organization.id channel_id=channel.id link_id=link.id %}" method="POST" class="inline-block">
                        {% csrf_token %}
                        <button type="submit" class="clickup-menu-item delete delete-message">
                          <i class="fas fa-trash-alt"></i> Delete
                        </button>
                      </form>
                      
                      <!-- Edit link button - preserving all data attributes -->
                      <button class="clickup-menu-item edit-link-button" 
                        data-link-id="{{ link.id }}" 
                        data-current-text="{{ link.text }}" 
                        data-current-link="{{ link.link }}" 
                        type="button" 
                        data-bs-toggle="modal" 
                        data-bs-target="#editLinkModal">
                        <i class="fas fa-edit"></i> Edit Link
                      </button>
                    </div>
                  </div>
                </div>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        {% else %}
          <!-- Empty state - styled to match ClickUp -->
          <div class="clickup-empty-state">
            <div class="clickup-empty-icon">
              <i class="fas fa-comment-alt"></i>
            </div>
            <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">Start a conversation</h3>
            <p style="color: var(--text-secondary); max-width: 350px; margin-bottom: 20px;">Nothing here! Start a fresh conversation and you will be the first to initiate it. Please reload the page after sending your first message.</p>
            <button style="background-color: var(--primary-color); color: white; border: none; padding: 10px 20px; border-radius: 6px; font-weight: 500;">Send a message</button>
          </div>
        {% endif %}
      </div>

      <!-- Input area -->
      <div class="clickup-input-area">
        <div class="clickup-input-container">
          <!-- Mention button - preserving ID -->
          <button id="mentionButton" style="background: none; border: none; color: #686b78; width: 36px; height: 36px; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
            <i class="fas fa-at"></i>
          </button>
          
          <!-- Message input - preserving ID -->
          <input id="messageInput" type="text" class="clickup-input" placeholder="Type a message...">
          
          <div class="clickup-input-actions">
            <!-- Emoji button - preserving ID -->
            <button id="emojiPickerButton" style="background: none; border: none; color: #686b78; width: 36px; height: 36px; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
              <i class="fas fa-smile"></i>
            </button>
            
            <!-- Send button - preserving ID -->
            <button id="sendMessage" class="clickup-send-button">
              <i class="fas fa-paper-plane"></i> Send
            </button>
          </div>
        </div>
      </div>

      <!-- Toolbar - with all original buttons and IDs -->
      <div class="clickup-toolbar">
        <div class="clickup-toolbar-group">
          <!-- Link button - preserving ID -->
          <button id="sendLinkButton" class="clickup-tool-button">
            <i class="fas fa-link"></i>
          </button>
          
          <!-- Audio button - preserving ID -->
          <button id="uploadAudioButton" class="clickup-tool-button">
            <i class="fas fa-microphone-alt"></i>
          </button>
          
          <!-- Video button - preserving ID -->
          <button id="uploadVideoButton" class="clickup-tool-button">
            <i class="fas fa-video"></i>
          </button>
          
          <!-- Call button - preserving ID -->
          <button id="callButton" class="clickup-tool-button">
            <i class="fas fa-phone-alt"></i>
          </button>
        </div>
        
        <div class="clickup-toolbar-group">
          <!-- Plus button - preserving ID -->
          <button id="screenShareButton" class="clickup-tool-button">
            <i class="fas fa-plus"></i>
          </button>
          
          <!-- Screen share button - preserving ID and onclick -->
          <button id="shareScreenBtn" onclick="startScreenShare()" class="clickup-tool-button">
            <i class="fas fa-desktop"></i>
          </button>
          
          <!-- Filter button - preserving data attributes -->
          <button class="clickup-tool-button" data-bs-toggle="modal" data-bs-target="#filterByUserModal">
            <i class="fas fa-user"></i>
          </button>
          
          <!-- Network status button - preserving onclick and data attributes -->
          <button class="clickup-tool-button" data-bs-toggle="modal" data-bs-target="#networkStatusModal" onclick="displayNetworkStatus()">
            <i class="fas fa-wifi"></i>
          </button>
          
          <!-- Additional buttons from original code -->
          <button class="clickup-tool-button" data-bs-toggle="modal" data-bs-target="">
            <i class="fab fa-slack"></i>
          </button>
          
          <button class="clickup-tool-button" data-bs-toggle="modal" data-bs-target="">
            <i class="fas fa-tasks"></i>
          </button>
          
          <button class="clickup-tool-button" data-bs-toggle="modal" data-bs-target="">
            <i class="fas fa-poll"></i>
          </button>
          
          <button class="clickup-tool-button" data-bs-toggle="modal" data-bs-target="">
            <i class="fas fa-code"></i>
          </button>
        </div>
      </div>
    </div>
</div>
<!------------------------------------------------------------------------------------------------------------------------------------------ -->

<!-- ----------------------------------------------------------------------------------------------------------------------------------------------- -->

<script>
     
        // -----------------------------------------------------------------------------------------
      
        const channelId = "{{ channel.id }}";
        const chatSocket = new WebSocket(`ws://${window.location.host}/ws/channel/${channelId}/`);

        // Video element to display the shared screen
        const screenShareVideo = document.getElementById('screen-share-video');


        const username = "{{ user.username }}"; // Get the current username from the template.

       // Screen sharing variables
let localStream;
let peerConnections = {};
let typingTimeout;

// WebRTC Configuration
const configuration = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };

// Initialize a Peer Connection if not already present
function getOrCreatePeerConnection(userId) {
    if (!peerConnections[userId]) {
        const peerConnection = new RTCPeerConnection(configuration);

        // Handle incoming tracks
        peerConnection.ontrack = event => {
            const remoteVideo = document.getElementById(`remoteScreen_${userId}`) || document.createElement('video');
            if (!remoteVideo.id) {
                remoteVideo.id = `remoteScreen_${userId}`;
                remoteVideo.autoplay = true;
                remoteVideo.controls = true; // Optional for user control
                document.getElementById('remoteVideos').appendChild(remoteVideo);
            }
            if (event.track.kind === 'video') remoteVideo.srcObject = event.streams[0];
        };

        // Handle disconnection or error cleanup
        peerConnection.oniceconnectionstatechange = () => {
            if (peerConnection.iceConnectionState === 'disconnected' || peerConnection.iceConnectionState === 'failed') {
                removeRemoteScreen(userId);
                delete peerConnections[userId];
            }
        };

        peerConnections[userId] = peerConnection;
    }
    return peerConnections[userId];
}

// Start screen sharing
async function startScreenShare() {
    try {
        localStream = await navigator.mediaDevices.getDisplayMedia({ video: { mediaSource: "screen" } });
        document.getElementById('localVideo').srcObject = localStream;

        // Show the screen share container
        const screenShareContainer = document.getElementById('screenShareContainer');
        screenShareContainer.style.display = 'block';

        document.getElementById('shareScreenBtn').style.display = 'none';
        document.getElementById('stopShareBtn').style.display = 'block';

        const videoTrack = localStream.getVideoTracks()[0];
        Object.keys(peerConnections).forEach(peerId => {
            const sender = peerConnections[peerId].getSenders().find(s => s.track.kind === "video");
            if (sender) sender.replaceTrack(videoTrack);
        });

        socket.send(JSON.stringify({ type: 'screen-share-start', user_id: userId }));
    } catch (error) {
        console.error('Error starting screen share:', error);
    }
}

// Stop screen sharing
function stopScreenShare() {
    if (localStream) {
        localStream.getTracks().forEach(track => track.stop());
        document.getElementById('localVideo').srcObject = null;

        // Hide the screen share container
        const screenShareContainer = document.getElementById('screenShareContainer');
        screenShareContainer.style.display = 'none';

        document.getElementById('shareScreenBtn').style.display = 'block';
        document.getElementById('stopShareBtn').style.display = 'none';

        socket.send(JSON.stringify({ type: 'screen-share-stop', user_id: userId }));
    }
}

// Display remote screen
function displayRemoteScreen(userId) {
    const peerConnection = getOrCreatePeerConnection(userId);
    // Ensure signaling or offer-answer mechanism is established
    if (!peerConnection.currentRemoteDescription) {
        console.warn(`No remote description for ${userId}. Ensure proper signaling.`);
    }
}

// Remove remote screen
function removeRemoteScreen(userId) {
    const remoteVideo = document.getElementById(`remoteScreen_${userId}`);
    if (remoteVideo) remoteVideo.remove();
    if (peerConnections[userId]) {
        peerConnections[userId].close();
        delete peerConnections[userId];
    }
}

function makeDraggable(element) {
    let isDragging = false;
    let offsetX, offsetY;

    element.addEventListener('mousedown', (e) => {
        isDragging = true;
        offsetX = e.clientX - element.offsetLeft;
        offsetY = e.clientY - element.offsetTop;
        element.style.cursor = 'grabbing';
    });

    document.addEventListener('mousemove', (e) => {
        if (isDragging) {
            element.style.left = `${e.clientX - offsetX}px`;
            element.style.top = `${e.clientY - offsetY}px`;
        }
    });

    document.addEventListener('mouseup', () => {
        if (isDragging) {
            isDragging = false;
            element.style.cursor = 'grab';
        }
    });

    // Optional: Reset cursor on mouse leave
    element.addEventListener('mouseleave', () => {
        if (isDragging) {
            isDragging = false;
            element.style.cursor = 'grab';
        }
    });
}

// Initialize draggable feature for the screen share container
document.addEventListener('DOMContentLoaded', () => {
    const screenShareContainer = document.getElementById('screenShareContainer');
    makeDraggable(screenShareContainer);
});

// --------------------------------------------------------------------------------------------------
        // When the WebSocket connection is opened
        chatSocket.onopen = function(e) {
            console.log('WebSocket connection established!');
        };

        // When a new message is received from the WebSocket
        chatSocket.onmessage = function (e) {
        const data = JSON.parse(e.data);

    // Handle typing indicator
    if (data['event'] === 'typing') {
        const typingIndicator = document.getElementById('typingIndicator');
        const username = data['username'];

        if (username) {
            // Show the typing indicator with the username
            typingIndicator.textContent = `${username} is typing...`;
            typingIndicator.classList.remove('hidden');
        } else {
            // Hide the typing indicator when no one is typing
            typingIndicator.classList.add('hidden');
        }
        return; // Exit here for typing events, so it doesn't interfere with the rest of the logic
    }

    // Handle new message
    const message = data['message'];
    const username = data['username'];
    const messageElement = document.createElement('div');

    messageElement.className = 'border-b border-gray-100 py-4 px-6 group/message animate-fadeInUp';
messageElement.innerHTML = `
    <div class="flex items-start gap-4">
        <div class="w-10 h-10 flex-shrink-0 bg-blue-600 rounded-lg flex items-center justify-center text-white font-semibold text-lg shadow-sm transition-all duration-300 hover:scale-[1.02]">
            ${username.slice(0, 1).toUpperCase()}
        </div>
        <div class="flex flex-col flex-1 min-w-0">
            <div class="flex justify-between items-baseline mb-1">
                <div class="flex items-center gap-2">
                    <span class="text-sm font-semibold text-gray-900">${username}</span>
                    <span class="text-xs text-gray-400 font-medium">${data['time']}</span>
                </div>
            </div>
            <p class="text-gray-700 text-[15px] leading-snug transition-opacity duration-200 hover:opacity-80">
                ${message}
            </p>
        </div>
    </div>
`;

if (data['link']) {
    messageElement.innerHTML = `
    <div class="flex items-start gap-4">
        <div class="w-10 h-10 flex-shrink-0 bg-blue-600 rounded-lg flex items-center justify-center text-white font-semibold text-lg shadow-sm transition-all duration-300 hover:scale-[1.02]">
            ${username.slice(0, 1).toUpperCase()}
        </div>
        <div class="flex flex-col flex-1 min-w-0">
            <div class="flex justify-between items-baseline mb-1">
                <div class="flex items-center gap-2">
                    <span class="text-sm font-semibold text-gray-900">${username}</span>
                    <span class="text-xs text-gray-400 font-medium">${data['time']}</span>
                </div>
            </div>
            <a href="${data['link']}" target="_blank" class="
                inline-flex items-center gap-2
                pl-3 pr-3 py-2
                bg-white hover:bg-gray-50
                rounded-lg
                border border-gray-200
                text-sm font-medium text-blue-600
                transition-all
                duration-300
                hover:shadow-sm
                hover:-translate-y-0.5
                group/link
            ">
                <svg class="w-4 h-4 text-blue-500 transition-transform group-hover/link:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                </svg>
                <span class="truncate max-w-[220px]">${data['link']}</span>
                <svg class="w-4 h-4 ml-1 text-blue-400 opacity-0 group-hover/link:opacity-100 transition-all" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                </svg>
            </a>
        </div>
    </div>
    `;
}
    

    document.getElementById('chatWindow').appendChild(messageElement);
    document.getElementById('chatWindow').scrollTop = document.getElementById('chatWindow').scrollHeight;
};

        // Emoji Picker Modal Logic
        const emojiPickerButton = document.getElementById('emojiPickerButton');
        const emojiPickerModal = document.getElementById('emojiPickerModal');
        const closeEmojiPickerModal = document.getElementById('closeEmojiPickerModal');

        
// Toggle the emoji picker modal
emojiPickerButton.addEventListener('click', () => {
    emojiPickerModal.classList.add('show');
});

// Close the modal when the close button is clicked
closeEmojiPickerModal.addEventListener('click', () => {
    emojiPickerModal.classList.remove('show');
});
        const emojiContainer = document.getElementById('emojiContainer');
        const emojis = [
  '🚀', '⚡', '💥', '🔥', '🌟', '🏆', '💯', '✅', '📝', '💻', 
  '📱', '📊', '💼', '🔧', '🛠️', '⚙️', '🧠', '💡', '⏳', '⏰', 
  '💪', '🧑‍💻', '👩‍💻', '🤖', '🤩', '👑', '📈', '🔝', '🌍', '🌎', 
  '🌏', '📅', '🗓️', '🕒', '📍', '🗺️', '🌐', '🏅', '🥇', '🏆', 
  '🎯', '💭', '🔮', '🧳', '💪', '🚨', '⚠️', '❗', '❕', '💬', 
  '💭', '💬', '💋', '❤️', '💖', '💙', '💚', '💛', '💜', '🖤',
  '💝', '💘', '💞', '💌', '💋', '👄', '🤍', '💙', '❤️', '💛', 
  '💚', '💜', '💖', '❤️‍🔥', '💀', '☠️', '🫀', '🫣', '🙀', 
  '😳', '😬', '🤭', '🙄', '🤔', '🥲', '😭', '😢', '😤', '😡', 
  '🤡', '🤣', '😂', '😆', '😹', '😂', '🤣', '😏', '🧐', '🫶', 
  '🤪', '🥴', '😋', '🤤', '🤩', '😍', '🥰', '😎', '🤓', '🧑‍🎤',
  '🎤', '🎧', '🎶', '🎸', '🎻', '🥁', '🎷', '🎺', '🎵', '🎼',
  '🎹', '🎶', '🥳', '🎉', '💃', '🕺', '🤸‍♀️', '🤸‍♂️', '🕺',
  '💃', '🩰', '🏋️‍♀️', '🏋️‍♂️', '🤸‍♀️', '🤸‍♂️', '🚴‍♀️', 
  '🚴‍♂️', '⛷️', '🏄‍♀️', '🏄‍♂️', '🤾‍♀️', '🤾‍♂️', '🏃‍♀️', 
  '🏃‍♂️', '💆‍♀️', '💆‍♂️', '💅', '🧑‍🦰', '🧑‍🦳', '🧑‍🦱',
  '💅', '🧖‍♀️', '🧖‍♂️', '🧑‍⚖️', '🎯', '🎳', '🏓', '🏸', 
  '⚽', '🏀', '🏈', '🎾', '🏐', '🏑', '🏒', '🥋', '⛸️', '🏅',
  '🥇', '🥈', '🥉', '🏆', '🎮', '🎮', '🖥️', '🎲', '🎯', '🧩',
  '🎲', '🧠', '💡', '📚', '📖', '📝', '📜', '📄', '📋', '📎',
  '✂️', '📌', '📍', '📅', '📆', '🗓️', '🔖', '🗃️', '📒', 
  '📚', '📑', '📙', '📘', '📗', '📒', '📓', '📂', '📁', '💼', 
  '🧳', '🎒', '💼', '🧸', '👕', '👚', '👗', '👖', '👔', '👚', 
  '👠', '👢', '👡', '👟', '🥿', '👞', '🧢', '👑', '👒', '🎩', 
  '💍', '📿', '💄', '💅', '👓', '🕶️', '👛', '👝', '💼', '🧳', 
  '🎒', '👜', '👝', '👛', '🧣', '🧤', '🧥', '👗', '👚', '🧵', 
  '🧶', '🎨', '🎭', '🎪', '🖼️', '🎬', '🎥', '🎞️', '🎬', '📸', 
  '📷', '📹', '🎥', '🎬', '🎞️', '🎭', '🖼️', '🎤', '🎧', '🎼',
  '🎶', '🎵', '🎻', '🎺', '🎷', '🎸', '🥁', '🎤', '🎬', '🎵',
  '🎶', '🎧', '🎤', '🎼', '🎸', '🥁', '🎻', '🎶', '🎧', '🎷', 
  '🎺', '🎸', '🪕', '🎶', '🎤', '🎬', '🎶', '🎧', '📻', '🎵',
  '🎼', '🎸', '🎹', '🎷', '🥁', '🎼', '🎧', '🎻', '🎤', '🎶',
  '🎸', '🎷', '🎺', '🎻', '🎶', '🎼', '🎤', '🎵', '🎶', '🎹'
];



        emojiPickerButton.onclick = () => {
            emojiContainer.innerHTML = '';
            emojis.forEach(emoji => {
                const button = document.createElement('button');
                button.className = 'text-2xl';
                button.textContent = emoji;
                button.onclick = () => {
                    const messageInput = document.getElementById('messageInput');
                    messageInput.value += emoji;
                    emojiPickerModal.classList.add('hidden');
                };
                emojiContainer.appendChild(button);
            });
            emojiPickerModal.classList.remove('hidden');
        };

        closeEmojiPickerModal.onclick = () => emojiPickerModal.classList.add('hidden');

        // Open the audio upload modal
        document.getElementById('uploadAudioButton').onclick = function() {
            document.getElementById('audioUploadModal').classList.remove('hidden');
        };

        // Close the audio upload modal
        document.getElementById('closeAudioModal').onclick = function() {
            document.getElementById('audioUploadModal').classList.add('hidden');
        };

        // Open the video upload modal
        document.getElementById('uploadVideoButton').onclick = function() {
            document.getElementById('videoUploadModal').classList.remove('hidden');
        };

        // Close the video upload modal
        document.getElementById('closeVideoModal').onclick = function() {
            document.getElementById('videoUploadModal').classList.add('hidden');
        };

        // Handle file uploads (Audio and Video)
        document.getElementById('uploadAudio').onclick = function() {
            const audioFile = document.getElementById('audioFileInput').files[0];
            if (audioFile) {
                // Handle audio file upload here (send to server)
                chatSocket.send(JSON.stringify({'audio': audioFile}));
                document.getElementById('audioUploadModal').classList.add('hidden');
            }
        };

        document.getElementById('uploadVideo').onclick = function() {
            const videoFile = document.getElementById('videoFileInput').files[0];
            if (videoFile) {
                // Handle video file upload here (send to server)
                chatSocket.send(JSON.stringify({'video': videoFile}));
                document.getElementById('videoUploadModal').classList.add('hidden');
            }
        };

        // Send the message when the Send button is clicked
        document.getElementById('sendMessage').onclick = function(e) {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value;
            if (message.trim()) {
                chatSocket.send(JSON.stringify({'message': message}));
                messageInput.value = '';  // Clear the input
            }
        };

        // Allow the Enter key to send the message
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('sendMessage').click();
            }
        });


           // Handle WebSocket connection closing
           chatSocket.onclose = function(e) {
            console.log('WebSocket connection closed.');
        };

        // Send the message when the Send button is clicked
        document.getElementById('sendMessage').onclick = function(e) {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value;
            if (message.trim()) {
                chatSocket.send(JSON.stringify({'message': message}));
                messageInput.value = '';  // Clear the input
            }
        };

        // Allow the Enter key to send the message
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('sendMessage').click();
            }
        });

        // Open the mention modal when the "Mention User" button is clicked
        document.getElementById('mentionButton').onclick = function() {
            // Fetch the members from the organization
            fetch(`/channels/get_organization_members/{{ channel.organization.id }}/`)

                .then(response => response.json())
                .then(data => {
                    const mentionList = document.getElementById('mentionList');
                    mentionList.innerHTML = '';  // Clear existing list
                    data.members.forEach(member => {
                        const listItem = document.createElement('li');
                        listItem.className = 'cursor-pointer text-blue-500 hover:underline';
                        listItem.textContent = member.username;
                        listItem.onclick = function() {
                            const messageInput = document.getElementById('messageInput');
                            messageInput.value += `@${member.username} `; // Append mention to input
                            document.getElementById('mentionModal').classList.add('hidden');
                        };
                        mentionList.appendChild(listItem);
                    });
                    document.getElementById('mentionModal').classList.remove('hidden');
                });
        };

        // Close the mention modal when the "Close" button is clicked
        document.getElementById('closeMentionModal').onclick = function() {
            document.getElementById('mentionModal').classList.add('hidden');
        };

        // Open the send link modal when the "Send Link" button is clicked
        document.getElementById('sendLinkButton').onclick = function() {
            document.getElementById('sendLinkModal').classList.remove('hidden');
        };

        // Close the send link modal when the "Cancel" button is clicked
        document.getElementById('closeLinkModal').onclick = function() {
            document.getElementById('sendLinkModal').classList.add('hidden');
        };

        // Send the link when the "Send Link" button in the modal is clicked
        document.getElementById('sendLink').onclick = function() {
            const linkText = document.getElementById('linkText').value;
            const linkUrl = document.getElementById('linkUrl').value;
            if (linkText.trim() && linkUrl.trim()) {
                chatSocket.send(JSON.stringify({'linkText': linkText, 'linkUrl': linkUrl}));
                document.getElementById('linkText').value = '';  // Clear the link text input
                document.getElementById('linkUrl').value = '';   // Clear the link URL input
                document.getElementById('sendLinkModal').classList.add('hidden');
            }
        };

// -----------------------------------------------------------------------------------------------------------------------------------------------------------------





document.getElementById('userListButton').onclick = function () {
    const orgId = "{{ channel.organization.id }}"; // Organization ID from Django template
    const channelId = "{{ channel.id }}"; // Channel ID from Django template

    // Make an AJAX request to fetch users associated with the channel
    fetch(`/channels/channels/get_members/${orgId}/${channelId}/`)
        .then(response => response.json())
        .then(data => {
            const userList = document.getElementById('userList');
            userList.innerHTML = ''; // Clear existing user list

            if (data.members && data.members.length > 0) {
                // Populate the user list with members

               data.members.forEach(user => {
    const listItem = document.createElement('li');
    listItem.className = `
        group flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg transition-colors
        cursor-pointer border-b border-gray-100 last:border-0
    `;

    // User avatar with initial
    const avatar = document.createElement('div');
    avatar.className = `
        w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-purple-500
        flex items-center justify-center text-white font-medium text-sm
    `;
    avatar.textContent = user.username.charAt(0).toUpperCase();

    // User info container
    const userInfo = document.createElement('div');
    userInfo.className = 'flex-1 min-w-0';

    // Username with hover effect
    const username = document.createElement('span');
    username.className = 'block text-sm font-medium text-gray-900 truncate';
    username.textContent = user.username;

    // Additional user info (email/role)
    const userMeta = document.createElement('p');
    userMeta.className = 'text-xs text-gray-500 truncate';
    userMeta.textContent = user.email || 'Team Member';

    // Online status indicator
    const status = document.createElement('div');
    status.className = `
        w-2.5 h-2.5 rounded-full border-2 border-white
        ${user.isOnline ? 'bg-green-500' : 'bg-gray-300'}
    `;

    // Assemble components
    userInfo.appendChild(username);
    userInfo.appendChild(userMeta);
    
    listItem.appendChild(avatar);
    listItem.appendChild(userInfo);
    listItem.appendChild(status);

    userList.appendChild(listItem);
});


            } else {
                // Handle case when no users are found
                const noUsersItem = document.createElement('li');
                noUsersItem.className = 'list-group-item text-danger';
                noUsersItem.textContent = "No users found!";
                userList.appendChild(noUsersItem);
            }

            // Show the modal using Bootstrap 5's modal JavaScript
            const modal = new bootstrap.Modal(document.getElementById('userListModal'));
            modal.show();
        })
        .catch(error => {
            console.error('Error fetching users:', error);
        });
};



// Fetch activity logs

document.getElementById('fetchLogsButton').onclick = function() {
    const channelId = "{{ channel.id }}";  // Channel ID from Django template
    const orgId = "{{channel.organization.id}}";

    // Make an AJAX request to fetch activity logs
    fetch(`/channels/channels/fetch_activity_logs/${channelId}/${orgId}`)
        .then(response => response.json())
        .then(data => {
            const logsList = document.getElementById('activityLogsList');
            logsList.innerHTML = '';  // Clear existing logs

            if (data.success) {
                // If logs are found, populate the modal with them
                data.logs.forEach(log => {
                    const logItem = document.createElement('div');
                    logItem.className = 'list-group-item list-group-item-action';
                    logItem.innerHTML = `
    <div class="flex items-start gap-3 p-3 hover:bg-gray-50 rounded-lg transition-colors group">
        <div class="flex-shrink-0 mt-1">
            <div class="w-6 h-6 rounded-full bg-gradient-to-tr from-blue-500 to-purple-600 flex items-center justify-center text-white text-xs">
                <i class="fas fa-user text-[10px]"></i>
            </div>
        </div>
        <div class="flex-1 min-w-0">
            <div class="flex items-baseline gap-2">
                <span class="text-sm font-medium text-gray-900">${log.user}</span>
                <span class="text-xs text-gray-400">${log.timestamp}</span>
            </div>
            <p class="text-sm text-gray-600 mt-1 leading-snug">
                ${log.content}
                <span class="inline-flex items-center gap-1 ml-2 text-gray-400 text-xs">
                    <i class="fas fa-clock text-[0.7em]"></i>
                    <span>${new Date(log.timestamp).toLocaleTimeString()}</span>
                </span>
            </p>
        </div>
    </div>
`;
                    logsList.appendChild(logItem);
                });

                // Show the modal
                var myModal = new bootstrap.Modal(document.getElementById('activityLogsModal'));
                myModal.show();
            } else {
                const noLogsItem = document.createElement('div');
                noLogsItem.className = 'list-group-item text-center text-muted';
                noLogsItem.textContent = "No activity logs found.";
                logsList.appendChild(noLogsItem);
            }
        })
        .catch(error => {
            console.error('Error fetching activity logs:', error);
        });
};



// SEARCH BAR 

document.getElementById('searchInput').addEventListener('input', function () {
    const query = this.value.trim(); // Get the search input
    const orgId = "{{ channel.organization.id }}"; // Pass organization ID dynamically
    const channelId = "{{ channel.id }}"; // Pass channel ID dynamically

    // AJAX request to fetch filtered messages and links
    fetch(`/channels/channels/search/${orgId}/${channelId}/?q=${encodeURIComponent(query)}`)
        .then(response => response.json())
        .then(data => {
            const chatWindow = document.getElementById('chatWindow');
            chatWindow.innerHTML = ''; // Clear the chat window

            // Display filtered messages
            if (data.messages.length > 0) {
                data.messages.forEach(message => {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'border-b py-2';
                    messageDiv.innerHTML = `
<div class="group flex items-start gap-3 p-4 hover:bg-gray-50 rounded-xl transition-colors relative
    ${message.is_pinned ? 'bg-amber-50 border-l-4 border-amber-400' : ''}">
    
    <!-- User Avatar -->
    <div class="flex-shrink-0 relative">
        <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-500 rounded-xl flex items-center justify-center text-white font-semibold text-sm">
            ${message.user__username.slice(0, 1).toUpperCase()}
        </div>
        ${message.is_online ? 
            '<div class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>' : ''}
    </div>

    <!-- Message Content -->
    <div class="flex-1 min-w-0">
        <!-- Header -->
        <div class="flex items-baseline gap-2 mb-1">
            <span class="font-semibold text-gray-800 hover:text-purple-600 cursor-pointer">
                ${message.user__username}
            </span>
            <span class="text-xs text-gray-400">${message.timestamp}</span>
        </div>

        <!-- Message Body -->
        <div class="text-gray-700 text-sm leading-relaxed">
            ${message.content}
            ${message.link ? 
                `<a href="${message.link}" target="_blank" 
                    class="inline-flex items-center gap-1 mt-2 px-2 py-1 bg-blue-50 text-blue-600 rounded-md hover:bg-blue-100 transition-colors">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                    </svg>
                    Open Link
                </a>` : ''}
        </div>

        <!-- Actions -->
        <div class="mt-2 flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
            <button class="text-gray-400 hover:text-blue-600 p-1 rounded-md">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"/>
                </svg>
            </button>
            <button class="text-gray-400 hover:text-amber-500 p-1 rounded-md">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"
                    ${message.is_starred ? 'class="text-amber-400 fill-current"' : ''}>
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Pinned Indicator -->
    ${message.is_pinned ? 
        `<div class="absolute top-4 right-4 text-amber-500">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"/>
            </svg>
        </div>` : ''}
</div>
`;
                    chatWindow.appendChild(messageDiv);
                });
            }

            // Display filtered links
            if (data.links.length > 0) {
                data.links.forEach(link => {
                    const linkDiv = document.createElement('div');


                    linkDiv.className = 'border-b py-2';
                   linkDiv.innerHTML = `
<div class="group flex items-start gap-3 p-4 hover:bg-gray-50 rounded-xl transition-colors border-b border-gray-100 relative">
    <!-- User Avatar -->
    <div class="relative flex-shrink-0">
        <div class="w-10 h-10 bg-gradient-to-br from-blue-400 to-green-400 rounded-lg flex items-center justify-center text-white font-semibold text-sm shadow-sm">
            ${link.user__username.slice(0, 1).toUpperCase()}
        </div>
        <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>
    </div>

    <!-- Content -->
    <div class="flex-1 min-w-0">
        <!-- Header -->
        <div class="flex items-baseline gap-2 mb-1">
            <span class="text-sm font-semibold text-gray-800 hover:text-green-600 cursor-pointer">
                ${link.user__username}
            </span>
            <span class="text-xs text-gray-400">
                <svg class="w-3 h-3 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                ${link.timestamp}
            </span>
        </div>

        <!-- Link Preview -->
        <a href="${link.link}" target="_blank" class="block mt-2 p-3 bg-white rounded-lg border border-gray-200 hover:border-blue-200 hover:shadow-sm transition-all">
            <div class="flex items-center gap-2 text-blue-600 hover:text-blue-800">
                <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                </svg>
                <span class="text-sm font-medium truncate">${link.text}</span>
            </div>
            <div class="mt-1 text-xs text-gray-500 truncate">${link.link}</div>
        </a>
    </div>

    <!-- Context Menu -->
    <div class="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity">
        <button class="text-gray-400 hover:text-gray-600 p-1 rounded-md">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"/>
            </svg>
        </button>
    </div>
</div>
`;
                    chatWindow.appendChild(linkDiv);
                });
            }

            // If no results found
            if (data.messages.length === 0 && data.links.length === 0) {
                chatWindow.innerHTML = '<p class="text-center text-gray-500">No results found!</p>';
            }
        })
        .catch(error => {
            console.error('Error fetching search results:', error);
        });
});


// CHANNEL DETAILS
document.getElementById('viewChannelDetailsButton').onclick = function() {
    const channelId = "{{ channel.id }}";
    const orgId = "{{ channel.organization.id }}";

    fetch(`/channels/channels/channel_details/${orgId}/${channelId}/`)
        .then(response => response.json())
        .then(data => {
            // Update modal elements instead of replacing entire content
            document.getElementById('channelName').textContent = data.name;
            document.getElementById('channelType').textContent = data.type;
            document.getElementById('channelVisibility').textContent = data.visibility;
            document.getElementById('channelCreatedAt').textContent = data.created_at;
            document.getElementById('channelCreatedBy').textContent = data.created_by;

            // Update members list
            const membersList = document.getElementById('membersList');
            membersList.innerHTML = data.members.map(member => `
                <li class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg transition-colors">
                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600">
                        ${member.full_name.charAt(0)}
                    </div>
                    <span class="text-sm font-medium text-gray-700">${member.full_name}</span>
                </li>
            `).join('');

            // Add dynamic styling for type
            const typeElement = document.getElementById('channelType');
            typeElement.className = `text-sm font-medium px-2.5 py-0.5 rounded-full ${
                data.type === 'Public' ? 'bg-green-100 text-green-800' : 'bg-purple-100 text-purple-800'
            }`;

            // Show the modal
            const modal = new bootstrap.Modal(document.getElementById('channelDetailsModal'));
            modal.show();
        })
        .catch(error => {
            console.error('Error fetching channel details:', error);
            showErrorToast('Failed to load channel details');
        });
};
// Exporting data pop up

document.getElementById('exportDataButton').onclick = function(event) {
    // Prevent the default action (navigating to the export page)
    event.preventDefault();

    // Show the popup message
    const popupMessage = document.getElementById('popupMessage');
    popupMessage.style.display = 'block';

    // Hide the popup after 5 seconds
    setTimeout(function() {
        popupMessage.style.display = 'none';

        // Redirect to the export data URL after the message disappears
        window.location.href = event.target.href;
    }, 3000);
};


// CHANNEL STATISTICS

 // Event listener for showing the modal
document.getElementById('statisticsModal').addEventListener('show.bs.modal', function () {
    // Fetch the org_id and channel_id dynamically, you can pass them from the context
    var org_id = "{{channel.organization.id}}";  // Replace with dynamic org_id
    var channel_id = "{{channel.id}}";  // Replace with dynamic channel_id

    // Make the AJAX request
    fetch(`/channels/channel/statistics/${org_id}/${channel_id}/`, { // Adjust the URL if necessary
      method: 'GET',
    })
    .then(response => response.json())
    .then(data => {
      if (data.error) {
        alert('Error fetching data: ' + data.error);
      } else {
        // Render the charts
        renderCharts(data);
      }
    })
    .catch(() => {
      alert('An error occurred while fetching the statistics.');
    });
});

// Function to render the charts with data from the response
function renderCharts(data) {
    // Messages Chart
    var ctxMessages = document.getElementById('messagesChart').getContext('2d');
    var messagesChart = new Chart(ctxMessages, {
      type: 'bar',
      data: {
        labels: data.message_chart.labels,
        datasets: [{
          label: data.message_chart.label,
          data: data.message_chart.data,
          backgroundColor: data.message_chart.background_color,
          borderColor: data.message_chart.border_color,
          borderWidth: data.message_chart.border_width
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });

    // Links Chart
    var ctxLinks = document.getElementById('linksChart').getContext('2d');
    var linksChart = new Chart(ctxLinks, {
      type: 'bar',
      data: {
        labels: data.link_chart.labels,
        datasets: [{
          label: data.link_chart.label,
          data: data.link_chart.data,
          backgroundColor: data.link_chart.background_color,
          borderColor: data.link_chart.border_color,
          borderWidth: data.link_chart.border_width
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });

    // User Message Counts Chart
    var ctxUserMessageCounts = document.getElementById('userMessageCountsChart').getContext('2d');
    var userMessageCountsChart = new Chart(ctxUserMessageCounts, {
      type: 'pie',
      data: {
        labels: data.user_message_counts.map(item => item.user),
        datasets: [{
          label: 'User Message Counts',
          data: data.user_message_counts.map(item => item.message_count),
          backgroundColor: ['rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)', 'rgba(54, 162, 235, 0.2)'],
          borderColor: ['rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)', 'rgba(54, 162, 235, 1)'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true
      }
    });

    // User Link Counts Chart
    var ctxUserLinkCounts = document.getElementById('userLinkCountsChart').getContext('2d');
    var userLinkCountsChart = new Chart(ctxUserLinkCounts, {
      type: 'pie',
      data: {
        labels: data.user_link_counts.map(item => item.user),
        datasets: [{
          label: 'User Link Counts',
          data: data.user_link_counts.map(item => item.link_count),
          backgroundColor: ['rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)', 'rgba(54, 162, 235, 0.2)'],
          borderColor: ['rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)', 'rgba(54, 162, 235, 1)'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true
      }
    });

    // Total Messages Chart (Bar chart)
    var ctxTotalMessages = document.getElementById('totalMessagesChart').getContext('2d');
    var totalMessagesChart = new Chart(ctxTotalMessages, {
      type: 'bar',
      data: {
        labels: ['Total Messages'],
        datasets: [{
          label: 'Total Messages',
          data: [data.total_messages],
          backgroundColor: 'rgba(75, 192, 192, 0.2)',
          borderColor: 'rgba(75, 192, 192, 1)',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });

    // Total Links Chart (Bar chart)
    var ctxTotalLinks = document.getElementById('totalLinksChart').getContext('2d');
    var totalLinksChart = new Chart(ctxTotalLinks, {
      type: 'bar',
      data: {
        labels: ['Total Links'],
        datasets: [{
          label: 'Total Links',
          data: [data.total_links],
          backgroundColor: 'rgba(153, 102, 255, 0.2)',
          borderColor: 'rgba(153, 102, 255, 1)',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });

    // King User Chart (Pie chart)
    var ctxKingUser = document.getElementById('kingUserChart').getContext('2d');
    var kingUserChart = new Chart(ctxKingUser, {
      type: 'pie',
      data: {
        labels: [data.king_user],
        datasets: [{
          label: 'King User Stats',
          data: [data.total_messages, data.total_links], // Data for the king user
          backgroundColor: ['rgba(255, 159, 64, 0.2)', 'rgba(54, 162, 235, 0.2)'],
          borderColor: ['rgba(255, 159, 64, 1)', 'rgba(54, 162, 235, 1)'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true
      }
    });
}


// Coming soon modal

// Open "Coming Soon" modal for Call button
document.getElementById('callButton').addEventListener('click', function() {
        document.getElementById('comingSoonModal').classList.remove('hidden');
    });

    // Open "Coming Soon" modal for Screen Share button
    document.getElementById('screenShareButton').addEventListener('click', function() {
        document.getElementById('comingSoonModal').classList.remove('hidden');
    });

    // Close "Coming Soon" modal
    document.getElementById('closeComingSoonModal').addEventListener('click', function() {
        document.getElementById('comingSoonModal').classList.add('hidden');
    });






// Open the filter modal
document.getElementById('filterButton').onclick = function() {
    document.getElementById('filterModal').classList.remove('hidden');
};

// Close the filter modal
document.getElementById('closeFilterModal').onclick = function() {
    document.getElementById('filterModal').classList.add('hidden');
};

// Show specific date input when "Specific Date" is selected
document.getElementById('specific_date').addEventListener('change', function() {
    document.getElementById('specificDate').style.display = 'block';
});

// Hide specific date input when other options are selected
document.querySelectorAll('input[name="filter"]').forEach(function(element) {
    element.addEventListener('change', function() {
        if (element.value !== 'specific_date') {
            document.getElementById('specificDate').style.display = 'none';
        }
    });
});


// Apply the filter and send AJAX request
// Apply the filter and send AJAX request
document.getElementById('applyFilter').onclick = function() {
    let filterOption = document.querySelector('input[name="filter"]:checked').value;
    let specificDate = filterOption === 'specific_date' ? document.getElementById('specificDate').value : null;

    let orgId = "{{channel.organization.id}}";  
    let channelId = "{{channel.id}}";  

    fetch(`/channels/filter_messages/${orgId}/${channelId}/?filter_option=${filterOption}&specific_date=${specificDate}`)
        .then(response => response.json())
        .then(data => {
            // Messages Container
            let messagesContainer = document.getElementById('chatWindow');
            messagesContainer.innerHTML = ''; 

            data.messages.forEach(message => {
                let messageDiv = document.createElement('div');
                messageDiv.className = 'flex items-start gap-4 p-4 bg-white rounded-lg border border-blue-50 hover:border-blue-100 mb-3 shadow-xs hover:shadow-sm transition-all';
                messageDiv.innerHTML = `
                    <div class="flex-shrink-0">
                        <div class="w-9 h-9 bg-gradient-to-br from-blue-600 to-blue-400 rounded-full flex items-center justify-center text-white font-medium text-sm shadow-sm">
                            ${message.user.slice(0, 1)}
                        </div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-baseline justify-between mb-1.5">
                            <div class="flex items-center gap-2">
                                <span class="text-sm font-semibold text-blue-900">${message.user}</span>
                                <span class="text-xs text-blue-500">•</span>
                                <span class="text-xs text-blue-500">${new Date(message.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</span>
                            </div>
                        </div>
                        <div class="text-blue-900 text-sm leading-relaxed whitespace-pre-wrap">
                            ${message.content}
                        </div>
                        ${message.link ? `
                        <div class="mt-2.5">
                            <a href="${message.link}" target="_blank" class="inline-flex items-center text-blue-600 hover:text-blue-800 text-sm font-medium group">
                                <svg class="w-4 h-4 mr-2 text-blue-400 group-hover:text-blue-600 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                                </svg>
                                <span class="border-b border-transparent group-hover:border-blue-600">${message.link}</span>
                            </a>
                        </div>
                        ` : ''}
                    </div>
                `;
                messagesContainer.appendChild(messageDiv);
            });

            // Links Container
            let linksContainer = document.getElementById('linksWindow');
            linksContainer.innerHTML = '';

            data.links.forEach(link => {
                let linkDiv = document.createElement('div');
                linkDiv.className = 'flex items-center gap-4 p-3.5 bg-white rounded-lg border border-blue-50 hover:border-blue-100 mb-2 shadow-xs hover:shadow-sm transition-all';
                linkDiv.innerHTML = `
                    <div class="flex-shrink-0">
                        <div class="w-9 h-9 bg-blue-50 rounded-lg flex items-center justify-center text-blue-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                            </svg>
                        </div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-baseline gap-2 mb-1">
                            <span class="text-xs font-medium text-blue-700">${link.user}</span>
                            <span class="text-xs text-blue-400">${new Date(link.timestamp).toLocaleDateString()}</span>
                        </div>
                        <a href="${link.link}" target="_blank" class="text-sm text-blue-900 hover:text-blue-700 font-medium truncate">
                            ${link.text || link.link}
                        </a>
                    </div>
                `;
                linksContainer.appendChild(linkDiv);
            });

            // Empty State
            if(data.messages.length === 0 && data.links.length === 0) {
                messagesContainer.innerHTML = `
                    <div class="text-center py-12">
                        <div class="mx-auto mb-6 w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center">
                            <svg class="w-10 h-10 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <h3 class="text-lg font-semibold text-blue-900 mb-2">No matching items found</h3>
                        <p class="text-blue-600 text-sm">Try adjusting your filters or search terms</p>
                    </div>
                `;
            }
        })
        .catch(error => console.error('Error fetching data:', error));

    // Modal close
    document.getElementById('filterModal').classList.add('hidden');
};


// Delete all messages of user 

document.addEventListener('DOMContentLoaded', function () {
    const deleteMessagesButton = document.getElementById('deleteMessagesButton');
    const deleteMessagesModal = document.getElementById('deleteMessagesModal');
    const confirmDeleteButton = document.getElementById('confirmDeleteButton');
    const cancelDeleteButton = document.getElementById('cancelDeleteButton');
    const passwordInput = document.getElementById('passwordInput');
    
    const orgId = "{{channel.organization.id}}"; 
    const channelId = "{{channel.id}}"; 

    // Open Modal
    deleteMessagesButton.onclick = function () {
        deleteMessagesModal.classList.remove('hidden');
    };

    // Close Modal
    cancelDeleteButton.onclick = function () {
        deleteMessagesModal.classList.add('hidden');
        passwordInput.value = ''; // Clear input field
    };

    // AJAX Request to Delete Messages
    confirmDeleteButton.onclick = function () {
        const password = passwordInput.value;

        if (!password) {
            alert('Please enter your password!');
            return;
        }

        fetch(`/channels/api/delete-messages/${orgId}/${channelId}/`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken') // Ensure CSRF token is included
            },
            body: JSON.stringify({ password: password })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert(data.message);
                deleteMessagesModal.classList.add('hidden');
                passwordInput.value = '';

                // Remove messages from chat window
                const chatWindow = document.getElementById('chatWindow');
                if (chatWindow) {
                    chatWindow.innerHTML = ''; // Clear messages
                }
            } else {
                alert(data.message);
            }
        })
        .catch(error => console.error('Error:', error));
    };

    // Helper Function to Get CSRF Token
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
});

// show 3 dot menu

document.addEventListener('click', function (event) {
    if (event.target.classList.contains('menu-button')) {
        // Toggle menu options visibility
        const menu = event.target.nextElementSibling;
        menu.classList.toggle('hidden');
    } else {
        // Close all open menus if clicked outside
        document.querySelectorAll('.menu-options').forEach(menu => {
            menu.classList.add('hidden');
        });
    }
});



// Edit message 
document.addEventListener('DOMContentLoaded', function () {
    let currentMessageId = null;
    let currentMessageElement = null;

    // When the edit button is clicked, set up the modal
    const editButtons = document.querySelectorAll('.edit-button');
    editButtons.forEach(button => {
        button.addEventListener('click', function () {
            currentMessageId = this.dataset.messageId;
            currentMessageElement = this.closest('.flex.items-center'); // The element that contains the message
            const currentContent = this.dataset.currentContent;
            document.getElementById('editMessageContent').value = currentContent; // Populate the textarea with current message content
        });
    });

    // When the save button is clicked, send AJAX request to update the message
    document.getElementById('saveEditButton').addEventListener('click', function () {
        const newContent = document.getElementById('editMessageContent').value.trim(); // Remove leading/trailing spaces
        if (!newContent) {
            alert("Message content cannot be empty or just spaces.");
            return;
        }

        // Get the CSRF token from the page
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        const orgId = "{{ channel.organization.id }}";
        const channelId = "{{ channel.id }}";

        // Send AJAX request to update the message
        fetch(`/channels/channels/edit_message/${orgId}/${channelId}/${currentMessageId}/`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrfToken
            },
            body: JSON.stringify({
                content: newContent
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Update the message content in the DOM immediately for the user
                currentMessageElement.querySelector('.message-content').textContent = newContent;
                $('#editMessageModal').modal('hide'); // Hide the modal after successful edit
            } else {
                alert(data.error || 'Failed to update the message.');
            }
        })
        .catch(error => {
           
        showNotification('Message updated successfully. Please refresh the page for new changes.', 'Refresh', window.location.href);
        });
    });
});

// Edit the link

document.addEventListener('DOMContentLoaded', function() {
    // When the edit button is clicked, open the modal and populate fields
    const editLinkButtons = document.querySelectorAll('.edit-link-button');
    editLinkButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Get link data from the button's data attributes
            const linkId = this.dataset.linkId;
            const currentText = this.dataset.currentText;
            const currentLink = this.dataset.currentLink;

            // Populate the modal's input fields with the existing data
            document.getElementById('editLinkText').value = currentText;
            document.getElementById('editLinkUrl').value = currentLink;

            // Update the modal's save button with the correct link ID
            const saveButton = document.getElementById('saveEditLinkButton');
            saveButton.dataset.linkId = linkId;
        });
    });

    // When the save button is clicked, send AJAX request to update the link
    document.getElementById('saveEditLinkButton').addEventListener('click', function() {
        const newText = document.getElementById('editLinkText').value.trim();
        const newLink = document.getElementById('editLinkUrl').value.trim();

        // Validate inputs
        if (!newText || !newLink) {
            alert("Both link text and URL are required.");
            return;
        }

        // Get the CSRF token from the page
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        const linkId = this.dataset.linkId;
        const orgId = "{{ channel.organization.id }}";
        const channelId = "{{ channel.id }}";

        // Send AJAX request to update the link
        fetch(`/channels/channels/edit_link/${orgId}/${channelId}/${linkId}/`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrfToken
            },
            body: JSON.stringify({
                text: newText,
                link: newLink
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Update the link content in the DOM immediately for the user
                const linkElement = document.querySelector(`.link[data-link-id="${linkId}"]`);
                linkElement.querySelector('.link-text').textContent = newText;
                linkElement.querySelector('.link-url').textContent = newLink;

                // Hide the modal after successful update
                $('#editLinkModal').modal('hide');
            } else {
                alert(data.error || 'Failed to update the link.');
            }
        })
        .catch(error => {
            showNotification('Link updated successfully. Please refresh the page for new changes.', 'Refresh', window.location.href);
        });
    });
});


// CHANNEL STATS

document.addEventListener("DOMContentLoaded", function () {
    const showStatsButton = document.getElementById("showStatsButton");

    const orgId = "{{channel.organization.id}}";  
    const channelId = "{{channel.id}}";  

    // Show Stats Modal
    showStatsButton.addEventListener("click", async () => {
        try {
            // Fetch data via AJAX
            const response = await fetch(`/channels/channel-data/${orgId}/${channelId}/`);
            if (!response.ok) throw new Error("Failed to fetch data");
            const data = await response.json();

            // Render both Pie and Bar charts
            renderPieChart(data);
            renderBarChart(data);
        } catch (error) {
            console.error("Error fetching stats:", error);
        }
    });

    // Function to render Pie Chart
    function renderPieChart(data) {
        const ctx = document.getElementById("chartContainer").getContext("2d");

        // Destroy previous chart if it exists
        if (window.pieChart) {
            window.pieChart.destroy();
        }

        window.pieChart = new Chart(ctx, {
            type: "pie",
            data: {
                labels: ["Messages", "Links"],
                datasets: [
                    {
                        label: "Memory Usage (KB)",
                        data: [
                            data.total_message_memory / 1024,  // Convert bytes to KB
                            data.total_links_memory_combined / 1024,   // Convert bytes to KB
                        ],
                        backgroundColor: ["#007bff", "#28a745"],
                    },
                ],
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: "top",
                    },
                    tooltip: {
                        callbacks: {
                            label: (tooltipItem) => {
                                return `${tooltipItem.label}: ${tooltipItem.raw.toFixed(2)} KB`;
                            },
                        },
                    },
                },
            },
        });
    }

    // Function to render Bar Chart
    function renderBarChart(data) {
        const ctx = document.getElementById("chartContainer").getContext("2d");

        // Destroy previous chart if it exists
        if (window.barChart) {
            window.barChart.destroy();
        }

        window.barChart = new Chart(ctx, {
            type: "bar",
            data: {
                labels: ["Text Memory", "Audio Memory", "Video Memory", "Links Text Memory", "Links URL Memory"],
                datasets: [
                    {
                        label: "Memory Usage (KB)",
                        data: [
                            data.total_text_memory / 1024,
                            data.total_audio_memory / 1024,
                            data.total_video_memory / 1024,
                            data.total_links_text_memory / 1024,
                            data.total_links_memory / 1024,
                        ],
                        backgroundColor: ["#007bff", "#28a745", "#ffc107", "#17a2b8", "#e83e8c"],
                    },
                ],
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: "top",
                    },
                    tooltip: {
                        callbacks: {
                            label: (tooltipItem) => {
                                return `${tooltipItem.label}: ${tooltipItem.raw.toFixed(2)} KB`;
                            },
                        },
                    },
                },
            },
        });
    }
});


// FILTER BY USER 

// FILTER BY USER 

document.addEventListener("DOMContentLoaded", function () {
    const orgId = "{{ channel.organization.id }}";
    const channelId = "{{ channel.id }}";

    // Populate the user list
    async function fetchUsers() {
        console.log("Fetching users...");  // Added log to check if this is being triggered
        try {
            const response = await fetch(`/channels/fetch-users/${orgId}/${channelId}/`);
            const data = await response.json();

            const userList = document.getElementById("userListt");
            userList.innerHTML = ""; // Clear previous list

            data.users.forEach((user) => {
                const listItem = document.createElement("li");
                listItem.className =
                    "list-group-item d-flex justify-content-between align-items-center cursor-pointer";
                listItem.textContent = user.username;
                listItem.dataset.userId = user.id;
                listItem.addEventListener("click", () => filterMessages(user.id));
                userList.appendChild(listItem);
            });
        } catch (error) {
            console.error("Error fetching users:", error);
        }
    }

    // Filter messages by user
    async function filterMessages(userId) {
        console.log(`Filtering by user: ${userId}`);  // Added log to check if this is being triggered
        try {
            const response = await fetch(
                `/channels/filter-by-user/${orgId}/${channelId}/${userId}/`
            );
            const data = await response.json();

            const chatWindow = document.getElementById("chatWindow");
            chatWindow.innerHTML = ""; // Clear existing messages and links

            // Display filtered messages
            data.messages.forEach((message) => {
                const messageDiv = document.createElement("div");
                messageDiv.className = "flex items-start gap-4 p-4 bg-white rounded-xl shadow-xs border border-blue-50 hover:border-blue-100 mb-3 transition-all";
                messageDiv.innerHTML = `
                    <div class="flex-shrink-0">
                        <div class="w-9 h-9 bg-gradient-to-br from-blue-600 to-blue-400 rounded-full flex items-center justify-center text-white font-medium text-sm">
                            ${message.user.slice(0, 1)}
                        </div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-baseline gap-2 mb-1.5">
                            <span class="text-sm font-semibold text-blue-900">${message.user}</span>
                            <span class="text-xs text-blue-400">${new Date(message.timestamp).toLocaleTimeString()}</span>
                        </div>
                        <div class="text-blue-800 text-sm leading-relaxed whitespace-pre-wrap">
                            ${message.content}
                        </div>
                    </div>
                `;
                chatWindow.appendChild(messageDiv);
            });

            // Display filtered links
            data.links.forEach((link) => {
                const linkDiv = document.createElement("div");
                linkDiv.className = "flex items-center gap-4 p-4 bg-white rounded-xl shadow-xs border border-blue-50 hover:border-blue-100 mb-3 transition-all";
                linkDiv.innerHTML = `
                    <div class="flex-shrink-0">
                        <div class="w-9 h-9 bg-blue-50 rounded-lg flex items-center justify-center text-blue-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                            </svg>
                        </div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-baseline gap-2 mb-1">
                            <span class="text-xs font-medium text-blue-700">${link.user}</span>
                            <span class="text-xs text-blue-400">${new Date(link.timestamp).toLocaleDateString()}</span>
                        </div>
                        <a href="${link.link}" target="_blank" class="text-sm text-blue-900 hover:text-blue-700 font-medium truncate">
                            ${link.text || link.link}
                        </a>
                    </div>
                `;
                chatWindow.appendChild(linkDiv);
            });

            // Empty State
            if(data.messages.length === 0 && data.links.length === 0) {
                chatWindow.innerHTML = `
                    <div class="text-center py-12">
                        <div class="mx-auto mb-6 w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center">
                            <svg class="w-10 h-10 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <h3 class="text-lg font-semibold text-blue-900 mb-2">No messages found</h3>
                        <p class="text-blue-600 text-sm">This user hasn't posted any messages or links</p>
                    </div>
                `;
            }




            // Close the modal
            const filterByUserModal = bootstrap.Modal.getInstance(
                document.getElementById("filterByUserModal")
            );
            filterByUserModal.hide();
        } catch (error) {
            console.error("Error filtering messages:", error);
        }
    }

    // Fetch users when the modal is shown
    const filterByUserModal = document.getElementById("filterByUserModal");
    filterByUserModal.addEventListener("show.bs.modal", function () {
        console.log("Modal is opening..."); // Log to check if the modal is triggering the fetch
        setTimeout(fetchUsers, 100); // Delay to ensure modal fully loads
    });
});


// DELETE CHANNEL DATA (ONLY ADMIN)





// DISPLAY NETWORK STATS
function displayNetworkStatus() {
  // Simulated data for demonstration purposes (feel free to replace this with actual data from API)
  const simulatedData = {
    signal_strength: Math.random() * 100, // Percentage
    upload_speed: (Math.random() * 100).toFixed(2), // Mbps
    download_speed: (Math.random() * 150).toFixed(2), // Mbps
    ping: Math.floor(Math.random() * 300), // ms
    connection_type: ["Wi-Fi", "4G",][Math.floor(Math.random() * 4)],
    connection_status: ["Online", "Reconnecting", "Offline"][Math.floor(Math.random() * 3)],
    packet_loss: (Math.random() * 5).toFixed(2), // Percentage
    network_load: (Math.random() * 50).toFixed(2), // Mbps
    jitter: Math.floor(Math.random() * 50), // ms
    network_provider: "Simulated ISP",
    server_response_time: Math.floor(Math.random() * 500), // ms
    bandwidth_usage: {
      current: (Math.random() * 200).toFixed(2), // Mbps
      average: (Math.random() * 100).toFixed(2), // Mbps
    },
    activity_log: [
      { event: "Reconnected", timestamp: Date.now() - 60000 },
      { event: "Packet loss detected", timestamp: Date.now() - 120000 },
    ],
    diagnostic_suggestions: [
      "Check router and cables for loose connections.",
      "Consider upgrading to a higher speed plan for better performance.",
      "Try restarting the router and modem.",
    ],
  };

  // Update general information
  document.getElementById("connectionType").innerText = `Connection Type: ${simulatedData.connection_type}`;
  document.getElementById("connectionStatus").innerText = `Connection Status: ${simulatedData.connection_status}`;
  document.getElementById("networkProvider").innerText = `Network Provider: ${simulatedData.network_provider}`;

  // Signal Strength (Progress Bar)
  const signalStrengthBar = document.getElementById("signalStrengthBar");
  signalStrengthBar.style.width = `${simulatedData.signal_strength}%`;
  signalStrengthBar.setAttribute("aria-valuenow", simulatedData.signal_strength);
  document.getElementById("signalStrengthText").innerText = `${simulatedData.signal_strength.toFixed(2)}%`;

  // Render network speed chart (Line Chart)
  const ctxSpeed = document.getElementById("networkSpeedChart").getContext("2d");
  new Chart(ctxSpeed, {
    type: "line",
    data: {
      labels: ["Upload", "Download"],
      datasets: [
        {
          label: "Speed (Mbps)",
          data: [simulatedData.upload_speed, simulatedData.download_speed],
          borderColor: ["blue", "green"],
          backgroundColor: ["blue", "green"],
          fill: false,
        },
      ],
    },
    options: {
      responsive: true,
      plugins: {
        legend: { display: true },
      },
    },
  });

  // Update latency, jitter, and packet loss (Text & Progress Bars)
  document.getElementById("pingValue").innerText = `${simulatedData.ping} ms`;
  document.getElementById("jitterValue").innerText = `${simulatedData.jitter} ms`;
  document.getElementById("packetLoss").innerText = `${simulatedData.packet_loss}%`;

  // Render network load chart (Bar Chart)
  const ctxLoad = document.getElementById("networkLoadChart").getContext("2d");
  new Chart(ctxLoad, {
    type: "bar",
    data: {
      labels: ["Network Load"],
      datasets: [
        {
          label: "Network Load (Mbps)",
          data: [simulatedData.network_load],
          backgroundColor: "orange",
        },
      ],
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false } },
    },
  });

  // Render bandwidth usage (Pie Chart)
  const ctxUsage = document.getElementById("bandwidthUsageChart").getContext("2d");
  new Chart(ctxUsage, {
    type: "pie",
    data: {
      labels: ["Current Usage", "Average Usage"],
      datasets: [
        {
          label: "Bandwidth Usage",
          data: [simulatedData.bandwidth_usage.current, simulatedData.bandwidth_usage.average],
          backgroundColor: ["#28a745", "#007bff"],
        },
      ],
    },
    options: {
      responsive: true,
      plugins: { legend: { position: "top" } },
    },
  });

  // Render server response time (Mini Graph)
  const ctxServerResponse = document.getElementById("serverResponseChart").getContext("2d");
  new Chart(ctxServerResponse, {
    type: "line",
    data: {
      labels: ["Response Time"],
      datasets: [
        {
          label: "Server Response (ms)",
          data: [simulatedData.server_response_time],
          borderColor: ["purple"],
          backgroundColor: ["purple"],
          fill: false,
        },
      ],
    },
    options: {
      responsive: true,
      plugins: {
        legend: { display: false },
      },
    },
  });

  // Update activity log
  const activityLog = document.getElementById("activityLog");
  activityLog.innerHTML = ""; // Clear previous logs
  simulatedData.activity_log.forEach((log) => {
    const logItem = document.createElement("li");
    logItem.className = "list-group-item";
    logItem.innerText = `${log.event} - ${new Date(log.timestamp).toLocaleString()}`;
    activityLog.appendChild(logItem);
  });

  // Display diagnostic suggestions
  const diagnosticSuggestions = document.getElementById("diagnosticSuggestions");
  diagnosticSuggestions.innerHTML = "<strong>Diagnostic Suggestions:</strong>";
  simulatedData.diagnostic_suggestions.forEach((suggestion) => {
    const suggestionItem = document.createElement("p");
    suggestionItem.innerText = suggestion;
    diagnosticSuggestions.appendChild(suggestionItem);
  });
}





// BAN USERS (ADMIN ONLY)

document.addEventListener("DOMContentLoaded", function () {
    const orgId = "{{ channel.organization.id }}";
    const channelId = "{{ channel.id }}";

    let selectedUserId = null;

    // Function to fetch users and populate the user list
    async function fetchUsers() {
        console.log("Fetching users...");
        try {
            const response = await fetch(`/channels/fetch-users/${orgId}/${channelId}/`);
            const data = await response.json();
            console.log("Users fetched:", data);

            const userList = document.getElementById("userListtt");
            if (userList) {
                userList.innerHTML = ""; // Clear the list before adding new items

                if (data && data.users) {
                    data.users.forEach((user) => {
                        const listItem = document.createElement("li");

                        listItem.className = 
    "flex items-center justify-between px-4 py-3 mb-2 text-sm font-medium text-gray-700 bg-white rounded-lg shadow-sm hover:bg-gray-50 transition-all duration-200 cursor-pointer border border-gray-200 hover:border-gray-300 group"; // main item styling
listItem.textContent = user.username;
listItem.dataset.userId = user.id;

// Optional: If you need to add user avatars or status indicators later:
const userIndicator = document.createElement('div');
userIndicator.className = "ml-3 w-2.5 h-2.5 bg-green-400 rounded-full border-2 border-white shadow-sm group-hover:border-gray-50";
listItem.appendChild(userIndicator);
                        listItem.addEventListener("click", () => {
                            selectedUserId = user.id;
                            openCustomBanModal(user.id, user.username);
                        });

                        userList.appendChild(listItem);
                    });
                } else {
                    console.error("No users found in response.");
                }
            } else {
                console.error("User list element not found.");
            }
        } catch (error) {
            console.error("Error fetching users:", error);
        }
    }

    // Open custom ban modal
    function openCustomBanModal(userId, userName) {
        selectedUserId = userId;

        const customBanModal = document.getElementById("customBanModal");
        const customBanModalLabel = document.getElementById("customBanModalLabel");

        if (customBanModal && customBanModalLabel) {
            customBanModalLabel.textContent = `Ban ${userName}`;
            customBanModal.style.display = "block";
        } else {
            console.error("Custom ban modal or label not found.");
        }
    }

    // Close custom ban modal
    function closeCustomBanModal() {
        const customBanModal = document.getElementById("customBanModal");
        if (customBanModal) {
            customBanModal.style.display = "none";
        } else {
            console.error("Custom ban modal not found.");
        }
    }

    // Attach event to close button
    const closeBanButton = document.getElementById("closeCustomBanModal");
    if (closeBanButton) {
        closeBanButton.addEventListener("click", closeCustomBanModal);
    } else {
        console.error("Close button for custom ban modal not found.");
    }

    // Handle ban submission
    const submitBanButton = document.getElementById("customSubmitBan");
    if (submitBanButton) {
        submitBanButton.addEventListener("click", function () {
            const banDuration = document.getElementById("customBanDuration").value;
            const banReason = document.getElementById("customBanReason").value;

            if (!selectedUserId || !banDuration || !banReason) {
                alert("Please select a user, ban duration, and reason.");
                return;
            }

            fetch(`/channels/ban-user/${orgId}/${channelId}/${selectedUserId}/`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRFToken": "{{ csrf_token }}",
                },
                body: JSON.stringify({
                    duration: banDuration,
                    reason: banReason,
                }),
            })
                .then(response => response.json())
                .then(data => {
                    if (data.status === "success") {
                        alert("User banned successfully!");
                        closeCustomBanModal();
                    } else {
                        showNotification("User banned successfully and wont be able to access this group again")
                    }
                })
                .catch(error => {
                    console.error("Error banning user:", error);
                    alert("An error occurred while banning the user.");
                });
        });
    } else {
        console.error("Submit ban button not found.");
    }

    // Initial fetch of users
    fetchUsers();
});



// GIVE ACCESS OF THIS CHANNEL TO ANOTHER ORGANIZATION
document.addEventListener("DOMContentLoaded", function () {
    // Modal show event
    const shareModal = document.getElementById('shareModal');
    const organizationList = document.getElementById('organizationList');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const grantAccessBtn = document.getElementById('grantAccessBtn');

    let selectedOrganizationId = null;

    // Fetch organizations when modal is shown
    shareModal.addEventListener('show.bs.modal', function () {
      // Show the loading spinner while fetching data
      loadingSpinner.style.display = 'block';
      organizationList.innerHTML = '';  // Clear previous list
      grantAccessBtn.disabled = true;   // Disable the button initially

      const orgId = "{{ channel.organization.id }}"; // Channel's organization ID
      const channelId = "{{ channel.id }}";          // Channel ID

      // Fetch organizations where the user is an admin
      fetch(`/channels/fetch-admin-organizations/${orgId}/${channelId}/`)  // Correct URL with template variable
        .then(response => response.json())
        .then(data => {
          loadingSpinner.style.display = 'none';  // Hide the loading spinner

          if (data.organizations.length > 0) {
            data.organizations.forEach(org => {
              const listItem = document.createElement('li');

             listItem.className = 
    "flex items-center justify-between px-4 py-3 mb-2 text-sm font-medium text-gray-700 bg-white rounded-lg shadow-sm hover:bg-gray-50 transition-all duration-200 cursor-pointer border border-gray-200 hover:border-gray-300 group truncate min-w-0";
listItem.textContent = `${org.name} - ${org.description}`;
listItem.dataset.orgId = org.id;

// Optional: If you want to add hierarchy to name/description
listItem.innerHTML = `
    <div class="flex-1 truncate">
        <span class="font-semibold text-gray-800">${org.name}</span>
        <span class="font-normal text-gray-500"> - ${org.description}</span>
    </div>
    <svg class="w-5 h-5 ml-2 text-gray-400 group-hover:text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
    </svg>
`;

              // Disable organizations that already have access to the channel
              if (org.hasAccess) {
                listItem.classList.add('disabled');
                listItem.style.pointerEvents = 'none'; // Prevent clicks
              }

              listItem.addEventListener('click', function () {
                // Handle the organization selection
                if (!listItem.classList.contains('disabled')) {
                  selectedOrganizationId = org.id;
                  grantAccessBtn.disabled = false;
                }
              });

              organizationList.appendChild(listItem);
            });
          } else {
            const noDataItem = document.createElement('li');
            noDataItem.classList.add('list-group-item');
            noDataItem.textContent = 'No organizations found who dont have access to this channel.';
            organizationList.appendChild(noDataItem);
          }
        })
        .catch(err => {
          console.error("Error fetching organizations:", err);
          loadingSpinner.style.display = 'none';
          const errorItem = document.createElement('li');
          errorItem.classList.add('list-group-item');
          errorItem.textContent = 'Failed to load organizations.';
          organizationList.appendChild(errorItem);
        });
    });

    // Grant access button click handler
    grantAccessBtn.addEventListener('click', function () {
      if (selectedOrganizationId) {
        const orgId = "{{ channel.organization.id }}"; // Channel's organization ID
        const channelId = "{{ channel.id }}"; // Channel ID
        const grantedToOrgId = selectedOrganizationId; // Selected organization ID to grant access

        // Grant access using URL parameters directly
        fetch(`/channels/grant-channel-access/${orgId}/${channelId}/${grantedToOrgId}/`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          }
        })
        .then(response => response.json())
        .then(data => {
          alert(data.message || 'Access granted successfully!');
          // Close the modal after success
          let modal = bootstrap.Modal.getInstance(shareModal);
          modal.hide();
        })
        .catch(error => {
          console.error('Error granting access:', error);
          alert('Failed to grant access.');
        });
      }
    });
  });


// SET RETENTION POLICY

document.addEventListener('DOMContentLoaded', function() {
    const customRetentionRadio = document.getElementById('customRetention');
    const customDaysInput = document.getElementById('customDays');

    // Show the custom input field when "Custom Period" is selected
    customRetentionRadio.addEventListener('change', function() {
      if (customRetentionRadio.checked) {
        customDaysInput.style.display = 'block'; // Show input
      }
    });

    // Hide the custom input field if another period is selected
    document.querySelectorAll('input[name="retentionPeriod"]').forEach(radio => {
      radio.addEventListener('change', function() {
        if (radio.value !== '0') {
          customDaysInput.style.display = 'none'; // Hide input
        }
      });
    });

    // Save the retention policy when the button is clicked
    document.getElementById('saveRetentionPolicy').addEventListener('click', function() {
      const retentionPeriod = document.querySelector('input[name="retentionPeriod"]:checked');
      let customDays = customDaysInput.value;

      if (!retentionPeriod) {
        alert('Please select a retention period.');
        return;
      }

      if (retentionPeriod.value === '0' && !customDays) {
        alert('Please enter a custom number of days.');
        return;
      }

      const data = {
        retention_period: retentionPeriod.value,
        custom_days: customDays ? customDays : null
      };

      const orgId="{{channel.organization.id}}";
      const channelId="{{channel.id}}";

      // Send data to the backend (Assuming a POST request to '/set_retention_policy/')
      fetch(`/channels/set_retention_policy/${orgId}/${channelId}/`, {// Replace with the actual org_id and channel_id
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
      })
      .then(response => response.json())
      .then(data => {
        alert(data.success || data.error);
        if (data.success) {
          // Close the modal if successful
          var myModal = new bootstrap.Modal(document.getElementById('retentionPolicyModal'));
          myModal.hide();
        }
      })
      .catch(error => {
        alert('An error occurred. Please try again later.');
        console.error(error);
      });
    });
  });



//   PIN MESSAGES


function getCSRFToken() {
    const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
    return csrfToken;
}

function togglePinMessage(orgId, channelId, messageId) {
    fetch(`/channels/pin-message/${orgId}/${channelId}/${messageId}/`, {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": getCSRFToken(), // Use the CSRF token here
        },
    })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const messageElement = document.getElementById(`message-${messageId}`);
                const chatWindow = document.getElementById("chatWindow");

                if (data.is_pinned) {
                    // Highlight the pinned message
                    messageElement.classList.add("bg-yellow-100");

                    // Move the pinned message to the top
                    chatWindow.prepend(messageElement);
                } else {
                    // Remove the highlight
                    messageElement.classList.remove("bg-yellow-100");

                    // Append the unpinned message back to its original position
                    const originalMessages = [...chatWindow.querySelectorAll(".flex.items-center")].filter(
                        el => el !== messageElement
                    );

                    const lastMessage = originalMessages[originalMessages.length - 1];
                    chatWindow.insertBefore(messageElement, lastMessage.nextSibling);
                }
            } else {
                alert(data.message || "Failed to pin/unpin the message.");
            }
        })
        .catch(error => {
            showNotification('Operation Sucessfull please refresh the page to reflect the changes', 'Refresh', window.location.href);
        });
}




// STAR/UNSTAR THE MESSAGE


// STAR/UNSTAR THE MESSAGE
$(document).on('click', '.star-icon', function () {
    var button = $(this); // Reference to the clicked button
    var messageId = button.data('message-id');
    var orgId = button.data('org-id');
    var channelId = button.data('channel-id');

    // Send AJAX request to toggle star status
    $.ajax({
        url: '/channels/toggle_star_message/' + orgId + '/' + channelId + '/' + messageId + '/',
        type: 'GET',
        success: function (response) {
            if (response.status === 'success') {
                // Toggle the star icon's "filled" class based on the updated is_starred state
                if (response.is_starred) {
                    button.addClass('filled'); // Add filled class to show it's starred
                } else {
                    button.removeClass('filled'); // Remove filled class to unstar it
                }

                // Update the star status text and style dynamically
                var starStatus = button.siblings('.star-status');
                if (response.is_starred) {
                    starStatus.text('Starred').removeClass('unstarred').addClass('starred');
                } else {
                    starStatus.text('Unstarred').removeClass('starred').addClass('unstarred');
                }

                // Show a notification or success message (optional)
                showNotification(
                    response.is_starred ? 'Message has been starred!' : 'Message has been unstarred!',
                    'Dismiss'
                );
            } else {
                // Optional: Handle errors if needed
                console.error('Failed to update the star status:', response.message);
            }
        },
        error: function (xhr, status, error) {
            console.error('An error occurred:', error);
        }
    });
});





// HANDLE REPLIES

document.addEventListener("DOMContentLoaded", function () {
    // Use event delegation to handle the reply button clicks
    document.body.addEventListener("click", function (event) {
        if (event.target && event.target.classList.contains("reply-btn")) {
            const messageId = event.target.dataset.messageId;
            const orgId = event.target.dataset.orgId;
            const channelId = event.target.dataset.channelId;

            // Display the reply input field dynamically
            const replyInputHtml = `
<div class="mt-2 flex gap-2 [&_.reply-send-btn]:bg-blue-500 [&_.reply-send-btn:hover]:bg-blue-600 [&_.reply-send-btn]:text-white">
    <input type="text" 
        id="reply-input-${messageId}"
        class="flex-1 text-sm font-medium text-gray-800 placeholder-gray-400 border border-gray-300 rounded-lg px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-blue-500 shadow-sm"
        placeholder="Type your reply..." />
    <button 
        class="reply-send-btn px-4 py-2.5 font-semibold text-sm rounded-lg border border-blue-600 shadow-sm transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 inline-flex items-center justify-center"
        data-message-id="${messageId}" 
        data-org-id="${orgId}" 
        data-channel-id="${channelId}">
        <span>Send</span>
        <svg class="w-4 h-4 ml-2 -mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
        </svg>
    </button>
</div>`;
            event.target.insertAdjacentHTML("afterend", replyInputHtml);

            // Handle sending the reply
            document.querySelector(`#reply-input-${messageId}`).nextElementSibling.addEventListener("click", function () {
                const content = document.querySelector(`#reply-input-${messageId}`).value.trim();
                if (!content) return alert("Reply content cannot be empty!");

                // Send AJAX POST request
                fetch(`/channels/reply/${orgId}/${channelId}/${messageId}/`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "X-CSRFToken": getCSRFToken(), // CSRF token to protect against CSRF attacks
                    },
                    body: JSON.stringify({ content: content }),
                })
                    .then((response) => response.json())
                    .then((data) => {
                        if (data.error) {
                            alert(data.error);
                        } else {
                            // Append the reply to the chat window
                            const replyHtml = `
                                <div class="flex items-center ml-6 mt-2 border-l-4 border-blue-400 pl-2">
                                    <div class="w-8 h-8 flex-shrink-0 bg-blue-400 rounded-full flex items-center justify-center text-white font-bold text-xs mr-3">
                                        ${data.reply.user[0]}
                                    </div>
                                    <div>
                                        <span class="font-semibold text-blue-600">${data.reply.user}</span>
                                        <span class="text-gray-700">${data.reply.content}</span>
                                        <span class="text-xs text-gray-500">${data.reply.timestamp}</span>
                                    </div>
                                </div>`;                     document.querySelector(`#reply-input-${messageId}`).closest(".flex").insertAdjacentHTML("afterend", replyHtml);
                            document.querySelector(`#reply-input-${messageId}`).remove(); // Remove the input field after sending
                        }
                    })
                    .catch((error) => {
                        console.error("Error:", error);
                        alert("An error occurred. Please try again.");
                    });
            });
        }
    });

    // Function to get CSRF token (for Django)
    function getCSRFToken() {
        return document.querySelector('[name=csrfmiddlewaretoken]').value;
    }
});



// SET MESSAGE AS RECURRING

document.addEventListener("DOMContentLoaded", () => {
    const modal = document.getElementById("recurrenceModal");
    const closeModalButton = document.getElementById("closeModalButton");
    const recurrenceForm = document.getElementById("recurrenceForm");
    const recurrenceType = document.getElementById("recurrenceType");
    const recurrenceDaysContainer = document.getElementById("recurrenceDaysContainer");

    let orgId, channelId, messageId; // Variables to hold IDs dynamically

    // Show modal and capture IDs dynamically
    document.addEventListener("click", (event) => {
        if (event.target && event.target.classList.contains("edt-button")) {
            orgId = event.target.getAttribute("data-org-id");
            channelId = event.target.getAttribute("data-channel-id");
            messageId = event.target.getAttribute("data-message-id");

            modal.classList.remove("hidden");
        }
    });

    // Hide modal
    closeModalButton.addEventListener("click", () => {
        modal.classList.add("hidden");
    });

    // Show/Hide "Select Days" based on recurrence type
    recurrenceType.addEventListener("change", () => {
        if (recurrenceType.value === "weekly" || recurrenceType.value === "custom") {
            recurrenceDaysContainer.style.display = "block";
        } else {
            recurrenceDaysContainer.style.display = "none";
        }
    });

    // Handle form submission
    recurrenceForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        // Collect form data
        const formData = new FormData(recurrenceForm);
        const recurrenceTypeValue = formData.get("recurrence_type");
        const recurrenceDays = formData.getAll("recurrence_days");
        const endDate = formData.get("end_date");

        try {
            const response = await fetch(`/channels/message_recurring/${orgId}/${channelId}/${messageId}/`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    recurrence_type: recurrenceTypeValue,
                    recurrence_days: recurrenceDays,
                    end_date: endDate,
                }),
            });

            const result = await response.json();
            if (response.ok) {
                alert(result.message);
                modal.classList.add("hidden");
            } else {
                alert(result.error || "Something went wrong!");
            }
        } catch (error) {
            alert("Failed to set recurring message. Please try again later.");
        }
    });
});




// MONITOR RECURRENCE MESSAGES

$(document).ready(function() {
    // Trigger the modal when button is clicked
    $("#monitor-recurring-messages-btn").click(function() {
        var org_id = 2;  // Example, replace with actual org_id
        var channel_id = 5;  // Example, replace with actual channel_id

        $.ajax({
            url: `/channels/monitor-recurring-messages/${org_id}/${channel_id}/`,
            method: 'GET',
            success: function(data) {
                if (data.error) {
                    alert('Error: ' + data.error);
                } else {
                    // Populate pending messages table
                    var pendingMessages = data.pending_messages.map(function(message) {
    return `
        <tr class="hover:bg-gray-50 border-b border-gray-100">
            <td class="px-4 py-3 text-sm text-gray-700">${message.text}</td>
            <td class="px-4 py-3 text-sm text-gray-600">${message.start_date}</td>
            <td class="px-4 py-3 text-sm text-gray-600">${message.end_date || 'N/A'}</td>
            <td class="px-4 py-3 text-right">
                <button 
                    class="recurring-action-btn inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium transition-colors duration-150 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2"
                    data-id="${message.id}">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                    </svg>
                    <span>Prevent & Delete</span>
                </button>
            </td>
        </tr>
    `;
                    }).join('');

                    // Populate sent messages table
                    var sentMessages = data.sent_messages.map(function(record) {
    return `
        <tr class="hover:bg-gray-50 border-b border-gray-100 group">
            <td class="px-4 py-3 text-sm text-gray-700 max-w-[300px] truncate">${record.message_text}</td>
            <td class="px-4 py-3 text-sm text-gray-600">${record.sent_at}</td>
            <td class="px-4 py-3 text-sm">
                <span class="status-pill px-2 py-1 rounded-full text-xs font-medium ${record.status ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-600'}">
                    ${record.status || 'N/A'}
                </span>
            </td>
            <td class="px-4 py-3 text-right">
                <button class="sent-action-btn inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium transition-colors duration-150 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2"
                    data-id="${record.id}">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                    </svg>
                    <span>Prevent & Delete</span>
                </button>
            </td>
        </tr>
    `;
                    }).join(''); 

                    // Add data to the modal body
                    $("#pendingMessagesTable tbody").html(pendingMessages);
                    $("#sentMessagesTable tbody").html(sentMessages);

                    // Show the modal
                    $("#recurrenceMonitorModal").modal('show');
                }
            },
            error: function(error) {
                console.log('Error:', error);
            }
        });
    });

    // Handle the deletion of recurring messages
    $(document).on('click', '.delete-recurring-message', function() {
        var messageId = $(this).data('id');
        var confirmation = confirm('Are you sure you want to delete this recurring message?');

        if (confirmation) {
            $.ajax({
                url: `/channels/delete-recurring-message/${messageId}/`,
                method: 'POST',
                data: {
                    'csrfmiddlewaretoken': $('input[name="csrfmiddlewaretoken"]').val()
                },
                success: function(response) {
                    if (response.success) {
                        showNotification("Recurring message prevented successfully");
                        // Refresh the modal to reflect the change
                        $("#monitor-recurring-messages-btn").click();
                    } else {
                        alert('Error: Could not delete the message');
                    }
                },
                error: function(error) {
                    showNotification("Recurring message has been prevented successfully and will be no longer available Refresh the page to new changes",'Refresh', window.location.href);
                }
            });
        }
    });
});



// MANAGE ABUSIVE MESSAGES IN CHANNEL 

document.addEventListener("DOMContentLoaded", function () {
    const orgId = "{{channel.organization.id}}"; 
    const channelId = "{{channel.id}}"; 

    // Fetch flagged messages when the modal is opened
    document.getElementById("warnModal").addEventListener("show.bs.modal", function () {
        fetch(`/channels/fetch-flagged-messages/${orgId}/${channelId}/`)
            .then(response => response.json())
            .then(data => {
                const tableBody = document.getElementById("flaggedMessagesTable");
                tableBody.innerHTML = ""; // Clear previous entries

                if (data.messages.length > 0) {
                    data.messages.forEach((message, index) => {
                        const row = `
    <tr class="hover:bg-amber-50/50 border-b border-gray-100 group">
        <td class="px-4 py-3 text-sm text-gray-500">${index + 1}</td>
        <td class="px-4 py-3 text-sm text-gray-700 max-w-[300px] truncate">${message.message_content}</td>
        <td class="px-4 py-3 text-sm text-gray-600">${message.flagged_by}</td>
        <td class="px-4 py-3 text-sm text-gray-600">${message.flagged_at}</td>
        <td class="px-4 py-3 text-right">
            <button class="flagged-action-btn inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium transition-colors duration-150 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2"
                data-message-id="${message.id}">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                </svg>
                <span>Warn User</span>
            </button>
        </td>
    </tr>
`;
                        tableBody.insertAdjacentHTML("beforeend", row);
                    });

                    // Attach event listeners to warn buttons
                    document.querySelectorAll(".warn-button").forEach(button => {
                        button.addEventListener("click", function () {
                            const messageId = this.dataset.messageId;
                            sendWarning(messageId);
                        });
                    });
                } else {
                    tableBody.innerHTML = "<tr><td colspan='5'>No flagged messages found.</td></tr>";
                }
            })
            .catch(error => console.error("Error fetching flagged messages:", error));
    });

    // Send warning email
    function sendWarning(messageId) {
        // Show the loading spinner and message
        document.getElementById("loadingSpinner").style.display = "block";

        // Hide the table while loading
        document.getElementById("flaggedMessagesTable").style.display = "none";

        fetch(`/channels/warn-user/${messageId}/`, {
            method: "POST",
            headers: {
                "X-CSRFToken": getCSRFToken(),
                "Content-Type": "application/json",
            },
        })
            .then(response => response.json())
            .then(data => {
                // Hide the spinner after the request completes
                document.getElementById("loadingSpinner").style.display = "none";
                
                // Show the table again
                document.getElementById("flaggedMessagesTable").style.display = "table-row-group";

                if (data.success) {
                    alert("Warning email sent successfully!");
                } else {
                    alert("Failed to send warning: " + data.error);
                }
            })
            .catch(error => {
                console.error("Error sending warning:", error);

                // Hide the spinner if there was an error
                document.getElementById("loadingSpinner").style.display = "none";
                
                // Show the table again
                document.getElementById("flaggedMessagesTable").style.display = "table-row-group";
            });
    }

    // Function to get CSRF token
    function getCSRFToken() {
        return document.querySelector('[name=csrfmiddlewaretoken]').value;
    }
});



// MANAGE EVENTS(ADMIN ONLY)
// CSRF token setup for Django
const getCookie = (name) => {
    let cookieValue = null;
    if (document.cookie && document.cookie !== "") {
        const cookies = document.cookie.split("; ");
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].split("=");
            if (cookie[0] === name) {
                cookieValue = decodeURIComponent(cookie[1]);
                break;
            }
        }
    }
    return cookieValue;
};
const csrftoken = getCookie("csrftoken");

// Fetch and display existing events on page load
const orgIId = "{{ channel.organization.id }}";
const channellId = "{{ channel.id }}";

fetch(`/channels/channels/${orgIId}/save/${channellId}/`, {
    method: "GET",
    headers: {
        "Content-Type": "application/json",
        "X-CSRFToken": csrftoken,
    },
})
.then(response => response.json())
.then(data => {
    if (data.events) {
        const tableBody = document.querySelector("#eventsTable tbody");
        data.events.forEach(event => {
            const newRow = `
    <tr class="transition-all hover:bg-gray-50 even:bg-gray-50/30 group">
        <td contenteditable="true" 
            class="event-name px-4 py-3 border-b border-gray-100 text-sm font-medium text-gray-900 truncate max-w-[200px] focus:outline-none focus:ring-2 focus:ring-blue-100 focus:bg-white">
            ${event.event_name}
        </td>
        <td contenteditable="true" 
            class="event-date px-4 py-3 border-b border-gray-100 text-sm text-gray-600 whitespace-nowrap focus:outline-none focus:ring-2 focus:ring-blue-100">
            <span class="inline-flex items-center gap-2">
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                ${event.event_date}
            </span>
        </td>
        <td contenteditable="true" 
            class="event-details px-4 py-3 border-b border-gray-100 text-sm text-gray-600 max-w-[300px] truncate hover:whitespace-normal focus:whitespace-normal focus:outline-none focus:ring-2 focus:ring-blue-100">
            ${event.event_details}
        </td>
        <td contenteditable="true" 
            class="event-link px-4 py-3 border-b border-gray-100 text-sm text-blue-600 hover:text-blue-800 truncate max-w-[200px] focus:outline-none focus:ring-2 focus:ring-blue-100">
            <a href="${event.event_link}" target="_blank" class="hover:underline flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                </svg>
                ${event.event_link}
            </a>
        </td>
    </tr>`;
            tableBody.insertAdjacentHTML("beforeend", newRow);
        });
    } else {
        console.log("No events found.");
    }
})
.catch(error => console.error("Error fetching events:", error));

// Function to fetch users based on the current @ input
const fetchUsers = async () => {
    try {
        const response = await fetch(`/channels/fetch-users/${orgIId}/${channellId}/`, {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
                "X-CSRFToken": csrftoken,
            },
        });
        const data = await response.json();
        if (data.users) {
            return data.users;
        } else {
            console.error("No users found.");
            return [];
        }
    } catch (error) {
        console.error("Error fetching users:", error);
        return [];
    }
};

// Function to show the list of users
const showUserList = (users, targetElement) => {
    const userList = document.createElement("ul");
    userList.classList.add("user-list"); // You can style this in CSS
    
    users.forEach(user => {
        const userItem = document.createElement("li");
        userItem.innerText = user.username;
        userItem.addEventListener("click", () => {
            targetElement.innerText = "@" + user.username; // Insert username in the target column
            userList.remove(); // Hide the user list after selection
        });
        userList.appendChild(userItem);
    });

    targetElement.appendChild(userList);
};

// Add Event Listener for editable fields
document.querySelector("#eventsTable").addEventListener("input", async (event) => {
    const targetElement = event.target;
    if (targetElement.contentEditable === "true" && targetElement.innerText.includes("@")) {
        const atSignPosition = targetElement.innerText.indexOf("@");
        const users = await fetchUsers();
        
        // Remove previous user list if any
        const existingList = targetElement.querySelector(".user-list");
        if (existingList) {
            existingList.remove();
        }

        if (users.length > 0) {
            showUserList(users, targetElement);
        }
    }
});

// Add a new row to the table
document.getElementById("addRow").addEventListener("click", () => {
    const tableBody = document.querySelector("#eventsTable tbody");
    const newRow = `
        <tr>
            <td contenteditable="true" class="event-name"></td>
            <td contenteditable="true" class="event-date"></td>
            <td contenteditable="true" class="event-details"></td>
            <td contenteditable="true" class="event-link"></td>
        </tr>`;
    tableBody.insertAdjacentHTML("beforeend", newRow);
});

// Auto-save data on content change
document.querySelector("#eventsTable").addEventListener("input", (event) => {
    const targetRow = event.target.closest("tr");
    if (targetRow) {
        const eventName = targetRow.querySelector(".event-name").innerText.trim();
        const eventDate = targetRow.querySelector(".event-date").innerText.trim();
        const eventDetails = targetRow.querySelector(".event-details").innerText.trim();
        const eventLink = targetRow.querySelector(".event-link").innerText.trim();

        // Check if all fields are filled
        if (eventName && eventDate && eventDetails && eventLink) {
            fetch(`/channels/channels/${orgIId}/save/${channellId}/`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRFToken": csrftoken,
                },
                body: JSON.stringify({
                    event_name: eventName,
                    event_date: eventDate,
                    event_details: eventDetails,
                    event_link: eventLink,
                }),
            })
            .then((response) => response.json())
            .then((data) => {
                if (data.success) {
                    console.log("Event saved successfully:", data);
                } else {
                    console.error("Error saving event:", data.message || data.error);
                }
            })
            .catch((error) => console.error("Network error:", error));
        } else {
            console.log("All fields are required to save the event.");
        }
    }
});








// DRAG AND DROP COLOMS
document.addEventListener("DOMContentLoaded", () => {
    const table = document.querySelector("#eventsTable");

    // Add draggable attribute to each column header
    const headers = table.querySelectorAll("th");
    headers.forEach((header, index) => {
        header.setAttribute("draggable", true);
        header.setAttribute("data-index", index);

        // Handle drag start
        header.addEventListener("dragstart", (event) => {
            event.dataTransfer.setData("text/plain", index);
        });

        // Allow drop
        header.addEventListener("dragover", (event) => {
            event.preventDefault();
        });

        // Handle drop
        header.addEventListener("drop", (event) => {
            event.preventDefault();
            const draggedIndex = event.dataTransfer.getData("text/plain");
            const targetIndex = header.getAttribute("data-index");

            if (draggedIndex !== targetIndex) {
                swapColumns(draggedIndex, targetIndex);
            }
        });
    });

    // Function to swap columns
    function swapColumns(draggedIndex, targetIndex) {
        const rows = table.querySelectorAll("tr");

        rows.forEach((row) => {
            const cells = row.querySelectorAll("td, th");
            if (cells[draggedIndex] && cells[targetIndex]) {
                // Swap the dragged and target columns
                row.insertBefore(cells[draggedIndex], cells[targetIndex]);
            }
        });

        // Update header indices after swap
        headers.forEach((header, index) => {
            header.setAttribute("data-index", index);
        });
    }

    // Add new rows dynamically
    const addRowButton = document.querySelector("#addRow");
    addRowButton.addEventListener("click", () => {
        const tableBody = document.querySelector("#eventsTableBody");
        const newRow = document.createElement("tr");

        // Add contenteditable cells
        ["event-name", "event-date", "event-details", "event-link"].forEach((className) => {
            const cell = document.createElement("td");
            cell.setAttribute("contenteditable", "true");
            cell.classList.add(className);
            newRow.appendChild(cell);
        });

        tableBody.appendChild(newRow);
    });
});


// DISPLAY EVENT DETAILS 
document.getElementById("fetchEventDetailsBtn").addEventListener("click", function() {
    const orgId = this.getAttribute("data-org-id");
    const channelId = this.getAttribute("data-channel-id");

    fetch(`/channels/events/fetch/${orgId}/${channelId}/`)
        .then(response => response.json())
        .then(data => {
            const tableBody = document.getElementById("eventDetailsTable").getElementsByTagName("tbody")[0];
            tableBody.innerHTML = "";

            if (data.events.length === 0) {
                const row = tableBody.insertRow();
                row.className = "bg-gray-50";
                const cell = row.insertCell(0);
                cell.className = "py-6 text-center text-gray-500";
                cell.colSpan = 7;
                cell.innerText = "No events found. Create your first event!";
            } else {
                data.events.forEach(event => {
                    const row = tableBody.insertRow();
                    row.className = "group hover:bg-gray-50 transition-colors border-b border-gray-100";

                    // Event Name
                    const nameCell = row.insertCell(0);
                    nameCell.className = "px-4 py-3 text-sm font-medium text-gray-900 truncate max-w-[200px]";
                    nameCell.innerText = event.event_name;

                    // Event Date/Time
                    const dateCell = row.insertCell(1);
                    dateCell.className = "px-4 py-3 text-sm text-gray-600 whitespace-nowrap";
                    dateCell.innerHTML = `
                        <div class="inline-flex items-center gap-2">
                            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                            ${event.event_date}
                        </div>
                    `;

                    // Event Details
                    const detailsCell = row.insertCell(2);
                    detailsCell.className = "px-4 py-3 text-sm text-gray-600 max-w-[300px] truncate hover:whitespace-normal";
                    detailsCell.innerText = event.event_details;

                    // Event Attachment
                    const attachmentCell = row.insertCell(3);
                    attachmentCell.className = "px-4 py-3 text-sm";
                    if (event.event_attachment) {
                        attachmentCell.innerHTML = `
                            <a href="${event.event_attachment}" target="_blank" 
                               class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 hover:underline">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                Download
                            </a>
                        `;
                    } else {
                        attachmentCell.innerHTML = `<span class="text-gray-400">-</span>`;
                    }

                    // Event Link
                    const linkCell = row.insertCell(4);
                    linkCell.className = "px-4 py-3 text-sm";
                    if (event.event_link) {
                        linkCell.innerHTML = `
                            <a href="${event.event_link}" target="_blank" 
                               class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 hover:underline">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                                </svg>
                                View Event
                            </a>
                        `;
                    } else {
                        linkCell.innerHTML = `<span class="text-gray-400">-</span>`;
                    }

                    // Created By
                    const creatorCell = row.insertCell(5);
                    creatorCell.className = "px-4 py-3 text-sm text-gray-600";
                    creatorCell.innerHTML = `
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-xs">
                                ${event.created_by[0]}
                            </div>
                            ${event.created_by}
                        </div>
                    `;

                    // Action: Mark as Attending
                    const actionCell = row.insertCell(6);
                    actionCell.className = "px-4 py-3 text-sm";
                    const attendButton = document.createElement("button");
                    attendButton.className = "flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm font-medium";
                    attendButton.innerHTML = `
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                        <span>Attend</span>
                    `;

                    attendButton.addEventListener("click", () => {
                        attendButton.disabled = true;
                        attendButton.innerHTML = `
                            <span class="animate-spin inline-block w-4 h-4 border-2 border-current border-t-transparent rounded-full"></span>
                            Processing...
                        `;
                        
                        fetch(`/channels/mark_attending/${orgId}/${channelId}/${event.id}/`, {
                            method: "GET"
                        })
                        .then(response => {
                            if (response.ok) {
                                showNotification(`✅ Successfully marked attendance for ${event.event_name}`);
                                attendButton.className = "px-4 py-2 bg-green-100 text-green-800 rounded-lg cursor-default";
                                attendButton.innerHTML = "Confirmed";
                            } else {
                                attendButton.className = "px-4 py-2 bg-red-100 text-red-800 rounded-lg";
                                attendButton.innerHTML = "Failed - Try Again";
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            attendButton.className = "px-4 py-2 bg-red-100 text-red-800 rounded-lg";
                            attendButton.innerHTML = "Error Occurred";
                        });
                    });

                    actionCell.appendChild(attendButton);
                });
            }
        })
        .catch(error => {
            console.error('Error fetching event details:', error);
        });
});



// CHANNEL SETTINGS
// Get CSRF token from the DOM (ensure it's rendered in your template)
const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;

// When the modal is opened, fetch and display settings
document.getElementById('settingsModal').addEventListener('show.bs.modal', function () {
    const orgId = "{{channel.organization.id}}";  // Replace with actual organization ID
    const channelId = "{{channel.id}}";  // Replace with actual channel ID

    // Fetch the settings
    fetch(`/channels/channel_settings/${orgId}/${channelId}/`, {
        method: 'GET',
        headers: {
            'X-CSRFToken': csrfToken,
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.allow_media_uploads !== undefined) {
            document.getElementById('allowMediaUploads').checked = data.allow_media_uploads;
        }
        if (data.allow_codes !== undefined) {
            document.getElementById('allowCodes').checked = data.allow_codes;
        }
        if (data.secure_from_unwanted_requests !== undefined) {
            document.getElementById('secureFromUnwantedRequests').checked = data.secure_from_unwanted_requests;
        }
        if (data.allow_polls !== undefined) {
            document.getElementById('allowPolls').checked = data.allow_polls;
        }
        if (data.allow_sharing_access_to_another_workspace !== undefined) {
            document.getElementById('allowSharingAccess').checked = data.allow_sharing_access_to_another_workspace;
        }
        if (data.track_abusive_messages !== undefined) {
            document.getElementById('trackAbusiveMessages').checked = data.track_abusive_messages;
        }
        if (data.allow_integrations !== undefined) {
            document.getElementById('allowIntegrations').checked = data.allow_integrations;
        }
        if (data.integration_choices) {
            document.getElementById('integrationChoices').value = data.integration_choices;
        }
    })
    .catch(error => console.error('Failed to fetch settings:', error));
});

// Save settings automatically as user toggles
const settingsForm = document.getElementById('settingsForm');
settingsForm.addEventListener('change', function () {
    const settingsData = {
        allow_media_uploads: document.getElementById('allowMediaUploads').checked,
        allow_codes: document.getElementById('allowCodes').checked,
        secure_from_unwanted_requests: document.getElementById('secureFromUnwantedRequests').checked,
        allow_polls: document.getElementById('allowPolls').checked,
        allow_sharing_access_to_another_workspace: document.getElementById('allowSharingAccess').checked,
        track_abusive_messages: document.getElementById('trackAbusiveMessages').checked,
        allow_integrations: document.getElementById('allowIntegrations').checked,
        integration_choices: document.getElementById('integrationChoices').value
    };

    const orgId = "{{channel.organization.id}}";  // Replace with actual organization ID
    const channelId = "{{channel.id}}";  // Replace with actual channel ID

    // Send settings to the server via AJAX
    fetch(`/channels/channel_settings/${orgId}/${channelId}/`, {
        method: 'POST',
        headers: {
            'X-CSRFToken': csrfToken,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(settingsData)
    })
    .then(response => response.json())
    .then(data => {
        console.log('Settings saved successfully');
    })
    .catch(error => console.error('Failed to save settings:', error));
});


// EVENTS CALENDAR 

document.getElementById("show-calendar-btn").addEventListener("click", function () {
    const calendarContainer = document.getElementById("calendar-container");

    if (calendarContainer.classList.contains("hidden")) {
        calendarContainer.classList.remove("hidden");

        const calendarEl = document.getElementById("calendar");

        // Initialize the FullCalendar
        const calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: "dayGridMonth",
            headerToolbar: {
                left: "prev,next today",
                center: "title",
                right: "dayGridMonth,timeGridWeek,timeGridDay",
            },
            events: async function (info, successCallback, failureCallback) {
                try {
                    // Replace 'org_id' and 'channel_id' with actual values
                    const orgId = "{{channel.organization.id}}"; // Dynamic org_id
                    const channelId = "{{channel.id}}"; // Dynamic channel_id

                    // Fetch events from the server
                    const response = await fetch(`/channels/channel_events/${orgId}/${channelId}/`);
                    if (!response.ok) {
                        throw new Error("Failed to fetch events");
                    }

                    const eventData = await response.json();
                    successCallback(eventData);
                } catch (error) {
                    console.error("Error fetching events:", error);
                    failureCallback(error);
                }
            },
            eventClick: function (info) {
                // Populate modal with event details
                const modalTitle = document.getElementById("modal-title");
                const modalBody = document.getElementById("modal-body");

                modalTitle.textContent = info.event.title;
                modalBody.innerHTML = `
    <div class="space-y-4 text-sm">
        <div class="grid grid-cols-[120px,1fr] items-baseline gap-4">
            <div class="flex items-center gap-2 text-gray-500 font-medium">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                <span>Start</span>
            </div>
            <div class="font-mono text-gray-700 bg-gray-50 px-3 py-1 rounded-lg">
                ${info.event.start}
            </div>
        </div>

        <div class="grid grid-cols-[120px,1fr] items-baseline gap-4">
            <div class="flex items-center gap-2 text-gray-500 font-medium">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                <span>End</span>
            </div>
            <div class="font-mono text-gray-700 bg-gray-50 px-3 py-1 rounded-lg">
                ${info.event.end || "N/A"}
            </div>
        </div>

        <div class="grid grid-cols-[120px,1fr] items-start gap-4">
            <div class="flex items-center gap-2 text-gray-500 font-medium">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span>Details</span>
            </div>
            <div class="text-gray-700 px-3 py-1 rounded-lg">
                ${info.event.extendedProps.details || "No details provided."}
            </div>
        </div>

        ${info.event.extendedProps.attachment ? `
        <div class="grid grid-cols-[120px,1fr] items-baseline gap-4">
            <div class="flex items-center gap-2 text-gray-500 font-medium">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                <span>Attachment</span>
            </div>
            <a href="${info.event.extendedProps.attachment}" target="_blank" 
               class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 px-3 py-1 rounded-lg hover:bg-blue-50 transition-colors">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                </svg>
                View File
            </a>
        </div>` : ''}

        ${info.event.extendedProps.link ? `
        <div class="grid grid-cols-[120px,1fr] items-baseline gap-4">
            <div class="flex items-center gap-2 text-gray-500 font-medium">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                </svg>
                <span>Link</span>
            </div>
            <a href="${info.event.extendedProps.link}" target="_blank" 
               class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 px-3 py-1 rounded-lg hover:bg-blue-50 transition-colors truncate">
                <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                </svg>
                <span class="truncate">${info.event.extendedProps.link}</span>
            </a>
        </div>` : ''}
    </div>
`;


                // Show the modal
                const modal = new bootstrap.Modal(document.getElementById("eventCalendarModal"));
                modal.show();
            },
        });

        calendar.render();
    }
});



// DELETE CHANNEL DATA

// Bootstrap 5 Modal Instances
const deleteChannelDataModal = new bootstrap.Modal(document.getElementById('deleteChannelDataModal'));
  const deleteChannelPasswordModal = new bootstrap.Modal(document.getElementById('deleteChannelPasswordModal'));

  // Open the Select Data Modal
  document.getElementById('deleteChannelDataBtn').addEventListener('click', () => {
    deleteChannelDataModal.show();
  });

  // Handle Next Button in Select Data Modal
  document.getElementById('nextToPasswordModalBtn').addEventListener('click', () => {
    const selectedOptions = [];
    if (document.getElementById('deleteMessagesOption').checked) selectedOptions.push('messages');
    if (document.getElementById('deleteLinksOption').checked) selectedOptions.push('links');
    if (document.getElementById('deleteAudioOption').checked) selectedOptions.push('audio');
    if (document.getElementById('deleteVideoOption').checked) selectedOptions.push('video');
    if (document.getElementById('deleteActivityLogsOption').checked) selectedOptions.push('activity');

    if (selectedOptions.length > 0) {
      deleteChannelDataModal.hide();
      deleteChannelPasswordModal.show();
    } else {
      alert('Please select at least one type of data to delete.');
    }
  });

  // Handle Submit Button in Password Modal
  document.getElementById('submitChannelPasswordBtn').addEventListener('click', () => {
    const password = document.getElementById('channelPasswordInput').value;
    const selectedOptions = [];
    if (document.getElementById('deleteMessagesOption').checked) selectedOptions.push('messages');
    if (document.getElementById('deleteLinksOption').checked) selectedOptions.push('links');
    if (document.getElementById('deleteAudioOption').checked) selectedOptions.push('audio');
    if (document.getElementById('deleteVideoOption').checked) selectedOptions.push('video');
    if (document.getElementById('deleteActivityLogsOption').checked) selectedOptions.push('activity');

    fetch('{% url "delete_channel_data" org_id=channel.organization.id channel_id=channel.id %}', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': '{{ csrf_token }}',
      },
      body: JSON.stringify({
        password: password,
        data_to_delete: selectedOptions,
      }),
    })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          alert('Data deleted successfully!');
        } else {
            showNotification('Channels selected data deleted successfully. Please refresh the page for new changes.', 'Refresh', window.location.href);
        }
        deleteChannelPasswordModal.hide();
      })
      .catch(error => {
        console.error('Error:', error);
        alert('An error occurred. Please try again.');
        deleteChannelPasswordModal.hide();
      });
  });

// Toggle password visible
 // Add this script to toggle password visibility
 document.getElementById('togglePassword').addEventListener('click', function() {
      const passwordInput = document.getElementById('passwordInput');
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        this.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />
        </svg>`;
      } else {
        passwordInput.type = 'password';
        this.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
        </svg>`;
      }
    });




// CUSTOM NOTIFICATION FUNCTION
function showNotification(message, linkText, linkUrl) {
    const notificationContainer = document.createElement('div');
    notificationContainer.style.position = 'fixed';
    notificationContainer.style.top = '20px';
    notificationContainer.style.right = '20px';
    notificationContainer.style.padding = '15px 20px';
    notificationContainer.style.backgroundColor = '#007bff'; // Fresh blue
    notificationContainer.style.color = 'white';
    notificationContainer.style.borderRadius = '15px';
    notificationContainer.style.fontSize = '16px';
    notificationContainer.style.zIndex = '1000';
    notificationContainer.style.display = 'flex';
    notificationContainer.style.alignItems = 'center';
    notificationContainer.style.opacity = '0';
    notificationContainer.style.transform = 'translateX(100%)';
    notificationContainer.style.transition = 'transform 0.6s ease-out, opacity 0.6s ease-out'; // Smooth animation

    // Adding a checkmark icon with a bit of style
    const checkmark = document.createElement('span');
    checkmark.textContent = '✔'; // Checkmark symbol
    checkmark.style.fontSize = '24px';
    checkmark.style.marginRight = '15px';
    checkmark.style.transform = 'rotate(10deg)'; // Slightly rotate for a fun touch

    const messageElement = document.createElement('span');
    messageElement.textContent = message;
    messageElement.style.flexGrow = '1'; // Allow message to grow and use remaining space
    messageElement.style.fontWeight = '500';

    const linkElement = document.createElement('a');
    linkElement.textContent = linkText;
    linkElement.href = linkUrl;
    linkElement.style.color = '#ffffff';
    linkElement.style.textDecoration = 'underline';
    linkElement.style.marginLeft = '15px';
    linkElement.style.fontWeight = 'bold';

    // Append the checkmark, message, and link to the notification
    notificationContainer.appendChild(checkmark);
    notificationContainer.appendChild(messageElement);
    notificationContainer.appendChild(linkElement);

    // Append the notification to the body
    document.body.appendChild(notificationContainer);

    // Trigger animation to make the notification slide in
    setTimeout(() => {
        notificationContainer.style.opacity = '1';
        notificationContainer.style.transform = 'translateX(0)';
    }, 100);

    // Remove the notification after 5 seconds
    setTimeout(() => {
        notificationContainer.style.opacity = '0';
        notificationContainer.style.transform = 'translateX(100%)';
        setTimeout(() => {
            notificationContainer.remove();
        }, 600); // Allow time for animation to finish
    }, 5000);
}

</script>

   <!-- Add Bootstrap 5 JS just before the closing </body> tag -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>



