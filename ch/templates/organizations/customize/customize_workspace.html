{% extends 'custom.html' %}

{% block content %}

{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token }}">

    <script src="{% static 'organizations/script.js' %}"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>{{organization.name}} Settings</title>
    <style>
        :root {
            --primary-color: #4A154B;
            --secondary-color: #F4EDE4;
            --accent-color: #36C5F0;
            --text-primary: #1A1A1A;
            --text-secondary: #616061;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa;
            color: var(--text-primary);
        }

        .settings-container {
            max-width: 1440px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 2rem;
            padding: 2rem;
        }

        .settings-sidebar {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .settings-main {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .nav-item {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            transition: all 0.2s ease;
            color: var(--text-secondary);
        }

        .nav-item:hover {
            background: var(--secondary-color);
            color: var(--primary-color);
        }

        .nav-item.active {
            background: var(--primary-color);
            color: white;
        }

        .org-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #e9ecef;
            margin-bottom: 2rem;
        }

        .org-icon {
            width: 64px;
            height: 64px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #2BAC76;
            margin-right: 8px;
        }

        .card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .modal-content {
            border-radius: 16px;
            border: none;
        }

        .form-control {
            border-radius: 8px;
            padding: 0.75rem 1rem;
        }

        .btn-primary {
            background-color: var(--primary-color);
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .btn-primary:hover {
            background-color: #301531;
            transform: translateY(-1px);
        }

        @media (max-width: 768px) {
            .settings-container {
                grid-template-columns: 1fr;
                padding: 1rem;
            }
            
            .settings-sidebar {
                display: none;
            }
        }


        .fs-13 { font-size: 13px; }
    .modal-content { border: none; box-shadow: 0 0 12px rgba(0,0,0,0.15); }
    .btn:hover { background-color: #4a154b; color: white; }
    .file-upload-area:hover { border-color: #611f69; background-color: rgba(97,31,105,0.05); }

    .fs-13 { font-size: 13px; }
    .modal-content { border: none; box-shadow: 0 0 12px rgba(0,0,0,0.15); }
    .btn:hover { background-color: #4a154b !important; color: white !important; }
    .status-pill:hover { border-color: #611f69 !important; color: #611f69 !important; }
    .form-select:focus { border-color: #611f69; box-shadow: 0 0 0 2px rgba(97,31,105,0.2); }
    .status-pill.active { background-color: #611f69 !important; color: white !important; border-color: #611f69 !important; }

    .slack-input:focus {
        border-color: #611f69;
        box-shadow: 0 0 0 2px rgba(97,31,105,0.2);
    }
    .btn-avatar-edit:hover {
        background-color: #f8f8f8 !important;
    }
    .fs-13 { font-size: 13px; }
    .modal-content { border: none; box-shadow: 0 0 12px rgba(0,0,0,0.15); }
    .btn:hover { background-color: #4a154b !important; color: white !important; }



    /* Modal Overlay */

    /* Modal Styling */
#duplicateWorkspaceModal.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.4);
    animation: fadeIn 0.3s ease-in-out;
}

.modal-content {
    background-color: #ffffff;
    margin: 5% auto;
    padding: 28px 32px;
    border-radius: 12px;
    width: 600px;
    position: relative;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    animation: slideIn 0.3s ease-out;
}

/* Typography */
.modal-content h2 {
    color: #1d1c1d;
    font-family: 'Slack-Lato', 'Lato', sans-serif;
    font-size: 28px;
    font-weight: 700;
    margin-bottom: 16px;
}

.modal-content strong {
    color: #1d1c1d;
    font-size: 16px;
    display: block;
    margin-bottom: 12px;
}

.modal-content p {
    color: #616061;
    font-size: 15px;
    line-height: 1.5;
    margin: 12px 0;
}

/* Radio Button Grid */
#duplicateForm {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
    margin: 20px 0;
}

#duplicateForm label {
    display: flex;
    align-items: center;
    padding: 16px;
    border: 2px solid #ddd;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    background: #f8f8f8;
}

#duplicateForm label:hover {
    border-color: #1264a3;
    background: #f0f6fc;
}

#duplicateForm input[type="radio"] {
    opacity: 0;
    position: absolute;
}

#duplicateForm input[type="radio"]:checked + span::before {
    content: "✓";
    color: #1264a3;
    position: absolute;
    left: -28px;
    font-size: 16px;
}

#duplicateForm label span {
    margin-left: 32px;
    color: #1d1c1d;
    font-weight: 500;
    font-size: 15px;
}

/* Button Styling */
#confirmDuplicate {
    grid-column: span 2;
    background: #2bac76;
    color: white;
    border: none;
    padding: 16px 24px;
    border-radius: 4px;
    font-weight: 700;
    font-size: 15px;
    cursor: pointer;
    transition: background 0.2s ease;
    margin-top: 16px;
}

#confirmDuplicate:hover {
    background: #238f63;
}

/* Close Button */
.close {
    color: #616061;
    float: right;
    font-size: 28px;
    font-weight: 300;
    transition: color 0.2s ease;
}

.close:hover,
.close:focus {
    color: #1d1c1d;
    text-decoration: none;
    cursor: pointer;
}

/* Helper Text */
.helper-text {
    color: #868686;
    font-size: 13px;
    margin-top: 4px;
    display: block;
}

/* Warning Message */
.warning-message {
    color: #e01e5a;
    font-size: 13px;
    margin-top: 8px;
    font-weight: 500;
}

/* Animations */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideIn {
    from { transform: translateY(-20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

/* Mobile Responsive */
@media (max-width: 600px) {
    .modal-content {
        width: 90%;
        margin: 10% auto;
    }
    
    #duplicateForm {
        grid-template-columns: 1fr;
    }
    
    #confirmDuplicate {
        grid-column: span 1;
    }
}

   
    </style>
</head>
<body>
    <div class="settings-container">
        <!-- Sidebar Navigation -->
        <aside class="settings-sidebar">
            <div class="org-header">
                {% if organization.icon %}
                <img src="{{ organization.icon.url }}" alt="{{ organization.name }} Icon" class="org-icon">
                {% else %}
                <div class="org-icon bg-primary text-white d-flex align-items-center justify-content-center">
                    {{ organization.name|first|upper }}
                </div>
                {% endif %}
                <div>
                    <h3 class="mb-0">{{ organization.name }}</h3>
                    <small class="text-muted">Workspace</small>
                </div>
            </div>

            <nav class="nav flex-column">
                <a href="#" class="nav-item active">
                    <i class="material-icons-round me-2">settings</i>
                    Workspace Settings
                </a>
                <a href="{% url 'workspace_details' org_id=organization.id %}" class="nav-item">
                    <i class="material-icons-round me-2">info</i>
                    About Workspace
                </a>
                <a href="{% url 'workspace_analytics' org_id=organization.id %}" class="nav-item">
                    <i class="material-icons-round me-2">analytics</i>
                    Analytics
                </a>
                <a href="#" class="nav-item" data-bs-toggle="modal" data-bs-target="#editProfileModal">
                    <i class="material-icons-round me-2">person</i>
                    Account & Profile
                </a>
                <a href="{% url 'workspace_billing' org_id=organization.id%}" class="nav-item">
                    <i class="material-icons-round me-2">person</i>
                    Billing
                </a>

                <a href="{% url 'pulse' org_id=organization.id%}" class="nav-item">
                    <i class="material-icons-round me-2">person</i>
                    Pulse 
                </a>

                <a href="{% url 'security_transport_layer' org_id=organization.id%}" class="nav-item">
                    <i class="material-icons-round me-2">person</i>
                    Support For Transport Layer Security(TLS)
                </a>

                <a href="{% url 'user_help_queries' org_id=organization.id%}" class="nav-item">
                    <i class="material-icons-round me-2">person</i>
                    Help
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="settings-main">
            <h4 class="mb-4">Workspace Settings</h4>

            <div class="row g-4">
                <!-- Workspace Icon Card -->
                <div class="col-md-6">
                    <div class="card h-100 p-4">
                        <div class="d-flex align-items-center mb-3">
                            <i class="material-icons-round me-2 text-primary">image</i>
                            <h5 class="mb-0">Workspace Icon</h5>
                        </div>
                        <p class="text-muted small mb-4">
                            Recommended size: 512x512px. Formats: PNG, JPG. This appears in your workspace header and notifications.
                        </p>
                        <div class="text-center mb-4">
                            {% if organization.icon %}
                            <img src="{{ organization.icon.url }}" alt="Workspace Icon" class="img-fluid rounded-3" style="max-width: 120px;">
                            {% else %}
                            <div class="bg-secondary text-white rounded-3 d-flex align-items-center justify-content-center" style="width: 120px; height: 120px;">
                                {{ organization.name|first|upper }}
                            </div>
                            {% endif %}
                        </div>
                        <button class="btn btn-outline-primary w-100" data-bs-toggle="modal" data-bs-target="#updateIconModal">
                            Update Icon
                        </button>
                    </div>
                </div>

                <!-- Workspace Status Card -->
                <div class="col-md-6">
                    <div class="card h-100 p-4">
                        <div class="d-flex align-items-center mb-3">
                            <i class="material-icons-round me-2 text-primary">visibility</i>
                            <h5 class="mb-0">Workspace Status</h5>
                        </div>
                        <p class="text-muted small mb-4">
                            Let members know the current status of your workspace. This appears in team directories and notifications.
                        </p>
                        <div class="d-flex align-items-center mb-4">
                            <span class="status-indicator"></span>
                            <span class="text-success fw-medium">Active</span>
                        </div>
                        <button class="btn btn-outline-primary w-100" data-bs-toggle="modal" data-bs-target="#updateStatusModal">
                            Update Status
                        </button>
                    </div>
                </div>

                <!-- Advanced Settings Card -->
                <div class="col-12">
                    <div class="card p-4">
                        <h5 class="mb-4"><i class="material-icons-round me-2 text-primary">admin_panel_settings</i>Advanced Settings</h5>
                        <div class="row g-4">
                            <div class="col-md-6">
                                <div class="border-bottom pb-3">
                                    <h6>Workspace Ownership</h6>
                                    <p class="text-muted small mb-2">
                                        Transfer workspace ownership to another member or delete the workspace.
                                    </p>

                                    <a href="{% url 'workspace_members' org_id=organization.id%}">
                                        <button class="btn btn-sm btn-outline-danger">
                                            Transfer Ownership
                                        </button>
                                    </a>
                    
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="border-bottom pb-3">
                                    <h6>Account Security</h6>
                                    <p class="text-muted small mb-2">
                                        Manage session security and two-factor authentication settings.
                                    </p>
                                    <a href="{% url 'logout' %}" class="btn btn-sm btn-outline-primary">
                                        Sign Out All Sessions
                                    </a>
                                </div>
                            </div>
                            <br>
                            <!-- New Features -->
                            <div class="col-md-6">
                                <div class="border-bottom pb-3">
                                    <h6>User Groups</h6>
                                    <p class="text-muted small mb-2">
                                        Organise your team with user groups
                                    </p>
                                    <a href="{% url 'workspace_groups' org_id=organization.id %}" class="btn btn-sm btn-outline-primary">
                                        Configure Groups
                                    </a>
                                </div>
                            </div>



                            <h5 class="mb-4"><i class="material-icons-round me-2 text-primary">admin_panel_settings</i>Invitations</h5>
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <div class="border-bottom pb-3">
                                        <h6>Invitations</h6>
                                        <p class="text-muted small mb-2">
                                          Track your invitations and keep an eye to whom your manager invited to join {{organization.name}}
                                        </p>
    
                                        <a href="{% url 'workspace_invitations_admin' org_id=organization.id%}">
                                            <button class="btn btn-sm btn-outline-danger">
                                                {{organization.name}} Invitations
                                            </button>
                                        </a>
                        
                                    </div>

                                    <!-- New Features -->

                                    <div class="col-md-6">
                                        <div class="border-bottom pb-3">
                                            <h6>Hide Workspace</h6>
                                            <p class="text-muted small mb-2">
                                                Hide your workspace to take your break
                                            </p>
                                            <a href="{% url 'hide_workspace' org_id=organization.id %}" class="btn btn-sm btn-outline-primary">
                                                Hide {{organization.name}}
                                            </a>
                                        </div>
                                    </div>
                                    <br>

                                  <h5 class="mb-4"><i class="material-icons-round me-2 text-primary">admin_panel_settings</i>Duplication</h5>
                                 <div class="row g-4">
                                   <div class="col-md-6">
                                    <div class="border-bottom pb-3">
                                        <h6>Copy {{organization.name}}</h6>
                                        <p class="text-muted small mb-2">
                                           Clone your workspace and enjoy seamless experience
                                        </p>

                                        <button onclick="openDuplicateModal()" class="btn btn-sm btn-outline-primary">Duplicate Workspace</button>
                                    </div>

                                </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>




<!-- Modals (Keep your existing modal HTML, styled with new CSS)--------------------- -->
    <!-- Update Icon Modal -->
    <div class="modal fade" id="updateIconModal" tabindex="-1" aria-labelledby="updateIconModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="border-radius: 8px;">
                <div class="modal-header border-bottom-0 pb-0">
                    <h5 class="modal-title fs-5 fw-bold" id="updateIconModalLabel">Update Workspace Icon</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body pt-0">
                    <div class="slack-guidelines mb-4 p-3" style="background-color: #f8f8f8; border-radius: 8px;">
                        <p class="text-muted fs-13 mb-2 fw-semibold">Workspace icon guidelines</p>
                        <ul class="list-unstyled fs-13 text-muted mb-0">
                            <li class="mb-2 d-flex align-items-start">
                                <i class="fas fa-check-circle me-2 mt-1" style="color: #611f69; font-size: 14px;"></i>
                                Use a solid background color with good contrast
                            </li>
                            <li class="mb-2 d-flex align-items-start">
                                <i class="fas fa-check-circle me-2 mt-1" style="color: #611f69; font-size: 14px;"></i>
                                Prefer graphical logos over text-based designs
                            </li>
                            <li class="mb-2 d-flex align-items-start">
                                <i class="fas fa-check-circle me-2 mt-1" style="color: #611f69; font-size: 14px;"></i>
                                Maintain clear spacing around the edges
                            </li>
                            <li class="d-flex align-items-start">
                                <i class="fas fa-check-circle me-2 mt-1" style="color: #611f69; font-size: 14px;"></i>
                                Upload image (132px square minimum, PNG/JPG)
                            </li>
                        </ul>
                    </div>
    
                    <form id="updateIconForm" class="mb-4">
                        <div class="file-upload-area text-center p-4" 
                             style="border: 2px dashed #ddd; border-radius: 8px; cursor: pointer;"
                             onclick="document.getElementById('workspaceIcon').click()">
                            <i class="fas fa-cloud-upload-alt fa-2x mb-3" style="color: #611f69;"></i>
                            <p class="mb-0 fw-semibold" style="color: #611f69;">Choose an image file</p>
                            <p class="text-muted fs-13 mt-1">or drag and drop here</p>
                            <input type="file" class="form-control d-none" id="workspaceIcon" accept="image/*" required>
                        </div>
                        <button type="submit" class="btn w-100 mt-3" 
                                style="background-color: #611f69; color: white; border-radius: 4px; font-weight: 500;">
                            Upload Icon
                        </button>
                    </form>
    
                    <div class="current-icon-section text-center">
                        <p class="text-muted fs-13 mb-2 fw-semibold">Current Icon Preview</p>
                        <div class="d-inline-block p-2" style="background-color: #f8f8f8; border-radius: 12px;">
                            {% if organization.icon %}
                            <img id="currentIcon" src="{{ organization.icon.url }}" alt="Workspace Icon" 
                                 class="img-fluid rounded-circle" style="width: 80px; height: 80px; object-fit: cover;">
                            {% else %}
                            <div class="d-flex align-items-center justify-content-center rounded-circle" 
                                 style="width: 80px; height: 80px; background-color: #ddd;">
                                <i class="fas fa-building fs-4" style="color: #666;"></i>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Status Modal -->
    <div class="modal fade" id="updateStatusModal" tabindex="-1" aria-labelledby="updateStatusModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="border-radius: 8px;">
                <div class="modal-header border-bottom-0 pb-0">
                    <h5 class="modal-title fs-5 fw-bold" id="updateStatusModalLabel">Update {{ organization.name }} Status</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body pt-0">
                    <div class="slack-guidelines mb-4">
                        <p class="text-muted fs-13 mb-3">
                            <i class="fas fa-info-circle me-2" style="color: #611f69;"></i>
                            Anyone can write their own status description. Customize these suggestions for your workspace.
                        </p>
                    </div>
    
                    <form id="updateStatusForm">
                        <div class="mb-4">
                            <label for="statusSelect" class="form-label fw-semibold fs-13 mb-2">Select Status</label>
                            <div class="dropdown-wrapper position-relative">
                                <select class="form-select ps-3" id="statusSelect" 
                                        style="height: 40px; border-radius: 6px; border-color: #ddd;"
                                        aria-label="Status selection">
                                    <option value="working_remotely">🏠 Working Remotely</option>
                                    <option value="in_a_meeting">📅 In A Meeting</option>
                                    <option value="off_sick">🤒 Off Sick</option>
                                    <option value="on_holiday">🌴 On Holiday</option>
                                </select>
                                <i class="fas fa-chevron-down position-absolute" 
                                   style="right: 15px; top: 50%; transform: translateY(-50%); color: #616061;"></i>
                            </div>
                        </div>
    
                        <div class="suggested-statuses mb-4">
                            <p class="text-muted fs-13 fw-semibold mb-2">Suggested Statuses</p>
                            <div class="d-flex flex-wrap gap-2">
                                <button type="button" class="status-pill btn btn-outline-secondary rounded-pill px-3 py-1 fs-13"
                                        data-value="working_remotely">
                                    🏠 Working Remotely
                                </button>
                                <button type="button" class="status-pill btn btn-outline-secondary rounded-pill px-3 py-1 fs-13"
                                        data-value="in_a_meeting">
                                    📅 In a Meeting
                                </button>
                                <button type="button" class="status-pill btn btn-outline-secondary rounded-pill px-3 py-1 fs-13"
                                        data-value="off_sick">
                                    🤒 Out Sick
                                </button>
                                <button type="button" class="status-pill btn btn-outline-secondary rounded-pill px-3 py-1 fs-13"
                                        data-value="on_holiday">
                                    🌴 On Vacation
                                </button>
                            </div>
                        </div>
    
                        <button type="submit" class="btn w-100 mt-2"
                                style="background-color: #611f69; color: white; border-radius: 4px; font-weight: 500; padding: 10px;">
                            Update Status
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    
    <!-- Profile Edit Modal -->
    <div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="border-radius: 8px;">
                <div class="modal-header border-bottom-0 pb-0">
                    <h5 class="modal-title fs-5 fw-bold" id="editProfileModalLabel">Edit Profile</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body pt-0">
                    <form id="editProfileForm">
                        <!-- Profile Picture -->
                        <div class="mb-4 text-center">
                            <div class="avatar-upload position-relative d-inline-block">
                                <div class="avatar-preview rounded-circle overflow-hidden" 
                                     style="width: 100px; height: 100px; border: 2px solid #ddd;">
                                    <img id="profile_picture_img" src="" alt="Profile Preview" 
                                         class="img-fluid h-100 w-100 object-fit-cover">
                                </div>
                                <label for="profile_picture" class="btn-avatar-edit position-absolute bottom-0 end-0 bg-white rounded-circle p-2 shadow-sm"
                                       style="width: 32px; height: 32px;">
                                    <i class="fas fa-camera" style="font-size: 14px; color: #616061;"></i>
                                </label>
                                <input type="file" class="d-none" id="profile_picture" accept="image/*">
                            </div>
                        </div>
    
                        <!-- Full Name -->
                        <div class="mb-4">
                            <label for="full_name" class="form-label fw-semibold fs-13 mb-2">Full Name</label>
                            <input type="text" class="form-control slack-input" id="full_name" required
                                   style="border-radius: 6px; padding: 8px 12px;">
                        </div>
    
                        <!-- Email -->
                        <div class="mb-4">
                            <label for="email" class="form-label fw-semibold fs-13 mb-2">Email</label>
                            <input type="email" class="form-control slack-input" id="email" required
                                   style="border-radius: 6px; padding: 8px 12px;">
                        </div>
    
                        <!-- Time Zone -->
                        <div class="mb-4 p-3" style="background-color: #f8f8f8; border-radius: 8px;">
                            <div class="d-flex align-items-start">
                                <i class="fas fa-clock me-2 mt-1" style="color: #616061; font-size: 14px;"></i>
                                <div>
                                    <p class="fw-semibold fs-13 mb-1">Time Zone</p>
                                    <p class="text-muted fs-13 mb-0">
                                        (UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi<br>
                                        <span class="text-muted">Used for notifications and scheduling</span>
                                    </p>
                                </div>
                            </div>
                        </div>
    
                        <!-- Session Management -->
                        <div class="mb-4 p-3" style="background-color: #f8f8f8; border-radius: 8px;">
                            <div class="d-flex align-items-start">
                                <i class="fas fa-sign-out-alt me-2 mt-1" style="color: #616061; font-size: 14px;"></i>
                                <div>
                                    <p class="fw-semibold fs-13 mb-2">Sign out of all other sessions</p>
                                    <p class="text-muted fs-13 mb-3">
                                        Lost your phone? Left yourself logged in on a public computer? 
                                        Secure your account by signing out everywhere except this browser.
                                    </p>
                                    <a href="{% url 'logout' %}" class="btn btn-sm w-100" 
                                       style="background-color: #611f69; color: white; border-radius: 4px;">
                                        Sign Out Everywhere Else
                                    </a>
                                </div>
                            </div>
                        </div>
    
                        <!-- Account Management -->
                        <div class="p-3" style="background-color: #fdf2f2; border-radius: 8px;">
                            <div class="d-flex align-items-start">
                                <i class="fas fa-exclamation-triangle me-2 mt-1" style="color: #c23628; font-size: 14px;"></i>
                                <div>
                                    <p class="fw-semibold fs-13 mb-1 text-danger">Account Management</p>
                                    <p class="text-muted fs-13 mb-2">
                                        As primary owner of {{organization.name}}, you can't deactivate your account.
                                    </p>
                                    <div class="d-flex gap-2 fs-13">
                                        <a href="#" class="text-decoration-none fw-semibold" style="color: #611f69;">
                                            Transfer Ownership
                                        </a>
                                        <span class="text-muted">|</span>
                                        <a href="#" class="text-decoration-none fw-semibold" style="color: #611f69;">
                                            Delete Workspace
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
    
                        <!-- Save Button -->
                        <button type="submit" class="btn w-100 mt-4" 
                                style="background-color: #611f69; color: white; border-radius: 4px; padding: 10px;">
                            Save Changes
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>


<!-- Dupl;icate Workspace  -->

<div id="duplicateWorkspaceModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span onclick="closeDuplicateModal()" class="close">&times;</span>
        <h2>Duplicate Workspace</h2>
        
        <div class="header-section">
            <strong>Workspace would be {{organization.name}} Copy</strong>
            <p class="helper-text">Team members will have access to all selected components in the new workspace</p>
        </div>

        <form id="duplicateForm">
            <label>
                <input type="radio" name="option" value="only_workspace">
                <span>Only Workspace</span>
                <span class="helper-text">Basic settings and structure</span>
            </label>
            
            <label>
                <input type="radio" name="option" value="workspace_with_members">
                <span>Workspace with Members</span>
                <span class="helper-text">Include all team members</span>
            </label>
            
            <label>
                <input type="radio" name="option" value="projects">
                <span>Projects</span>
                <span class="helper-text">All current projects and tasks</span>
            </label>
            
            <label>
                <input type="radio" name="option" value="meetings">
                <span>Meetings</span>
                <span class="helper-text">Scheduled meetings and notes</span>
            </label>
            
            <label>
                <input type="radio" name="option" value="channels">
                <span>Channels</span>
                <span class="helper-text">All public channels</span>
            </label>
            
            <label>
                <input type="radio" name="option" value="groups">
                <span>Groups</span>
                <span class="helper-text">Private groups and permissions</span>
            </label>
            
            <label style="grid-column: span 2">
                <input type="radio" name="option" value="everything">
                <span>Everything</span>
                <span class="helper-text warning-message">This will duplicate all workspace components</span>
            </label>

            <button type="submit" id="confirmDuplicate" class="btn btn-success">
                Create Duplicate Workspace
            </button>
        </form>
    </div>
</div>



<div id="organization-id" data-org-id="{{ organization.id }}"></div>

    
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  


<script>
    const organizationId = "{{ organization.id }}";

    
// HANDLE DUPLICATION OF WORKSPACE
function openDuplicateModal() {
    const modal = document.getElementById("duplicateWorkspaceModal");
    modal.style.display = "block";
}

function closeDuplicateModal() {
    const modal = document.getElementById("duplicateWorkspaceModal");
    modal.style.display = "none";
}

// Close modal if user clicks outside the modal content
window.addEventListener("click", function (event) {
    const modal = document.getElementById("duplicateWorkspaceModal");
    if (event.target === modal) {
        closeDuplicateModal();
    }
});

// Handle form submission
document.getElementById("duplicateForm").addEventListener("submit", function (event) {
    event.preventDefault();

    let orgId = getOrgIdFromPage();
    if (!orgId) {
        alert("Organization ID is missing.");
        return;
    }

    const selectedOption = document.querySelector('input[name="option"]:checked');
    if (!selectedOption) {
        alert("Please select an option.");
        return;
    }

    const requestData = new FormData();
    requestData.append("options", selectedOption.value);

    fetch(`/organizations/duplicate-workspace/${organizationId}/`, {
        method: "POST",
        body: requestData,
        headers: {
            "X-CSRFToken": getCSRFToken(),
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.message) {
            alert("Workspace duplicated successfully!");
            closeDuplicateModal();
        } else {
            alert("Error: " + data.error);
        }
    })
    .catch(error => {
        console.error("Error:", error);
        alert("Something went wrong.");
    });
});

// Function to get org_id dynamically
function getOrgIdFromPage() {
    const orgElement = document.getElementById("organization-id");
    return orgElement ? orgElement.dataset.orgId : null;
}

// Function to get CSRF token
function getCSRFToken() {
    return document.querySelector('meta[name="csrf-token"]').getAttribute('content');
}







</script>


    
</body>
</html>

{% endblock %}