<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find User to Delete - {{ organization.name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .container {
            max-width: 1000px; /* Increased width */
            margin-top: 20px; /* Reduced top margin for better use of page height */
        }

        h1, h2, h3 {
            font-weight: 600;
            color: #343a40;
        }

        h4 {
            font-weight: 500;
            color: #495057;
        }

        p {
            color: #6c757d;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        strong {
            color: #343a40;
        }

        .alert {
            background-color: #ffdd57;
            color: #856404;
            padding: 15px;
            border-radius: 5px;
            font-size: 1rem;
        }

        .form-label {
            color: #495057;
            font-weight: 600;
        }

        .form-control {
            border: 1px solid #ced4da;
            border-radius: 0.375rem;
            padding: 10px;
        }

        .btn-danger {
            background-color: #dc3545;
            border: none;
            padding: 12px 20px;
            font-weight: bold;
            font-size: 1rem;
            transition: background-color 0.3s ease;
        }

        .btn-danger:hover {
            background-color: #c82333;
        }

        .btn-primary {
            background-color: #007bff;
            border: none;
            padding: 12px 20px;
            font-weight: bold;
            font-size: 1rem;
            transition: background-color 0.3s ease;
        }

        .btn-primary:hover {
            background-color: #0056b3;
        }

        .table {
            margin-top: 30px;
        }

        .table th, .table td {
            padding: 12px;
            text-align: center;
        }

        .table th {
            background-color: #343a40;
            color: white;
        }

        .table-striped tbody tr:nth-of-type(odd) {
            background-color: #f1f1f1;
        }

        .table td {
            font-size: 0.95rem;
            color: #495057;
        }

        .table .btn {
            padding: 6px 12px;
            font-size: 0.9rem;
        }

        .footer {
            background-color: #343a40;
            color: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 30px;
        }

        .footer a {
            color: #007bff;
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>

<body>
    <div class="container py-4"> <!-- Reduced padding here -->
        <!-- Organization and Admin Info -->
        <h3 class="text-center mb-3">Organization Settings</h3> <!-- Reduced bottom margin -->
        <h2 class="mb-3">Security</h2>
        <h3 class="mb-3">Data Deletion</h3> <!-- Reduced bottom margin -->
        <p>
            <strong>Delete Information from your organization:</strong>
            When anyone in your organization schedules an event with an invitee, information about the event and everyone part of it is saved in Calendar Plus. If you need to delete this information for compliance reasons, you can do so without contacting support.
        </p>
        <div class="alert">
            <strong>Warning: Once you delete information, you won't be able to recover it!</strong>
        </div>
        <p>
            Invitee data will be deleted immediately from the date you make the request.
        </p>

        <p>
            <strong>Delete information for specific invitees</strong>
        </p>
        <p>
            Enter an inviteeâ€™s email to delete all their personally identifiable information from your organization and integrations. During the data deletion process, Calendar Plus removes the deleted invitee from their spot on group events and cancels any pending or upcoming events with them.
        </p>
        <p><strong>Organization:</strong> {{ organization.name }}</p>
        <p><strong>Admin:</strong> {{ request.user.username }}</p>

        <!-- Email Form -->
        <form method="GET" class="mb-4">
            <div class="mb-3">
                <label for="email" class="form-label">Enter User Email to Delete</label>
                <input type="email" name="email" id="email" class="form-control" placeholder="User's Email" required>
            </div>
            <button type="submit" class="btn btn-danger">Proceed</button>
        </form>

        <!-- Toggle for Activity Logs -->
        <button class="btn btn-primary mb-3" onclick="toggleLogs()">Activity Logs</button>

        <!-- Activity Logs Section -->
        <div id="activityLogs" class="d-none">
            <h4 class="mt-4">Activity Logs</h4>
            {% if activity_logs %}
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Action</th>
                            <th>Target User</th>
                            <th>Details</th>
                            <th>Timestamp</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for log in activity_logs %}
                        <tr>
                            <td>{{ forloop.counter }}</td>
                            <td>{{ log.actions.all|join:", " }}</td>
                            <td>
                                {% if log.target_user %}
                                    {{ log.target_user.username }}
                                {% else %}
                                    N/A
                                {% endif %}
                            </td>
                            <td>{{ log.action_details }}</td>
                            <td>{{ log.timestamp }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p class="text-muted">No activity logs available.</p>
            {% endif %}
        </div>
    </div>

    <div class="footer">
        <strong>Delete your account</strong>
        <a href="#">You can delete your account in your account settings.</a>
    </div>

    <script>
        function toggleLogs() {
            const logsSection = document.getElementById('activityLogs');
            logsSection.classList.toggle('d-none');
        }
    </script>
</body>

</html>

